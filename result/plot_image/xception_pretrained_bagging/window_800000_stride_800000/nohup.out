****cv 0 / 10 ****
INFO:runner.model.base_runner:****cv 0 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6692332 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05625 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6351929 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:12<10:24, 12.75s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5508872 :
INFO:model.model_wrapper:******train score at epoch 2: 0.36158 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5478137 :
INFO:model.model_wrapper:******valid score at epoch 2: -0.01508 :
  4%|▍         | 2/50 [00:22<09:33, 11.95s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4428414 :
INFO:model.model_wrapper:******train score at epoch 3: 0.69449 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4664307 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.42521 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.42521
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:33<08:57, 11.44s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3307033 :
INFO:model.model_wrapper:******train score at epoch 4: 0.80712 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3879037 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.48346 :
INFO:model.model_wrapper:validation score is improved from 0.42521 to 0.48346
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:43<08:29, 11.07s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2422982 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88192 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3150933 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.47968 :
 10%|█         | 5/50 [00:53<08:04, 10.77s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1800356 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2914779 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.51244 :
INFO:model.model_wrapper:validation score is improved from 0.48346 to 0.51244
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:03<07:47, 10.62s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1366056 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2686964 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.48124 :
 14%|█▍        | 7/50 [01:13<07:30, 10.48s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0817091 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2437411 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.48124 :
 16%|█▌        | 8/50 [01:23<07:16, 10.39s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0658619 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2826277 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.51903 :
INFO:model.model_wrapper:validation score is improved from 0.51244 to 0.51903
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:34<07:04, 10.36s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0497658 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2999469 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.54431 :
INFO:model.model_wrapper:validation score is improved from 0.51903 to 0.54431
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:44<06:53, 10.33s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0386237 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3172740 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.54431 :
 22%|██▏       | 11/50 [01:54<06:40, 10.28s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0262070 :
INFO:model.model_wrapper:******train score at epoch 12: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3131381 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.54431 :
 24%|██▍       | 12/50 [02:04<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0220200 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3029356 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.54431 :
 26%|██▌       | 13/50 [02:14<06:17, 10.19s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0227651 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2795248 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.53802 :
 28%|██▊       | 14/50 [02:25<06:06, 10.17s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0151117 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2687687 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.55868 :
INFO:model.model_wrapper:validation score is improved from 0.54431 to 0.55868
INFO:model.model_wrapper:Checkpoint saved
 30%|███       | 15/50 [02:35<05:56, 10.19s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0134041 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2947555 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.50791 :
 32%|███▏      | 16/50 [02:45<05:45, 10.17s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0119220 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.2922451 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.53802 :
 34%|███▍      | 17/50 [02:55<05:35, 10.16s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0127131 :
INFO:model.model_wrapper:******train score at epoch 18: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3489837 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.53555 :
 36%|███▌      | 18/50 [03:05<05:24, 10.15s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0102408 :
INFO:model.model_wrapper:******train score at epoch 19: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3889680 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.45867 :
 38%|███▊      | 19/50 [03:15<05:13, 10.13s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0084381 :
INFO:model.model_wrapper:******train score at epoch 20: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3946123 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.45867 :
 40%|████      | 20/50 [03:25<05:04, 10.16s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0074164 :
INFO:model.model_wrapper:******train score at epoch 21: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3625617 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.46677 :
 42%|████▏     | 21/50 [03:36<04:54, 10.16s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0083617 :
INFO:model.model_wrapper:******train score at epoch 22: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.4303365 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.42905 :
 44%|████▍     | 22/50 [03:46<04:43, 10.14s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0099602 :
INFO:model.model_wrapper:******train score at epoch 23: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.4866981 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.48198 :
 46%|████▌     | 23/50 [03:56<04:33, 10.13s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.0067980 :
INFO:model.model_wrapper:******train score at epoch 24: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.5468922 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.48432 :
 48%|████▊     | 24/50 [04:06<04:23, 10.15s/it]INFO:model.model_wrapper:training 25  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 25: 0.0089219 :
INFO:model.model_wrapper:******train score at epoch 25: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 25: 0.3853548 :
INFO:model.model_wrapper:******valid score at epoch 25: 0.51106 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6624672 :
INFO:model.model_wrapper:******train score at epoch 1: 0.16013 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7125742 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:17, 10.16s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5434956 :
INFO:model.model_wrapper:******train score at epoch 2: 0.51403 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6459628 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:09, 10.20s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4163975 :
INFO:model.model_wrapper:******train score at epoch 3: 0.79634 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5428334 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.46703 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.46703
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:00, 10.23s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3175748 :
INFO:model.model_wrapper:******train score at epoch 4: 0.90347 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4496609 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.59372 :
INFO:model.model_wrapper:validation score is improved from 0.46703 to 0.59372
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.28s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2230330 :
INFO:model.model_wrapper:******train score at epoch 5: 0.93273 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3599959 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.60674 :
INFO:model.model_wrapper:validation score is improved from 0.59372 to 0.60674
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:43, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1651480 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93816 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3103677 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.62799 :
INFO:model.model_wrapper:validation score is improved from 0.60674 to 0.62799
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:33, 10.31s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1144225 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3147223 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.58462 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0911851 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95030 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2927878 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.60179 :
 16%|█▌        | 8/50 [01:22<07:10, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0553209 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3152925 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.56091 :
 18%|█▊        | 9/50 [01:32<07:00, 10.26s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0570468 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3867874 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.57775 :
 20%|██        | 10/50 [01:42<06:49, 10.25s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0352667 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3835962 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.56374 :
 22%|██▏       | 11/50 [01:52<06:39, 10.24s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0282452 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3767811 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.55349 :
 24%|██▍       | 12/50 [02:03<06:28, 10.22s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0235960 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4139405 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.54413 :
 26%|██▌       | 13/50 [02:13<06:18, 10.22s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0224337 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4209999 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.54413 :
 28%|██▊       | 14/50 [02:23<06:08, 10.23s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0211877 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3108221 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.56897 :
 30%|███       | 15/50 [02:33<05:56, 10.19s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0183924 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3125663 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.52709 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6692856 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5763197 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:26, 10.34s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5624650 :
INFO:model.model_wrapper:******train score at epoch 2: 0.22942 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5214352 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:15, 10.32s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4606806 :
INFO:model.model_wrapper:******train score at epoch 3: 0.50911 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4285880 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.25625 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.25625
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:05, 10.34s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3647195 :
INFO:model.model_wrapper:******train score at epoch 4: 0.73839 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3392705 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.40890 :
INFO:model.model_wrapper:validation score is improved from 0.25625 to 0.40890
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.33s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2729578 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87077 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2959081 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53215 :
INFO:model.model_wrapper:validation score is improved from 0.40890 to 0.53215
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:43, 10.31s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1989286 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93273 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2635348 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.54812 :
INFO:model.model_wrapper:validation score is improved from 0.53215 to 0.54812
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:33, 10.31s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1400690 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2531552 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.57274 :
INFO:model.model_wrapper:validation score is improved from 0.54812 to 0.57274
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:12<07:23, 10.31s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1258513 :
INFO:model.model_wrapper:******train score at epoch 8: 0.93346 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3615273 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.52874 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0792403 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3834964 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.51439 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0731418 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2971951 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.55342 :
 20%|██        | 10/50 [01:42<06:50, 10.25s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0554107 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3381305 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.47751 :
 22%|██▏       | 11/50 [01:53<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0443649 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3170324 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.52833 :
 24%|██▍       | 12/50 [02:03<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0369090 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2822602 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.58300 :
INFO:model.model_wrapper:validation score is improved from 0.57274 to 0.58300
INFO:model.model_wrapper:Checkpoint saved
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0327173 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2951809 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.55342 :
 28%|██▊       | 14/50 [02:23<06:10, 10.29s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0248688 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3929412 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.48200 :
 30%|███       | 15/50 [02:34<05:59, 10.27s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0242254 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4552350 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.48811 :
 32%|███▏      | 16/50 [02:44<05:49, 10.27s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0232532 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4917732 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.47602 :
 34%|███▍      | 17/50 [02:54<05:38, 10.25s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0336803 :
INFO:model.model_wrapper:******train score at epoch 18: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3274273 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.53802 :
 36%|███▌      | 18/50 [03:04<05:28, 10.27s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0201980 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3164633 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.55868 :
 38%|███▊      | 19/50 [03:15<05:18, 10.27s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0217443 :
INFO:model.model_wrapper:******train score at epoch 20: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3291026 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.56288 :
 40%|████      | 20/50 [03:25<05:08, 10.27s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0155853 :
INFO:model.model_wrapper:******train score at epoch 21: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3997411 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.52709 :
 42%|████▏     | 21/50 [03:35<04:57, 10.25s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0241195 :
INFO:model.model_wrapper:******train score at epoch 22: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.6244334 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.47370 :
 44%|████▍     | 22/50 [03:46<04:47, 10.26s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0296600 :
INFO:model.model_wrapper:******train score at epoch 23: 0.98750 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.6905689 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.44915 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6563342 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6322177 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:22, 10.26s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5188918 :
INFO:model.model_wrapper:******train score at epoch 2: 0.48038 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5131129 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:12, 10.25s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.3989787 :
INFO:model.model_wrapper:******train score at epoch 3: 0.70250 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4136969 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.34311 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.34311
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.26s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.2938882 :
INFO:model.model_wrapper:******train score at epoch 4: 0.80712 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.2941793 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.41223 :
INFO:model.model_wrapper:validation score is improved from 0.34311 to 0.41223
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:50, 10.23s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2134686 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89197 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2943260 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.62996 :
INFO:model.model_wrapper:validation score is improved from 0.41223 to 0.62996
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1604392 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90347 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3366776 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.52592 :
 12%|█▏        | 6/50 [01:01<07:28, 10.20s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1108602 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3913872 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51950 :
 14%|█▍        | 7/50 [01:11<07:18, 10.20s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0713692 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4053703 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.50717 :
 16%|█▌        | 8/50 [01:21<07:08, 10.20s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0540893 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4233485 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.51326 :
 18%|█▊        | 9/50 [01:31<06:58, 10.22s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0383650 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4020175 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.47529 :
 20%|██        | 10/50 [01:42<06:48, 10.21s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0285485 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3388717 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52709 :
 22%|██▏       | 11/50 [01:52<06:36, 10.18s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0225788 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3086196 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.54431 :
 24%|██▍       | 12/50 [02:02<06:25, 10.14s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0267602 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4255018 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.49440 :
 26%|██▌       | 13/50 [02:12<06:15, 10.14s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0166558 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4675479 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.47021 :
 28%|██▊       | 14/50 [02:22<06:04, 10.14s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0147563 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4971606 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.47895 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6683582 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6295485 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:14, 10.10s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5653337 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32752 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5632760 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:05, 10.11s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4586487 :
INFO:model.model_wrapper:******train score at epoch 3: 0.53399 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4626538 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.40515 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.40515
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:56, 10.13s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3732623 :
INFO:model.model_wrapper:******train score at epoch 4: 0.70876 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3559676 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.40890 :
INFO:model.model_wrapper:validation score is improved from 0.40515 to 0.40890
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:47, 10.16s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2767633 :
INFO:model.model_wrapper:******train score at epoch 5: 0.83611 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2869752 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.43034 :
INFO:model.model_wrapper:validation score is improved from 0.40890 to 0.43034
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:50<07:38, 10.19s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2041131 :
INFO:model.model_wrapper:******train score at epoch 6: 0.89884 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2655428 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.53802 :
INFO:model.model_wrapper:validation score is improved from 0.43034 to 0.53802
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:30, 10.23s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1575686 :
INFO:model.model_wrapper:******train score at epoch 7: 0.90840 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2642952 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62022 :
INFO:model.model_wrapper:validation score is improved from 0.53802 to 0.62022
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:11<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1322758 :
INFO:model.model_wrapper:******train score at epoch 8: 0.93214 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2467387 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.58713 :
 16%|█▌        | 8/50 [01:21<07:09, 10.24s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0843901 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2774226 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.58462 :
 18%|█▊        | 9/50 [01:31<06:58, 10.20s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0668992 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2535560 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.58713 :
 20%|██        | 10/50 [01:41<06:47, 10.18s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0456584 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2731028 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.58713 :
 22%|██▏       | 11/50 [01:52<06:35, 10.15s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0399990 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2932612 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.59675 :
 24%|██▍       | 12/50 [02:02<06:25, 10.15s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0311515 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2970186 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.59675 :
 26%|██▌       | 13/50 [02:12<06:16, 10.17s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0287240 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3213196 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.56897 :
 28%|██▊       | 14/50 [02:22<06:05, 10.15s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0209524 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3298151 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.54403 :
 30%|███       | 15/50 [02:32<05:54, 10.14s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0195280 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3351966 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.56897 :
 32%|███▏      | 16/50 [02:42<05:44, 10.13s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0159249 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3166342 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.56897 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6756439 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7260028 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:16, 10.13s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5720636 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32752 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6245897 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:07, 10.15s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4584338 :
INFO:model.model_wrapper:******train score at epoch 3: 0.62554 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5157740 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.39176 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.39176
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:58, 10.19s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3546800 :
INFO:model.model_wrapper:******train score at epoch 4: 0.74358 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4012314 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.44834 :
INFO:model.model_wrapper:validation score is improved from 0.39176 to 0.44834
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:49, 10.21s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2684815 :
INFO:model.model_wrapper:******train score at epoch 5: 0.81983 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3214849 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.56973 :
INFO:model.model_wrapper:validation score is improved from 0.44834 to 0.56973
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:39, 10.21s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2110490 :
INFO:model.model_wrapper:******train score at epoch 6: 0.88627 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3190080 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.48522 :
 12%|█▏        | 6/50 [01:01<07:29, 10.22s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1423971 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3379955 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.48200 :
 14%|█▍        | 7/50 [01:11<07:18, 10.20s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1122354 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3671046 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.50087 :
 16%|█▌        | 8/50 [01:21<07:08, 10.19s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0702284 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3405566 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.49606 :
 18%|█▊        | 9/50 [01:31<06:58, 10.21s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0503501 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3093915 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.47005 :
 20%|██        | 10/50 [01:42<06:47, 10.18s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0421019 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3439124 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.47529 :
 22%|██▏       | 11/50 [01:52<06:36, 10.17s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0299700 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3946850 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.45364 :
 24%|██▍       | 12/50 [02:02<06:27, 10.19s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0359187 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4367397 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.42851 :
 26%|██▌       | 13/50 [02:12<06:17, 10.21s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0248441 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3368484 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.48200 :
 28%|██▊       | 14/50 [02:22<06:07, 10.21s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0187035 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3265018 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.56036 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6659609 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07931 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6638723 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:23, 10.28s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5387707 :
INFO:model.model_wrapper:******train score at epoch 2: 0.42767 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5498590 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:12, 10.26s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4314399 :
INFO:model.model_wrapper:******train score at epoch 3: 0.61873 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4315972 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.39305 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.39305
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.25s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3325843 :
INFO:model.model_wrapper:******train score at epoch 4: 0.75399 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.2996463 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.49690 :
INFO:model.model_wrapper:validation score is improved from 0.39305 to 0.49690
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.27s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2428769 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85261 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2355998 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.58305 :
INFO:model.model_wrapper:validation score is improved from 0.49690 to 0.58305
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:42, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1660656 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90176 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2508650 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.59675 :
INFO:model.model_wrapper:validation score is improved from 0.58305 to 0.59675
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1350668 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2677473 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56036 :
 14%|█▍        | 7/50 [01:11<07:21, 10.27s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1168751 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2704487 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.57788 :
 16%|█▌        | 8/50 [01:22<07:12, 10.30s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0774430 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3114384 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.55206 :
 18%|█▊        | 9/50 [01:32<07:01, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0499459 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3508719 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.50087 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0421180 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3834333 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52874 :
 22%|██▏       | 11/50 [01:52<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0291468 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3782526 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.51439 :
 24%|██▍       | 12/50 [02:03<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0310829 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3405288 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50344 :
 26%|██▌       | 13/50 [02:13<06:18, 10.23s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0234109 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3562380 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.51894 :
 28%|██▊       | 14/50 [02:23<06:09, 10.25s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0209184 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3165350 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.54431 :
 30%|███       | 15/50 [02:33<05:58, 10.26s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0154042 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3417623 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.54431 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6592149 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09728 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6516041 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:26, 10.33s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5264025 :
INFO:model.model_wrapper:******train score at epoch 2: 0.55341 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5739367 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:13, 10.29s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4182047 :
INFO:model.model_wrapper:******train score at epoch 3: 0.72821 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4734831 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.47556 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.47556
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.29s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3130708 :
INFO:model.model_wrapper:******train score at epoch 4: 0.80632 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3592552 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.46619 :
  8%|▊         | 4/50 [00:40<07:51, 10.25s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2444397 :
INFO:model.model_wrapper:******train score at epoch 5: 0.86004 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3149712 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54431 :
INFO:model.model_wrapper:validation score is improved from 0.47556 to 0.54431
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:42, 10.27s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1678656 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93346 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3033592 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.55342 :
INFO:model.model_wrapper:validation score is improved from 0.54431 to 0.55342
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1256743 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94465 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3196733 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51106 :
 14%|█▍        | 7/50 [01:11<07:22, 10.29s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0886895 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2635830 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.56288 :
INFO:model.model_wrapper:validation score is improved from 0.55342 to 0.56288
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:22<07:13, 10.33s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0603890 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2481747 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.58300 :
INFO:model.model_wrapper:validation score is improved from 0.56288 to 0.58300
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:32<07:04, 10.35s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0492427 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2870850 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.57274 :
 20%|██        | 10/50 [01:42<06:52, 10.31s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0419330 :
INFO:model.model_wrapper:******train score at epoch 11: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3196033 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.57646 :
 22%|██▏       | 11/50 [01:53<06:42, 10.31s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0268394 :
INFO:model.model_wrapper:******train score at epoch 12: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3135394 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.58713 :
INFO:model.model_wrapper:validation score is improved from 0.58300 to 0.58713
INFO:model.model_wrapper:Checkpoint saved
 24%|██▍       | 12/50 [02:03<06:31, 10.31s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0245865 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3514230 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.53626 :
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0197948 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3683860 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.52146 :
 28%|██▊       | 14/50 [02:24<06:10, 10.28s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0153641 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4075688 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.51326 :
 30%|███       | 15/50 [02:34<05:59, 10.27s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0171625 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4473568 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.48982 :
 32%|███▏      | 16/50 [02:44<05:49, 10.28s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0104717 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4359725 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.51326 :
 34%|███▍      | 17/50 [02:54<05:39, 10.27s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0122455 :
INFO:model.model_wrapper:******train score at epoch 18: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4413863 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.51950 :
 36%|███▌      | 18/50 [03:05<05:28, 10.26s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0136961 :
INFO:model.model_wrapper:******train score at epoch 19: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3906904 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.56091 :
 38%|███▊      | 19/50 [03:15<05:18, 10.26s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0085395 :
INFO:model.model_wrapper:******train score at epoch 20: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3647578 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.56897 :
 40%|████      | 20/50 [03:25<05:07, 10.25s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0096452 :
INFO:model.model_wrapper:******train score at epoch 21: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3436174 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.53555 :
 42%|████▏     | 21/50 [03:35<04:57, 10.25s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0096268 :
INFO:model.model_wrapper:******train score at epoch 22: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.3532930 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.53555 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6692237 :
INFO:model.model_wrapper:******train score at epoch 1: 0.17961 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6869700 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.21s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5451748 :
INFO:model.model_wrapper:******train score at epoch 2: 0.54829 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6084778 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.25625 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.25625
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:10, 10.23s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4201818 :
INFO:model.model_wrapper:******train score at epoch 3: 0.74878 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5231998 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.39176 :
INFO:model.model_wrapper:validation score is improved from 0.25625 to 0.39176
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.25s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3182938 :
INFO:model.model_wrapper:******train score at epoch 4: 0.81254 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4390290 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.45693 :
INFO:model.model_wrapper:validation score is improved from 0.39176 to 0.45693
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.29s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2329917 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87941 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4264079 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53252 :
INFO:model.model_wrapper:validation score is improved from 0.45693 to 0.53252
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:43, 10.30s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1702642 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4441377 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.51326 :
 12%|█▏        | 6/50 [01:01<07:31, 10.26s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1275742 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93816 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4190679 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.50717 :
 14%|█▍        | 7/50 [01:11<07:19, 10.23s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0856692 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3890393 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.52874 :
 16%|█▌        | 8/50 [01:22<07:10, 10.24s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0643462 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4152546 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.52874 :
 18%|█▊        | 9/50 [01:32<06:59, 10.23s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0512003 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4484753 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.48811 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0391666 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4814939 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.47895 :
 22%|██▏       | 11/50 [01:52<06:40, 10.28s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0381001 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5474000 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.47895 :
 24%|██▍       | 12/50 [02:03<06:30, 10.27s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0228832 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5280728 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.48982 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0227630 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4621222 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.52592 :
 28%|██▊       | 14/50 [02:23<06:08, 10.24s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0163861 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.5014867 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.52592 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6607261 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6454605 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:16, 10.14s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5507181 :
INFO:model.model_wrapper:******train score at epoch 2: 0.26782 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5236411 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:07, 10.16s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4538435 :
INFO:model.model_wrapper:******train score at epoch 3: 0.47885 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4164941 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.40515 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.40515
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:58, 10.18s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3642968 :
INFO:model.model_wrapper:******train score at epoch 4: 0.66072 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3041813 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.32310 :
  8%|▊         | 4/50 [00:40<07:48, 10.18s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2969544 :
INFO:model.model_wrapper:******train score at epoch 5: 0.73839 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2534539 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.49411 :
INFO:model.model_wrapper:validation score is improved from 0.40515 to 0.49411
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:50<07:38, 10.19s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2390726 :
INFO:model.model_wrapper:******train score at epoch 6: 0.83444 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2318592 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.53368 :
INFO:model.model_wrapper:validation score is improved from 0.49411 to 0.53368
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:28, 10.19s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1950514 :
INFO:model.model_wrapper:******train score at epoch 7: 0.88059 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2464006 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56288 :
INFO:model.model_wrapper:validation score is improved from 0.53368 to 0.56288
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:11<07:19, 10.22s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1394148 :
INFO:model.model_wrapper:******train score at epoch 8: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2264491 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.53555 :
 16%|█▌        | 8/50 [01:21<07:08, 10.21s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1102587 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2592554 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.57646 :
INFO:model.model_wrapper:validation score is improved from 0.56288 to 0.57646
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:31<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0833113 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3369307 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.57064 :
 20%|██        | 10/50 [01:42<06:51, 10.28s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0675768 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2915600 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.50344 :
 22%|██▏       | 11/50 [01:52<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0558172 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3054701 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.51106 :
 24%|██▍       | 12/50 [02:02<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0428039 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2959782 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.56036 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0466202 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2930848 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.51894 :
 28%|██▊       | 14/50 [02:23<06:09, 10.25s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0344632 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3510491 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.52146 :
 30%|███       | 15/50 [02:33<05:59, 10.26s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0341147 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4719612 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.49546 :
 32%|███▏      | 16/50 [02:43<05:48, 10.25s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0263730 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4446263 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.51950 :
 34%|███▍      | 17/50 [02:54<05:38, 10.26s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0289139 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4555346 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.55049 :
 36%|███▌      | 18/50 [03:04<05:27, 10.24s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0243022 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.4264955 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.55049 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 1 / 10 ****
INFO:runner.model.base_runner:****cv 1 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6649803 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6508529 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:16, 10.13s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5375058 :
INFO:model.model_wrapper:******train score at epoch 2: 0.40974 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5809482 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:06, 10.13s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4356453 :
INFO:model.model_wrapper:******train score at epoch 3: 0.64979 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4956099 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.42784 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.42784
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:57, 10.17s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3522519 :
INFO:model.model_wrapper:******train score at epoch 4: 0.79017 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4426951 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.53802 :
INFO:model.model_wrapper:validation score is improved from 0.42784 to 0.53802
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:51, 10.24s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2554109 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87494 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3806213 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.51439 :
 10%|█         | 5/50 [00:51<07:40, 10.23s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1887154 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90840 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3609775 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.53931 :
INFO:model.model_wrapper:validation score is improved from 0.53802 to 0.53931
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:31, 10.26s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1355194 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93867 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3329471 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56856 :
INFO:model.model_wrapper:validation score is improved from 0.53931 to 0.56856
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:12<07:25, 10.36s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0950423 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3167390 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.58462 :
INFO:model.model_wrapper:validation score is improved from 0.56856 to 0.58462
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:22<07:13, 10.33s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0806630 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3642395 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53931 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0512141 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3428258 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.53626 :
 20%|██        | 10/50 [01:42<06:52, 10.30s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0468662 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3129108 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.55206 :
 22%|██▏       | 11/50 [01:53<06:41, 10.30s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0434643 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4117278 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.51439 :
 24%|██▍       | 12/50 [02:03<06:31, 10.31s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0326502 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4191533 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51439 :
 26%|██▌       | 13/50 [02:13<06:19, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0232734 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3929459 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.52146 :
 28%|██▊       | 14/50 [02:23<06:09, 10.26s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0232014 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4034485 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.52874 :
 30%|███       | 15/50 [02:34<05:59, 10.26s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0177317 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4143157 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.52874 :
 32%|███▏      | 16/50 [02:44<05:49, 10.27s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0152169 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4371606 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.52874 :
 34%|███▍      | 17/50 [02:54<05:38, 10.25s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0149947 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4635996 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.52146 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6673803 :
INFO:model.model_wrapper:******train score at epoch 1: 0.14368 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7034413 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.22s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5611981 :
INFO:model.model_wrapper:******train score at epoch 2: 0.57254 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6713854 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.22869 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.22869
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:13, 10.28s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4585690 :
INFO:model.model_wrapper:******train score at epoch 3: 0.74878 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5733819 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.46703 :
INFO:model.model_wrapper:validation score is improved from 0.22869 to 0.46703
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:04, 10.31s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3553503 :
INFO:model.model_wrapper:******train score at epoch 4: 0.83152 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4857802 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.60674 :
INFO:model.model_wrapper:validation score is improved from 0.46703 to 0.60674
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.30s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2748562 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88515 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4480074 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54630 :
 10%|█         | 5/50 [00:51<07:41, 10.27s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2143178 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91429 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3841701 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.53252 :
 12%|█▏        | 6/50 [01:01<07:30, 10.24s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1676732 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3688316 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52592 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1191247 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96280 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3887079 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.51950 :
 16%|█▌        | 8/50 [01:22<07:10, 10.24s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0831880 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3480689 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.54630 :
 18%|█▊        | 9/50 [01:32<06:59, 10.22s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0646069 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2516794 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.58300 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0430049 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2767646 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.62022 :
INFO:model.model_wrapper:validation score is improved from 0.60674 to 0.62022
INFO:model.model_wrapper:Checkpoint saved
 22%|██▏       | 11/50 [01:53<06:42, 10.33s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0417882 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3936089 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53931 :
 24%|██▍       | 12/50 [02:03<06:30, 10.28s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0302881 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4464210 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.53931 :
 26%|██▌       | 13/50 [02:13<06:20, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0241218 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3926904 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.56091 :
 28%|██▊       | 14/50 [02:23<06:08, 10.25s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0209271 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3818803 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.56091 :
 30%|███       | 15/50 [02:34<05:58, 10.26s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0205752 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3495318 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.57646 :
 32%|███▏      | 16/50 [02:44<05:49, 10.27s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0147278 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3538196 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.56856 :
 34%|███▍      | 17/50 [02:54<05:39, 10.28s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0168412 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4539651 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.54630 :
 36%|███▌      | 18/50 [03:04<05:28, 10.26s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0132714 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.4870797 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.51950 :
 38%|███▊      | 19/50 [03:15<05:18, 10.26s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0130117 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.4757741 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.51950 :
 40%|████      | 20/50 [03:25<05:08, 10.27s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0138364 :
INFO:model.model_wrapper:******train score at epoch 21: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.4872121 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.53252 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6773697 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5551076 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:22, 10.26s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5574122 :
INFO:model.model_wrapper:******train score at epoch 2: 0.24701 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5237192 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:12, 10.25s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4411654 :
INFO:model.model_wrapper:******train score at epoch 3: 0.60676 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4452687 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.36429 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.36429
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.25s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3310504 :
INFO:model.model_wrapper:******train score at epoch 4: 0.80172 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3442020 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.66502 :
INFO:model.model_wrapper:validation score is improved from 0.36429 to 0.66502
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.27s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2412512 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89197 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2932941 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.66155 :
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1640543 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2795960 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.59306 :
 12%|█▏        | 6/50 [01:01<07:31, 10.25s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1090170 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2420448 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.59675 :
 14%|█▍        | 7/50 [01:11<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1054741 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96280 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2723063 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.61084 :
 16%|█▌        | 8/50 [01:22<07:12, 10.30s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0630136 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2897618 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.60179 :
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0463564 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2825150 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.60179 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0388648 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2748334 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.60179 :
 22%|██▏       | 11/50 [01:52<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0324230 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2956890 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.59306 :
 24%|██▍       | 12/50 [02:03<06:31, 10.30s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0297153 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3851455 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.58462 :
 26%|██▌       | 13/50 [02:13<06:20, 10.30s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0259166 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3899388 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.58462 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6698204 :
INFO:model.model_wrapper:******train score at epoch 1: 0.11251 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7011081 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:26, 10.34s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5666643 :
INFO:model.model_wrapper:******train score at epoch 2: 0.45056 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6239150 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.15131 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.15131
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:15, 10.32s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4669558 :
INFO:model.model_wrapper:******train score at epoch 3: 0.67557 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5267240 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.45628 :
INFO:model.model_wrapper:validation score is improved from 0.15131 to 0.45628
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:05, 10.33s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3599376 :
INFO:model.model_wrapper:******train score at epoch 4: 0.81983 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4225586 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.61972 :
INFO:model.model_wrapper:validation score is improved from 0.45628 to 0.61972
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.32s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3004447 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85261 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3782796 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.57274 :
 10%|█         | 5/50 [00:51<07:44, 10.32s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2146146 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91508 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3309867 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.54403 :
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1524176 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93273 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3493258 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.54630 :
 14%|█▍        | 7/50 [01:12<07:23, 10.31s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1057273 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3083053 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.56091 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0746536 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2973880 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.54403 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0520369 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3365729 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.50087 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0410837 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3358411 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52146 :
 22%|██▏       | 11/50 [01:53<06:40, 10.28s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0348847 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3446513 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.50753 :
 24%|██▍       | 12/50 [02:03<06:30, 10.28s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0315356 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4221053 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.49440 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0299801 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3625341 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.52874 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6690400 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6476082 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:18, 10.18s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5421741 :
INFO:model.model_wrapper:******train score at epoch 2: 0.45557 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5848587 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:08, 10.18s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4395223 :
INFO:model.model_wrapper:******train score at epoch 3: 0.72807 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5067210 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.48029 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.48029
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:59, 10.20s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3490610 :
INFO:model.model_wrapper:******train score at epoch 4: 0.82734 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4641256 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.62893 :
INFO:model.model_wrapper:validation score is improved from 0.48029 to 0.62893
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:51, 10.25s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2590146 :
INFO:model.model_wrapper:******train score at epoch 5: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4445854 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53626 :
 10%|█         | 5/50 [00:51<07:40, 10.24s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2016929 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4523912 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.50717 :
 12%|█▏        | 6/50 [01:01<07:28, 10.19s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1661293 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4143059 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.53252 :
 14%|█▍        | 7/50 [01:11<07:17, 10.17s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1147893 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4349097 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.49546 :
 16%|█▌        | 8/50 [01:21<07:07, 10.18s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0871682 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4274764 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.46455 :
 18%|█▊        | 9/50 [01:31<06:59, 10.22s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0615252 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3605541 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.51439 :
 20%|██        | 10/50 [01:42<06:48, 10.22s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0531910 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3441586 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.53626 :
 22%|██▏       | 11/50 [01:52<06:38, 10.22s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0402155 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3620232 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.57646 :
 24%|██▍       | 12/50 [02:02<06:28, 10.22s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0325356 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3730315 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.57646 :
 26%|██▌       | 13/50 [02:12<06:19, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0272429 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3861350 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.57646 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6671852 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6290175 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:28, 10.38s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5679852 :
INFO:model.model_wrapper:******train score at epoch 2: 0.38869 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5919719 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:15, 10.33s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4528427 :
INFO:model.model_wrapper:******train score at epoch 3: 0.70555 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5189236 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.42521 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.42521
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:04, 10.32s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3683753 :
INFO:model.model_wrapper:******train score at epoch 4: 0.81650 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4702568 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.53215 :
INFO:model.model_wrapper:validation score is improved from 0.42521 to 0.53215
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:55, 10.33s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2829239 :
INFO:model.model_wrapper:******train score at epoch 5: 0.86801 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4397960 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.57646 :
INFO:model.model_wrapper:validation score is improved from 0.53215 to 0.57646
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:45, 10.35s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2239404 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4407951 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.50717 :
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1743431 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93816 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4124430 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.50717 :
 14%|█▍        | 7/50 [01:12<07:22, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1189853 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3466681 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.54403 :
 16%|█▌        | 8/50 [01:22<07:10, 10.25s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0945076 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3511606 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.54403 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0751607 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3363833 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.53626 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0529714 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3196103 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52874 :
 22%|██▏       | 11/50 [01:53<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0529996 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4985284 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.48432 :
 24%|██▍       | 12/50 [02:03<06:28, 10.23s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0365021 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5888378 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.47895 :
 26%|██▌       | 13/50 [02:13<06:17, 10.21s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0318863 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5327560 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.45364 :
 28%|██▊       | 14/50 [02:23<06:08, 10.23s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0247603 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4590449 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.48198 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6653409 :
INFO:model.model_wrapper:******train score at epoch 1: 0.12599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6636477 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.23s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5439586 :
INFO:model.model_wrapper:******train score at epoch 2: 0.58296 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6620271 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.15131 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.15131
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:13, 10.28s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4335625 :
INFO:model.model_wrapper:******train score at epoch 3: 0.76221 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5905796 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.44895 :
INFO:model.model_wrapper:validation score is improved from 0.15131 to 0.44895
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.29s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3217171 :
INFO:model.model_wrapper:******train score at epoch 4: 0.91508 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4933568 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.56973 :
INFO:model.model_wrapper:validation score is improved from 0.44895 to 0.56973
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.29s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2615424 :
INFO:model.model_wrapper:******train score at epoch 5: 0.90254 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4444018 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.51439 :
 10%|█         | 5/50 [00:51<07:41, 10.26s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1957752 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92616 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4490653 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.52592 :
 12%|█▏        | 6/50 [01:01<07:29, 10.22s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1528733 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4071478 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51439 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1038644 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3482968 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.52874 :
 16%|█▌        | 8/50 [01:21<07:08, 10.20s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0718727 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3690346 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.51439 :
 18%|█▊        | 9/50 [01:32<06:58, 10.20s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0573552 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3875250 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.51439 :
 20%|██        | 10/50 [01:42<06:48, 10.21s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0584839 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3941349 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52874 :
 22%|██▏       | 11/50 [01:52<06:38, 10.21s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0411039 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5269984 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.47021 :
 24%|██▍       | 12/50 [02:02<06:27, 10.21s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0336368 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5644787 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.45903 :
 26%|██▌       | 13/50 [02:13<06:18, 10.22s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0248241 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5434173 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.46455 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6742283 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6419272 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.21s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5781473 :
INFO:model.model_wrapper:******train score at epoch 2: 0.33333 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6014958 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.24s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4713178 :
INFO:model.model_wrapper:******train score at epoch 3: 0.65221 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5340875 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.47270 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.47270
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.25s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3797579 :
INFO:model.model_wrapper:******train score at epoch 4: 0.77502 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4739654 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.64184 :
INFO:model.model_wrapper:validation score is improved from 0.47270 to 0.64184
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.29s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2953933 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85672 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4279421 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.59675 :
 10%|█         | 5/50 [00:51<07:41, 10.26s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2263643 :
INFO:model.model_wrapper:******train score at epoch 6: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4019613 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.56091 :
 12%|█▏        | 6/50 [01:01<07:30, 10.23s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1870679 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3661829 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55349 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1275071 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2853495 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.62996 :
 16%|█▌        | 8/50 [01:22<07:10, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1036389 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2400639 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.67298 :
INFO:model.model_wrapper:validation score is improved from 0.64184 to 0.67298
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:32<07:03, 10.33s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0757492 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2399801 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.62996 :
 20%|██        | 10/50 [01:42<06:51, 10.29s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0635605 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2917246 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.60179 :
 22%|██▏       | 11/50 [01:53<06:41, 10.31s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0432740 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3131201 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.59306 :
 24%|██▍       | 12/50 [02:03<06:30, 10.27s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0461490 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98127 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2820829 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.60179 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0344125 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.1945161 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.67656 :
INFO:model.model_wrapper:validation score is improved from 0.67298 to 0.67656
INFO:model.model_wrapper:Checkpoint saved
 28%|██▊       | 14/50 [02:23<06:09, 10.27s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0373723 :
INFO:model.model_wrapper:******train score at epoch 15: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2585219 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.66256 :
 30%|███       | 15/50 [02:34<05:58, 10.24s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0297710 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4609707 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.54413 :
 32%|███▏      | 16/50 [02:44<05:47, 10.22s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0277870 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.5170265 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.53794 :
 34%|███▍      | 17/50 [02:54<05:37, 10.24s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0273218 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4625802 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.52592 :
 36%|███▌      | 18/50 [03:04<05:27, 10.23s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0217610 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.4356765 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.53252 :
 38%|███▊      | 19/50 [03:14<05:17, 10.26s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0294734 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3322724 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.60179 :
 40%|████      | 20/50 [03:25<05:07, 10.24s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0183538 :
INFO:model.model_wrapper:******train score at epoch 21: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3845303 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.58506 :
 42%|████▏     | 21/50 [03:35<04:56, 10.23s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0204392 :
INFO:model.model_wrapper:******train score at epoch 22: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.3135550 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.61666 :
 44%|████▍     | 22/50 [03:45<04:46, 10.24s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0157941 :
INFO:model.model_wrapper:******train score at epoch 23: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.3297080 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.62522 :
 46%|████▌     | 23/50 [03:55<04:36, 10.26s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.0118186 :
INFO:model.model_wrapper:******train score at epoch 24: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.3201555 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.64322 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6703295 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07931 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6989972 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:18, 10.17s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5652855 :
INFO:model.model_wrapper:******train score at epoch 2: 0.45056 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6483842 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.21472 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.21472
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:11, 10.24s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4552039 :
INFO:model.model_wrapper:******train score at epoch 3: 0.74898 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5714242 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.45628 :
INFO:model.model_wrapper:validation score is improved from 0.21472 to 0.45628
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.28s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3638994 :
INFO:model.model_wrapper:******train score at epoch 4: 0.81119 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5133442 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.58713 :
INFO:model.model_wrapper:validation score is improved from 0.45628 to 0.58713
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.27s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2913716 :
INFO:model.model_wrapper:******train score at epoch 5: 0.91508 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4875080 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53252 :
 10%|█         | 5/50 [00:51<07:40, 10.23s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2152716 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4757641 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.52592 :
 12%|█▏        | 6/50 [01:01<07:30, 10.24s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1537170 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3887885 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56856 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1153937 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3259262 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.61084 :
INFO:model.model_wrapper:validation score is improved from 0.58713 to 0.61084
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0841096 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3705792 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.58462 :
 18%|█▊        | 9/50 [01:32<06:59, 10.24s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0585467 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3657135 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.59306 :
 20%|██        | 10/50 [01:42<06:51, 10.29s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0499364 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3785552 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.58462 :
 22%|██▏       | 11/50 [01:53<06:41, 10.30s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0349740 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4138492 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53931 :
 24%|██▍       | 12/50 [02:03<06:30, 10.29s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0330715 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5442298 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.48982 :
 26%|██▌       | 13/50 [02:13<06:20, 10.29s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0316189 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98127 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4103605 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.56091 :
 28%|██▊       | 14/50 [02:23<06:09, 10.28s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0238365 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3057523 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.60179 :
 30%|███       | 15/50 [02:34<06:00, 10.29s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0213626 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3436730 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.59306 :
 32%|███▏      | 16/50 [02:44<05:48, 10.26s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0195624 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4228773 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.51950 :
 34%|███▍      | 17/50 [02:54<05:37, 10.24s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0201224 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.5464756 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.48432 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6696527 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7006946 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:23, 10.28s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5597046 :
INFO:model.model_wrapper:******train score at epoch 2: 0.46939 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6267425 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:12, 10.25s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4547827 :
INFO:model.model_wrapper:******train score at epoch 3: 0.74107 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5698524 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.40890 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.40890
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.29s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3624403 :
INFO:model.model_wrapper:******train score at epoch 4: 0.85815 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5232540 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.58713 :
INFO:model.model_wrapper:validation score is improved from 0.40890 to 0.58713
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:55, 10.33s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2786828 :
INFO:model.model_wrapper:******train score at epoch 5: 0.92093 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4546125 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.58462 :
 10%|█         | 5/50 [00:51<07:44, 10.33s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2154279 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3857689 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.61084 :
INFO:model.model_wrapper:validation score is improved from 0.58713 to 0.61084
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:34, 10.33s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1621273 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3631510 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55349 :
 14%|█▍        | 7/50 [01:12<07:23, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1214773 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3474231 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.57646 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0928276 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2847436 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.61084 :
 18%|█▊        | 9/50 [01:32<06:59, 10.23s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0692892 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2808721 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.62996 :
INFO:model.model_wrapper:validation score is improved from 0.61084 to 0.62996
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:42<06:49, 10.25s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0582216 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2681093 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.62022 :
 22%|██▏       | 11/50 [01:53<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0489104 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2934501 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.60179 :
 24%|██▍       | 12/50 [02:03<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0383919 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4931856 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51326 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0326127 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5263692 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.49546 :
 28%|██▊       | 14/50 [02:23<06:08, 10.23s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0261192 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.5016523 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.52592 :
 30%|███       | 15/50 [02:33<05:57, 10.22s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0280674 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4175119 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.53931 :
 32%|███▏      | 16/50 [02:44<05:47, 10.22s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0211475 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4045187 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.55349 :
 34%|███▍      | 17/50 [02:54<05:37, 10.22s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0199710 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4270887 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.55349 :
 36%|███▌      | 18/50 [03:04<05:26, 10.21s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0225019 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3931185 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.56856 :
 38%|███▊      | 19/50 [03:14<05:17, 10.24s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0200739 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3884862 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.58462 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 2 / 10 ****
INFO:runner.model.base_runner:****cv 2 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6679397 :
INFO:model.model_wrapper:******train score at epoch 1: -0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6684396 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.20s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5810978 :
INFO:model.model_wrapper:******train score at epoch 2: 0.35058 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6245551 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.11502 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.11502
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:10, 10.23s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4731188 :
INFO:model.model_wrapper:******train score at epoch 3: 0.67346 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5748344 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.23372 :
INFO:model.model_wrapper:validation score is improved from 0.11502 to 0.23372
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.26s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3922221 :
INFO:model.model_wrapper:******train score at epoch 4: 0.81078 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5073275 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.55708 :
INFO:model.model_wrapper:validation score is improved from 0.23372 to 0.55708
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:51, 10.25s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3142639 :
INFO:model.model_wrapper:******train score at epoch 5: 0.90453 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4665220 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.52833 :
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2456308 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4181211 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.52709 :
 12%|█▏        | 6/50 [01:01<07:30, 10.23s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1969746 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3724530 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.50149 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1369132 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3493305 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.51009 :
 16%|█▌        | 8/50 [01:21<07:09, 10.23s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1090916 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3224668 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53802 :
 18%|█▊        | 9/50 [01:32<07:01, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0933121 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3163287 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.50252 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0681610 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3533252 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.47517 :
 22%|██▏       | 11/50 [01:52<06:40, 10.28s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0542000 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3805012 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.48522 :
 24%|██▍       | 12/50 [02:03<06:31, 10.29s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0485937 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4284973 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.47005 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0397612 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4255300 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.44910 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6645288 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6722584 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.22s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5698775 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32752 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5693674 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.23s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4503729 :
INFO:model.model_wrapper:******train score at epoch 3: 0.54829 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4339438 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.09221 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.09221
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.30s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3404647 :
INFO:model.model_wrapper:******train score at epoch 4: 0.72877 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3244728 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.42143 :
INFO:model.model_wrapper:validation score is improved from 0.09221 to 0.42143
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:56, 10.35s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2693829 :
INFO:model.model_wrapper:******train score at epoch 5: 0.80591 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2638803 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.45184 :
INFO:model.model_wrapper:validation score is improved from 0.42143 to 0.45184
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:46, 10.36s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1964771 :
INFO:model.model_wrapper:******train score at epoch 6: 0.86524 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2620564 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.55708 :
INFO:model.model_wrapper:validation score is improved from 0.45184 to 0.55708
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:02<07:35, 10.35s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1292059 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2478519 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56973 :
INFO:model.model_wrapper:validation score is improved from 0.55708 to 0.56973
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:12<07:25, 10.37s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1187427 :
INFO:model.model_wrapper:******train score at epoch 8: 0.92565 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2352569 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.48606 :
 16%|█▌        | 8/50 [01:22<07:12, 10.29s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0644227 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2725640 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.54812 :
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0548667 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2985529 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.57788 :
INFO:model.model_wrapper:validation score is improved from 0.56973 to 0.57788
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:43<06:53, 10.34s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0470674 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3542771 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.56897 :
 22%|██▏       | 11/50 [01:53<06:42, 10.31s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0327378 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3361405 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.52709 :
 24%|██▍       | 12/50 [02:03<06:31, 10.30s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0278645 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3403318 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51009 :
 26%|██▌       | 13/50 [02:14<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0257785 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3163602 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.41133 :
 28%|██▊       | 14/50 [02:24<06:10, 10.29s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0150938 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3227862 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.41996 :
 30%|███       | 15/50 [02:34<06:00, 10.30s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0192477 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3944925 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.41585 :
 32%|███▏      | 16/50 [02:45<05:50, 10.32s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0160840 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3673867 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.45087 :
 34%|███▍      | 17/50 [02:55<05:41, 10.34s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0123115 :
INFO:model.model_wrapper:******train score at epoch 18: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3305181 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.44804 :
 36%|███▌      | 18/50 [03:05<05:30, 10.33s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0096344 :
INFO:model.model_wrapper:******train score at epoch 19: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3433689 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.44804 :
 38%|███▊      | 19/50 [03:16<05:20, 10.32s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0138582 :
INFO:model.model_wrapper:******train score at epoch 20: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3496837 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.41133 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6639607 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6478673 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.22s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5392318 :
INFO:model.model_wrapper:******train score at epoch 2: 0.52875 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5921591 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.22869 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.22869
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:13, 10.27s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4310046 :
INFO:model.model_wrapper:******train score at epoch 3: 0.71771 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5210172 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.36613 :
INFO:model.model_wrapper:validation score is improved from 0.22869 to 0.36613
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.28s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3317921 :
INFO:model.model_wrapper:******train score at epoch 4: 0.83291 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4333476 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.54531 :
INFO:model.model_wrapper:validation score is improved from 0.36613 to 0.54531
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.28s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2541926 :
INFO:model.model_wrapper:******train score at epoch 5: 0.90926 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3659401 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.51903 :
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1793635 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3389153 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.55342 :
INFO:model.model_wrapper:validation score is improved from 0.54531 to 0.55342
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:33, 10.32s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1303127 :
INFO:model.model_wrapper:******train score at epoch 7: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3130827 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.48392 :
 14%|█▍        | 7/50 [01:12<07:23, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1062195 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3547455 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.48522 :
 16%|█▌        | 8/50 [01:22<07:11, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0736884 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3166161 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53555 :
 18%|█▊        | 9/50 [01:32<07:01, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0540980 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3679507 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.51894 :
 20%|██        | 10/50 [01:42<06:51, 10.30s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0425855 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3693544 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.51106 :
 22%|██▏       | 11/50 [01:53<06:40, 10.27s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0312505 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3766143 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.50344 :
 24%|██▍       | 12/50 [02:03<06:30, 10.28s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0285855 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3576109 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50344 :
 26%|██▌       | 13/50 [02:13<06:21, 10.30s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0257724 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3391804 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.51894 :
 28%|██▊       | 14/50 [02:23<06:09, 10.26s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0285211 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2910397 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.55342 :
 30%|███       | 15/50 [02:34<05:58, 10.26s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0201238 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3192354 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.53555 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6605935 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5599834 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:25, 10.33s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5484275 :
INFO:model.model_wrapper:******train score at epoch 2: 0.15437 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5112806 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:12, 10.26s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4546226 :
INFO:model.model_wrapper:******train score at epoch 3: 0.46852 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4285443 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.07582 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.07582
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.30s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3396657 :
INFO:model.model_wrapper:******train score at epoch 4: 0.69449 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3393824 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.40781 :
INFO:model.model_wrapper:validation score is improved from 0.07582 to 0.40781
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.32s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2480777 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85973 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2905019 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.50791 :
INFO:model.model_wrapper:validation score is improved from 0.40781 to 0.50791
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:46, 10.36s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1895616 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91601 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2895942 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.55206 :
INFO:model.model_wrapper:validation score is improved from 0.50791 to 0.55206
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:02<07:35, 10.36s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1479020 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3459384 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52874 :
 14%|█▍        | 7/50 [01:12<07:24, 10.33s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1054673 :
INFO:model.model_wrapper:******train score at epoch 8: 0.93867 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3495752 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.52874 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0840358 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2686229 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.48392 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0580170 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2796168 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.48392 :
 20%|██        | 10/50 [01:43<06:52, 10.30s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0494417 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2879339 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.48392 :
 22%|██▏       | 11/50 [01:53<06:40, 10.28s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0354900 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2918952 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.51009 :
 24%|██▍       | 12/50 [02:03<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0307064 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2885310 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50149 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0232298 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3690593 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.54403 :
 28%|██▊       | 14/50 [02:24<06:10, 10.28s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0237399 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4218850 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.53626 :
 30%|███       | 15/50 [02:34<05:59, 10.27s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0178307 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3992017 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.53626 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6618701 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6111209 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:24, 10.30s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5080531 :
INFO:model.model_wrapper:******train score at epoch 2: 0.47545 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5565749 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:12, 10.27s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.3889700 :
INFO:model.model_wrapper:******train score at epoch 3: 0.75135 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4894711 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.28373 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.28373
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.28s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.2887181 :
INFO:model.model_wrapper:******train score at epoch 4: 0.86801 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4055708 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.51970 :
INFO:model.model_wrapper:validation score is improved from 0.28373 to 0.51970
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.29s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2048251 :
INFO:model.model_wrapper:******train score at epoch 5: 0.91026 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3522888 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.52282 :
INFO:model.model_wrapper:validation score is improved from 0.51970 to 0.52282
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:44, 10.32s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1552119 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93346 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2954393 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.47590 :
 12%|█▏        | 6/50 [01:01<07:32, 10.29s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1006793 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3314535 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.45087 :
 14%|█▍        | 7/50 [01:11<07:22, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0810247 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2994736 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.49303 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0509527 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3103875 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.46620 :
 18%|█▊        | 9/50 [01:32<07:01, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0367581 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3363698 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.50252 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0346490 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3523870 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.47517 :
 22%|██▏       | 11/50 [01:53<06:40, 10.27s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0267634 :
INFO:model.model_wrapper:******train score at epoch 12: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4118813 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.50344 :
 24%|██▍       | 12/50 [02:03<06:29, 10.24s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0179079 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4017254 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51106 :
 26%|██▌       | 13/50 [02:13<06:18, 10.23s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0176039 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4471375 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50087 :
 28%|██▊       | 14/50 [02:23<06:09, 10.25s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0142221 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4149533 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.47005 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6677947 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5554908 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.21s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5691349 :
INFO:model.model_wrapper:******train score at epoch 2: 0.20578 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5359003 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:09, 10.20s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4495959 :
INFO:model.model_wrapper:******train score at epoch 3: 0.60624 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4777045 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.29538 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.29538
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.26s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3609809 :
INFO:model.model_wrapper:******train score at epoch 4: 0.75651 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4000465 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.30099 :
INFO:model.model_wrapper:validation score is improved from 0.29538 to 0.30099
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.30s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2730381 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85261 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3252926 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.50791 :
INFO:model.model_wrapper:validation score is improved from 0.30099 to 0.50791
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:45, 10.35s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2073888 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90453 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2883860 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.52833 :
INFO:model.model_wrapper:validation score is improved from 0.50791 to 0.52833
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:02<07:35, 10.36s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1496798 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2747720 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51009 :
 14%|█▍        | 7/50 [01:12<07:24, 10.34s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1063112 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2637264 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.52833 :
 16%|█▌        | 8/50 [01:22<07:12, 10.30s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0826058 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2512509 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.49303 :
 18%|█▊        | 9/50 [01:32<07:02, 10.31s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0610647 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2397219 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.54509 :
INFO:model.model_wrapper:validation score is improved from 0.52833 to 0.54509
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:43<06:53, 10.33s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0483182 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2452675 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.54509 :
 22%|██▏       | 11/50 [01:53<06:42, 10.31s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0388102 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3067900 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53802 :
 24%|██▍       | 12/50 [02:03<06:30, 10.29s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0307632 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3320966 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.47751 :
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0242092 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3987268 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50087 :
 28%|██▊       | 14/50 [02:24<06:09, 10.27s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0233788 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4157663 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.49440 :
 30%|███       | 15/50 [02:34<05:58, 10.25s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0226463 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3838384 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.50753 :
 32%|███▏      | 16/50 [02:44<05:47, 10.23s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0213718 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3511885 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.50344 :
 34%|███▍      | 17/50 [02:54<05:37, 10.24s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0191133 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3119364 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.50149 :
 36%|███▌      | 18/50 [03:05<05:28, 10.28s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0152196 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.2896252 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.52833 :
 38%|███▊      | 19/50 [03:15<05:19, 10.30s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0198442 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3119912 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.50149 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6701582 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5968277 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.21s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5588467 :
INFO:model.model_wrapper:******train score at epoch 2: 0.34777 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5688386 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.24s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4470578 :
INFO:model.model_wrapper:******train score at epoch 3: 0.64723 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5180890 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.18560 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.18560
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.27s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3576036 :
INFO:model.model_wrapper:******train score at epoch 4: 0.74878 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4207144 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.27860 :
INFO:model.model_wrapper:validation score is improved from 0.18560 to 0.27860
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.30s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2610387 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85815 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3604034 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.51244 :
INFO:model.model_wrapper:validation score is improved from 0.27860 to 0.51244
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:45, 10.34s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1997696 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91601 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3357113 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.50149 :
 12%|█▏        | 6/50 [01:01<07:32, 10.29s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1462802 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3152583 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51894 :
INFO:model.model_wrapper:validation score is improved from 0.51244 to 0.51894
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:12<07:22, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1184931 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3362361 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.49606 :
 16%|█▌        | 8/50 [01:22<07:12, 10.30s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0800239 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3257563 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.45587 :
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0608722 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2977335 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.47005 :
 20%|██        | 10/50 [01:42<06:51, 10.28s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0457560 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3126405 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.47005 :
 22%|██▏       | 11/50 [01:53<06:39, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0358042 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3601095 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.45587 :
 24%|██▍       | 12/50 [02:03<06:28, 10.22s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0352353 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3514892 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.47751 :
 26%|██▌       | 13/50 [02:13<06:18, 10.24s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0291841 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3508913 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50344 :
 28%|██▊       | 14/50 [02:23<06:08, 10.23s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0225775 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3549401 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.50344 :
 30%|███       | 15/50 [02:34<05:58, 10.24s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0205160 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3500727 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.50344 :
 32%|███▏      | 16/50 [02:44<05:47, 10.22s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0175070 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3564035 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.50344 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6626852 :
INFO:model.model_wrapper:******train score at epoch 1: 0.18868 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6972865 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:27, 10.36s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5441814 :
INFO:model.model_wrapper:******train score at epoch 2: 0.59701 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6568170 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.18560 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.18560
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:18, 10.38s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4437250 :
INFO:model.model_wrapper:******train score at epoch 3: 0.81254 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6324963 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.35879 :
INFO:model.model_wrapper:validation score is improved from 0.18560 to 0.35879
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:07, 10.38s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3624644 :
INFO:model.model_wrapper:******train score at epoch 4: 0.90347 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5924877 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.53802 :
INFO:model.model_wrapper:validation score is improved from 0.35879 to 0.53802
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:58, 10.40s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2870035 :
INFO:model.model_wrapper:******train score at epoch 5: 0.92681 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5525712 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54431 :
INFO:model.model_wrapper:validation score is improved from 0.53802 to 0.54431
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:47, 10.39s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2386005 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.5021590 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.46677 :
 12%|█▏        | 6/50 [01:02<07:35, 10.35s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1781658 :
INFO:model.model_wrapper:******train score at epoch 7: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4577298 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.47517 :
 14%|█▍        | 7/50 [01:12<07:24, 10.33s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1399540 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4588044 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.52709 :
 16%|█▌        | 8/50 [01:22<07:12, 10.29s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1127682 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4229505 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53555 :
 18%|█▊        | 9/50 [01:32<07:01, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0804062 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3189867 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.49671 :
 20%|██        | 10/50 [01:43<06:51, 10.30s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0639244 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2892451 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.43034 :
 22%|██▏       | 11/50 [01:53<06:42, 10.31s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0488544 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3108731 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.49671 :
 24%|██▍       | 12/50 [02:03<06:30, 10.29s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0425301 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3163359 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50252 :
 26%|██▌       | 13/50 [02:14<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0305403 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3674133 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.59675 :
INFO:model.model_wrapper:validation score is improved from 0.54431 to 0.59675
INFO:model.model_wrapper:Checkpoint saved
 28%|██▊       | 14/50 [02:24<06:11, 10.31s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0278446 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3485378 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.57274 :
 30%|███       | 15/50 [02:34<06:00, 10.30s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0267106 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3330395 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.56288 :
 32%|███▏      | 16/50 [02:44<05:48, 10.26s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0237873 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3275203 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.48606 :
 34%|███▍      | 17/50 [02:55<05:38, 10.25s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0177913 :
INFO:model.model_wrapper:******train score at epoch 18: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3403196 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.44834 :
 36%|███▌      | 18/50 [03:05<05:27, 10.24s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0152776 :
INFO:model.model_wrapper:******train score at epoch 19: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3112727 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.46969 :
 38%|███▊      | 19/50 [03:15<05:16, 10.22s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0156769 :
INFO:model.model_wrapper:******train score at epoch 20: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3428196 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.46969 :
 40%|████      | 20/50 [03:25<05:07, 10.25s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0131636 :
INFO:model.model_wrapper:******train score at epoch 21: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3423056 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.49671 :
 42%|████▏     | 21/50 [03:36<04:56, 10.23s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0150931 :
INFO:model.model_wrapper:******train score at epoch 22: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.3709489 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.52282 :
 44%|████▍     | 22/50 [03:46<04:46, 10.23s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0106311 :
INFO:model.model_wrapper:******train score at epoch 23: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.3607276 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.52282 :
 46%|████▌     | 23/50 [03:56<04:35, 10.21s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.0207559 :
INFO:model.model_wrapper:******train score at epoch 24: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.5130377 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.48198 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6649419 :
INFO:model.model_wrapper:******train score at epoch 1: 0.12010 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6918505 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:17, 10.16s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5555299 :
INFO:model.model_wrapper:******train score at epoch 2: 0.58789 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6676383 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.21472 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.21472
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:11, 10.24s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4605137 :
INFO:model.model_wrapper:******train score at epoch 3: 0.75271 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6176209 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.27860 :
INFO:model.model_wrapper:validation score is improved from 0.21472 to 0.27860
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.24s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3794012 :
INFO:model.model_wrapper:******train score at epoch 4: 0.84708 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5838825 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.54431 :
INFO:model.model_wrapper:validation score is improved from 0.27860 to 0.54431
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.27s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3172908 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89517 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5655495 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.49440 :
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2647733 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93214 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4817784 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.45587 :
 12%|█▏        | 6/50 [01:01<07:28, 10.19s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2003032 :
INFO:model.model_wrapper:******train score at epoch 7: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4458980 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52874 :
 14%|█▍        | 7/50 [01:11<07:18, 10.19s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1563126 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4526226 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.52146 :
 16%|█▌        | 8/50 [01:21<07:07, 10.18s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1244577 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3925117 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.49606 :
 18%|█▊        | 9/50 [01:32<06:58, 10.22s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0955994 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3574795 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.48522 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0764828 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3448720 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.49321 :
 22%|██▏       | 11/50 [01:52<06:38, 10.22s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0621481 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3790251 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.46284 :
 24%|██▍       | 12/50 [02:02<06:27, 10.20s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0548043 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3797281 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.49606 :
 26%|██▌       | 13/50 [02:12<06:17, 10.19s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0414474 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3434419 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.51106 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6590206 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07931 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6813377 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.19s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5307565 :
INFO:model.model_wrapper:******train score at epoch 2: 0.44554 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5809320 :
INFO:model.model_wrapper:******valid score at epoch 2: -0.01508 :
  4%|▍         | 2/50 [00:20<08:09, 10.20s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4139605 :
INFO:model.model_wrapper:******train score at epoch 3: 0.78496 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4969914 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.36181 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.36181
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:00, 10.23s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3147427 :
INFO:model.model_wrapper:******train score at epoch 4: 0.84708 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4403712 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.51903 :
INFO:model.model_wrapper:validation score is improved from 0.36181 to 0.51903
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:51, 10.25s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2223688 :
INFO:model.model_wrapper:******train score at epoch 5: 0.92093 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3996905 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53626 :
INFO:model.model_wrapper:validation score is improved from 0.51903 to 0.53626
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:40, 10.24s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1688636 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93867 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3470230 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.54403 :
INFO:model.model_wrapper:validation score is improved from 0.53626 to 0.54403
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:30, 10.24s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1296703 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94465 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3415863 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55206 :
INFO:model.model_wrapper:validation score is improved from 0.54403 to 0.55206
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:11<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0816660 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3519508 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.54403 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0633674 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3513307 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.55206 :
 18%|█▊        | 9/50 [01:32<06:59, 10.23s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0525228 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3814134 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.52874 :
 20%|██        | 10/50 [01:42<06:49, 10.23s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0352105 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4029549 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.50753 :
 22%|██▏       | 11/50 [01:52<06:38, 10.22s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0282226 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4436847 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.49440 :
 24%|██▍       | 12/50 [02:02<06:28, 10.23s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0292489 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5008216 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.48811 :
 26%|██▌       | 13/50 [02:13<06:17, 10.20s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0235190 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4408644 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.51439 :
 28%|██▊       | 14/50 [02:23<06:06, 10.19s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0212955 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4787478 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.52146 :
 30%|███       | 15/50 [02:33<05:56, 10.19s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0196776 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4432803 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.52146 :
 32%|███▏      | 16/50 [02:43<05:45, 10.16s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0155100 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4395164 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.52146 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 3 / 10 ****
INFO:runner.model.base_runner:****cv 3 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6564055 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6153622 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:18, 10.17s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5363828 :
INFO:model.model_wrapper:******train score at epoch 2: 0.28475 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5275813 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:09, 10.19s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4271901 :
INFO:model.model_wrapper:******train score at epoch 3: 0.53399 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4515101 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.20133 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.20133
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:00, 10.22s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3359265 :
INFO:model.model_wrapper:******train score at epoch 4: 0.66720 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3643207 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.45352 :
INFO:model.model_wrapper:validation score is improved from 0.20133 to 0.45352
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:51, 10.26s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2557291 :
INFO:model.model_wrapper:******train score at epoch 5: 0.80712 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3168163 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.47517 :
INFO:model.model_wrapper:validation score is improved from 0.45352 to 0.47517
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:41, 10.26s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1865326 :
INFO:model.model_wrapper:******train score at epoch 6: 0.89671 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3211933 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.43618 :
 12%|█▏        | 6/50 [01:01<07:30, 10.25s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1363669 :
INFO:model.model_wrapper:******train score at epoch 7: 0.91601 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3698565 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.41247 :
 14%|█▍        | 7/50 [01:11<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0968518 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4078416 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.43325 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0749291 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3998777 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.43878 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0484703 :
INFO:model.model_wrapper:******train score at epoch 10: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4286455 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.43325 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0444210 :
INFO:model.model_wrapper:******train score at epoch 11: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4582756 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.43325 :
 22%|██▏       | 11/50 [01:52<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0288335 :
INFO:model.model_wrapper:******train score at epoch 12: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5004920 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.43878 :
 24%|██▍       | 12/50 [02:03<06:30, 10.29s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0254762 :
INFO:model.model_wrapper:******train score at epoch 13: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4951759 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.43878 :
 26%|██▌       | 13/50 [02:13<06:20, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0219750 :
INFO:model.model_wrapper:******train score at epoch 14: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5948292 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.41745 :
 28%|██▊       | 14/50 [02:23<06:09, 10.27s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0204180 :
INFO:model.model_wrapper:******train score at epoch 15: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.5838196 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.41243 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6713457 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5982514 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:25, 10.31s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5767953 :
INFO:model.model_wrapper:******train score at epoch 2: 0.24701 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5447021 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:14, 10.30s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4657754 :
INFO:model.model_wrapper:******train score at epoch 3: 0.57735 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4932273 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.32310 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.32310
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:05, 10.32s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3679908 :
INFO:model.model_wrapper:******train score at epoch 4: 0.78032 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4893929 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.48522 :
INFO:model.model_wrapper:validation score is improved from 0.32310 to 0.48522
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:57, 10.38s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2875157 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87494 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5019051 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.41247 :
 10%|█         | 5/50 [00:51<07:44, 10.33s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2243384 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.5238873 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.42259 :
 12%|█▏        | 6/50 [01:01<07:34, 10.32s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1657067 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4904630 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.45364 :
 14%|█▍        | 7/50 [01:12<07:22, 10.29s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1273183 :
INFO:model.model_wrapper:******train score at epoch 8: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4788188 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.43325 :
 16%|█▌        | 8/50 [01:22<07:10, 10.25s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0873291 :
INFO:model.model_wrapper:******train score at epoch 9: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4562144 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.47529 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0650755 :
INFO:model.model_wrapper:******train score at epoch 10: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4202690 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.48892 :
INFO:model.model_wrapper:validation score is improved from 0.48522 to 0.48892
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:43<06:52, 10.31s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0601586 :
INFO:model.model_wrapper:******train score at epoch 11: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4365626 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.50344 :
INFO:model.model_wrapper:validation score is improved from 0.48892 to 0.50344
INFO:model.model_wrapper:Checkpoint saved
 22%|██▏       | 11/50 [01:53<06:43, 10.33s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0457256 :
INFO:model.model_wrapper:******train score at epoch 12: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4931345 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.48200 :
 24%|██▍       | 12/50 [02:03<06:31, 10.30s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0342069 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4790283 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.48200 :
 26%|██▌       | 13/50 [02:14<06:21, 10.32s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0293450 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5353827 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.46877 :
 28%|██▊       | 14/50 [02:24<06:10, 10.30s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0296887 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.6133759 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.45903 :
 30%|███       | 15/50 [02:34<05:59, 10.28s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0240462 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.6795631 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.43822 :
 32%|███▏      | 16/50 [02:44<05:49, 10.28s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0210870 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.6284081 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.43822 :
 34%|███▍      | 17/50 [02:55<05:38, 10.26s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0184968 :
INFO:model.model_wrapper:******train score at epoch 18: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.5737936 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.47602 :
 36%|███▌      | 18/50 [03:05<05:28, 10.26s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0190346 :
INFO:model.model_wrapper:******train score at epoch 19: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.5156195 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.46244 :
 38%|███▊      | 19/50 [03:15<05:18, 10.26s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0163964 :
INFO:model.model_wrapper:******train score at epoch 20: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.5952215 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.45029 :
 40%|████      | 20/50 [03:25<05:08, 10.27s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0137571 :
INFO:model.model_wrapper:******train score at epoch 21: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.6275444 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.43878 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6768342 :
INFO:model.model_wrapper:******train score at epoch 1: 0.12599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7040876 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:17, 10.15s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5735800 :
INFO:model.model_wrapper:******train score at epoch 2: 0.45557 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6615127 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.29538 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.29538
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:10, 10.22s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4749640 :
INFO:model.model_wrapper:******train score at epoch 3: 0.73380 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5989434 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.32310 :
INFO:model.model_wrapper:validation score is improved from 0.29538 to 0.32310
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:07, 10.37s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3784441 :
INFO:model.model_wrapper:******train score at epoch 4: 0.79311 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5252089 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.52015 :
INFO:model.model_wrapper:validation score is improved from 0.32310 to 0.52015
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:56, 10.35s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3083696 :
INFO:model.model_wrapper:******train score at epoch 5: 0.86524 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4722403 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.47751 :
 10%|█         | 5/50 [00:51<07:44, 10.32s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2437549 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92180 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4552361 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.42400 :
 12%|█▏        | 6/50 [01:02<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1807248 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4819368 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.45903 :
 14%|█▍        | 7/50 [01:12<07:22, 10.29s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1292403 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4234022 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.46455 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0986367 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4503239 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.47602 :
 18%|█▊        | 9/50 [01:32<07:01, 10.29s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0699196 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4827046 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.46455 :
 20%|██        | 10/50 [01:43<06:52, 10.32s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0500312 :
INFO:model.model_wrapper:******train score at epoch 11: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.5863279 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.43331 :
 22%|██▏       | 11/50 [01:53<06:41, 10.30s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0546523 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98127 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5963767 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.44324 :
 24%|██▍       | 12/50 [02:03<06:30, 10.29s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0343009 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5415322 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.47602 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0270054 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5257738 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.48198 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6719117 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6497802 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:25, 10.31s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5660456 :
INFO:model.model_wrapper:******train score at epoch 2: 0.30966 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5811471 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:14, 10.30s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4708067 :
INFO:model.model_wrapper:******train score at epoch 3: 0.40452 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4621479 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.14589 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.14589
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:05, 10.33s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3826993 :
INFO:model.model_wrapper:******train score at epoch 4: 0.62071 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3300263 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.37721 :
INFO:model.model_wrapper:validation score is improved from 0.14589 to 0.37721
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.32s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2920670 :
INFO:model.model_wrapper:******train score at epoch 5: 0.73885 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2597027 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.59717 :
INFO:model.model_wrapper:validation score is improved from 0.37721 to 0.59717
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:44, 10.33s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2213400 :
INFO:model.model_wrapper:******train score at epoch 6: 0.85424 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2803525 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.50149 :
 12%|█▏        | 6/50 [01:01<07:32, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1561076 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92180 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3280512 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.44910 :
 14%|█▍        | 7/50 [01:12<07:21, 10.27s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1327170 :
INFO:model.model_wrapper:******train score at epoch 8: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3258973 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.47751 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1116549 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3722104 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.43618 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0670621 :
INFO:model.model_wrapper:******train score at epoch 10: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4760328 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.41243 :
 20%|██        | 10/50 [01:42<06:49, 10.24s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0520142 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.5151218 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.37182 :
 22%|██▏       | 11/50 [01:53<06:39, 10.23s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0442641 :
INFO:model.model_wrapper:******train score at epoch 12: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5071882 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.38126 :
 24%|██▍       | 12/50 [02:03<06:28, 10.23s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0353171 :
INFO:model.model_wrapper:******train score at epoch 13: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4606571 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.41247 :
 26%|██▌       | 13/50 [02:13<06:17, 10.22s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0274695 :
INFO:model.model_wrapper:******train score at epoch 14: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4685855 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.43618 :
 28%|██▊       | 14/50 [02:23<06:07, 10.22s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0233399 :
INFO:model.model_wrapper:******train score at epoch 15: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4525333 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.41567 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6653843 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09728 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6647543 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5602515 :
INFO:model.model_wrapper:******train score at epoch 2: 0.36757 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6139287 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:12, 10.26s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4663405 :
INFO:model.model_wrapper:******train score at epoch 3: 0.66930 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5413772 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.18649 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.18649
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.29s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3574985 :
INFO:model.model_wrapper:******train score at epoch 4: 0.80908 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4636857 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.47590 :
INFO:model.model_wrapper:validation score is improved from 0.18649 to 0.47590
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:55, 10.33s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2790179 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89770 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4149185 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.39708 :
 10%|█         | 5/50 [00:51<07:43, 10.30s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2049300 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3947359 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.42400 :
 12%|█▏        | 6/50 [01:01<07:32, 10.28s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1638216 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4346555 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.41816 :
 14%|█▍        | 7/50 [01:12<07:23, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1134003 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4913404 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.40694 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1093758 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3815009 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.43000 :
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0636500 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3255056 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.45587 :
 20%|██        | 10/50 [01:42<06:51, 10.28s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0665151 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4410239 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.45029 :
 22%|██▏       | 11/50 [01:53<06:40, 10.28s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0367453 :
INFO:model.model_wrapper:******train score at epoch 12: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5705365 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.41921 :
 24%|██▍       | 12/50 [02:03<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0408675 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98750 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5403785 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.45029 :
 26%|██▌       | 13/50 [02:13<06:18, 10.24s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0270615 :
INFO:model.model_wrapper:******train score at epoch 14: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4082190 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.43608 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6590679 :
INFO:model.model_wrapper:******train score at epoch 1: 0.11251 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6719151 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5592360 :
INFO:model.model_wrapper:******train score at epoch 2: 0.47381 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6450785 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.22869 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.22869
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:13, 10.28s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4624950 :
INFO:model.model_wrapper:******train score at epoch 3: 0.72025 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5774233 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.18649 :
  6%|▌         | 3/50 [00:30<08:03, 10.28s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3549626 :
INFO:model.model_wrapper:******train score at epoch 4: 0.83066 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5153871 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.47517 :
INFO:model.model_wrapper:validation score is improved from 0.22869 to 0.47517
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.30s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2857786 :
INFO:model.model_wrapper:******train score at epoch 5: 0.90347 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4991207 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.40694 :
 10%|█         | 5/50 [00:51<07:42, 10.28s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2246261 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93273 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4780472 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.37182 :
 12%|█▏        | 6/50 [01:01<07:31, 10.25s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1653726 :
INFO:model.model_wrapper:******train score at epoch 7: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4752875 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.39116 :
 14%|█▍        | 7/50 [01:11<07:20, 10.25s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1236576 :
INFO:model.model_wrapper:******train score at epoch 8: 0.98127 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4551675 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.41247 :
 16%|█▌        | 8/50 [01:22<07:11, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0950913 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4871561 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.41816 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0670530 :
INFO:model.model_wrapper:******train score at epoch 10: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.5046848 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.40694 :
 20%|██        | 10/50 [01:42<06:49, 10.24s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0531227 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.5152624 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.40694 :
 22%|██▏       | 11/50 [01:52<06:39, 10.24s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0384797 :
INFO:model.model_wrapper:******train score at epoch 12: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5234880 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.40694 :
 24%|██▍       | 12/50 [02:03<06:29, 10.24s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0316492 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4925385 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.41816 :
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0236228 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4731832 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.42400 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6643277 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07931 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6578296 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:24, 10.30s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5457549 :
INFO:model.model_wrapper:******train score at epoch 2: 0.44554 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6044094 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:15, 10.33s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4330185 :
INFO:model.model_wrapper:******train score at epoch 3: 0.64102 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5256754 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.20892 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.20892
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:06, 10.35s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3317729 :
INFO:model.model_wrapper:******train score at epoch 4: 0.76688 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4564543 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.43132 :
INFO:model.model_wrapper:validation score is improved from 0.20892 to 0.43132
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:56, 10.36s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2459363 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87077 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4023560 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.45587 :
INFO:model.model_wrapper:validation score is improved from 0.43132 to 0.45587
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:46, 10.36s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1813605 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3671377 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.44910 :
 12%|█▏        | 6/50 [01:02<07:34, 10.32s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1309744 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3786319 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.43618 :
 14%|█▍        | 7/50 [01:12<07:21, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0851644 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4119840 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.42400 :
 16%|█▌        | 8/50 [01:22<07:12, 10.30s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0662403 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4047244 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.46877 :
INFO:model.model_wrapper:validation score is improved from 0.45587 to 0.46877
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:33<07:03, 10.33s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0439403 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3778129 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.47751 :
INFO:model.model_wrapper:validation score is improved from 0.46877 to 0.47751
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:43<06:54, 10.36s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0365717 :
INFO:model.model_wrapper:******train score at epoch 11: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4232213 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.48200 :
INFO:model.model_wrapper:validation score is improved from 0.47751 to 0.48200
INFO:model.model_wrapper:Checkpoint saved
 22%|██▏       | 11/50 [01:53<06:44, 10.36s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0250116 :
INFO:model.model_wrapper:******train score at epoch 12: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5107908 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.45029 :
 24%|██▍       | 12/50 [02:04<06:32, 10.32s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0213435 :
INFO:model.model_wrapper:******train score at epoch 13: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5673128 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.44446 :
 26%|██▌       | 13/50 [02:14<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0161756 :
INFO:model.model_wrapper:******train score at epoch 14: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5862913 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.44446 :
 28%|██▊       | 14/50 [02:24<06:10, 10.29s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0145106 :
INFO:model.model_wrapper:******train score at epoch 15: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.5723646 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.45029 :
 30%|███       | 15/50 [02:34<05:59, 10.28s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0128736 :
INFO:model.model_wrapper:******train score at epoch 16: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.5478050 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.43000 :
 32%|███▏      | 16/50 [02:45<05:49, 10.28s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0191073 :
INFO:model.model_wrapper:******train score at epoch 17: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.5227915 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.45587 :
 34%|███▍      | 17/50 [02:55<05:38, 10.26s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0103238 :
INFO:model.model_wrapper:******train score at epoch 18: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.5399720 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.44910 :
 36%|███▌      | 18/50 [03:05<05:28, 10.26s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0098057 :
INFO:model.model_wrapper:******train score at epoch 19: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.5086661 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.45587 :
 38%|███▊      | 19/50 [03:15<05:17, 10.25s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0220438 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.8795017 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.37605 :
 40%|████      | 20/50 [03:26<05:07, 10.26s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0103943 :
INFO:model.model_wrapper:******train score at epoch 21: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.9584701 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.36387 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6627309 :
INFO:model.model_wrapper:******train score at epoch 1: 0.20074 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7350935 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.22s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5596028 :
INFO:model.model_wrapper:******train score at epoch 2: 0.51905 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6235815 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.22869 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.22869
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:13, 10.27s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4434525 :
INFO:model.model_wrapper:******train score at epoch 3: 0.72025 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4974156 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.26480 :
INFO:model.model_wrapper:validation score is improved from 0.22869 to 0.26480
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:04, 10.31s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3623734 :
INFO:model.model_wrapper:******train score at epoch 4: 0.78544 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3987072 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.53481 :
INFO:model.model_wrapper:validation score is improved from 0.26480 to 0.53481
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.31s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2684961 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87370 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3585276 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.48522 :
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1946595 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90347 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4218765 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.40694 :
 12%|█▏        | 6/50 [01:01<07:30, 10.25s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1408419 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4493418 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.41816 :
 14%|█▍        | 7/50 [01:11<07:21, 10.27s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0922530 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4109664 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.43000 :
 16%|█▌        | 8/50 [01:22<07:12, 10.31s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0689390 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3818128 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.44255 :
 18%|█▊        | 9/50 [01:32<07:01, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0470426 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4320112 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.43618 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0382738 :
INFO:model.model_wrapper:******train score at epoch 11: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4914239 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.41816 :
 22%|██▏       | 11/50 [01:53<06:40, 10.27s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0290861 :
INFO:model.model_wrapper:******train score at epoch 12: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5601406 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.41745 :
 24%|██▍       | 12/50 [02:03<06:30, 10.27s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0287816 :
INFO:model.model_wrapper:******train score at epoch 13: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5602266 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.40694 :
 26%|██▌       | 13/50 [02:13<06:19, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0254126 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4663614 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.43618 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6664024 :
INFO:model.model_wrapper:******train score at epoch 1: 0.18868 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7624726 :
INFO:model.model_wrapper:******valid score at epoch 1: 0.25625 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.25625
INFO:model.model_wrapper:Checkpoint saved
  2%|▏         | 1/50 [00:10<08:24, 10.30s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5547223 :
INFO:model.model_wrapper:******train score at epoch 2: 0.60188 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.7040178 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.30580 :
INFO:model.model_wrapper:validation score is improved from 0.25625 to 0.30580
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:15, 10.32s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4486453 :
INFO:model.model_wrapper:******train score at epoch 3: 0.78899 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6643261 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.31966 :
INFO:model.model_wrapper:validation score is improved from 0.30580 to 0.31966
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:04, 10.32s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3736087 :
INFO:model.model_wrapper:******train score at epoch 4: 0.82458 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.6144145 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.40928 :
INFO:model.model_wrapper:validation score is improved from 0.31966 to 0.40928
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.32s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2741222 :
INFO:model.model_wrapper:******train score at epoch 5: 0.90176 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5419109 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.38556 :
 10%|█         | 5/50 [00:51<07:42, 10.28s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1961133 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.5449640 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.34054 :
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1449254 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.5294304 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.35933 :
 14%|█▍        | 7/50 [01:12<07:22, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1038891 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.5143102 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.34508 :
 16%|█▌        | 8/50 [01:22<07:11, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0780488 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.5548424 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.38126 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0615112 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.6031181 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.37182 :
 20%|██        | 10/50 [01:42<06:51, 10.28s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0436197 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.6079004 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.37649 :
 22%|██▏       | 11/50 [01:53<06:39, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0300314 :
INFO:model.model_wrapper:******train score at epoch 12: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.6321236 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.39805 :
 24%|██▍       | 12/50 [02:03<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0256988 :
INFO:model.model_wrapper:******train score at epoch 13: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.6514374 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.39805 :
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0240163 :
INFO:model.model_wrapper:******train score at epoch 14: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.6151099 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.37649 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6726064 :
INFO:model.model_wrapper:******train score at epoch 1: 0.03243 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6884319 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:25, 10.31s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5514883 :
INFO:model.model_wrapper:******train score at epoch 2: 0.48038 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6067781 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:14, 10.31s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4452199 :
INFO:model.model_wrapper:******train score at epoch 3: 0.62026 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4902421 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.18649 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.18649
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:04, 10.31s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3266783 :
INFO:model.model_wrapper:******train score at epoch 4: 0.82893 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3720724 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.59346 :
INFO:model.model_wrapper:validation score is improved from 0.18649 to 0.59346
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:55, 10.35s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2501747 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89884 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3196709 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.44910 :
 10%|█         | 5/50 [00:51<07:44, 10.32s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1722786 :
INFO:model.model_wrapper:******train score at epoch 6: 0.94465 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3185945 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.43618 :
 12%|█▏        | 6/50 [01:01<07:33, 10.32s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1311295 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3488986 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.43618 :
 14%|█▍        | 7/50 [01:12<07:22, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0887927 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3785309 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.41816 :
 16%|█▌        | 8/50 [01:22<07:10, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0743095 :
INFO:model.model_wrapper:******train score at epoch 9: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4019204 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.43618 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0445185 :
INFO:model.model_wrapper:******train score at epoch 10: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4062253 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.43000 :
 20%|██        | 10/50 [01:42<06:51, 10.28s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0437940 :
INFO:model.model_wrapper:******train score at epoch 11: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3938686 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.45587 :
 22%|██▏       | 11/50 [01:53<06:39, 10.24s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0271453 :
INFO:model.model_wrapper:******train score at epoch 12: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4671145 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.41816 :
 24%|██▍       | 12/50 [02:03<06:30, 10.27s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0226187 :
INFO:model.model_wrapper:******train score at epoch 13: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5541604 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.40694 :
 26%|██▌       | 13/50 [02:13<06:21, 10.30s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0164063 :
INFO:model.model_wrapper:******train score at epoch 14: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5700404 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.40155 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 4 / 10 ****
INFO:runner.model.base_runner:****cv 4 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6622968 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09728 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6508832 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:27, 10.36s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5462881 :
INFO:model.model_wrapper:******train score at epoch 2: 0.53364 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5841411 :
INFO:model.model_wrapper:******valid score at epoch 2: -0.01508 :
  4%|▍         | 2/50 [00:20<08:17, 10.36s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4422624 :
INFO:model.model_wrapper:******train score at epoch 3: 0.76547 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4881118 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.44853 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.44853
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:06, 10.34s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3452166 :
INFO:model.model_wrapper:******train score at epoch 4: 0.89197 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4254410 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.63396 :
INFO:model.model_wrapper:validation score is improved from 0.44853 to 0.63396
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:58, 10.39s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2519234 :
INFO:model.model_wrapper:******train score at epoch 5: 0.93273 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3815497 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.48522 :
 10%|█         | 5/50 [00:51<07:46, 10.36s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1807937 :
INFO:model.model_wrapper:******train score at epoch 6: 0.94421 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3486001 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.46284 :
 12%|█▏        | 6/50 [01:02<07:34, 10.33s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1283957 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96892 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3064947 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51106 :
 14%|█▍        | 7/50 [01:12<07:22, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1016249 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96892 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3391216 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.48892 :
 16%|█▌        | 8/50 [01:22<07:12, 10.29s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0649697 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3508855 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.52146 :
 18%|█▊        | 9/50 [01:32<07:02, 10.31s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0550882 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3887714 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.52146 :
 20%|██        | 10/50 [01:43<06:52, 10.31s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0493861 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3563527 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.53626 :
 22%|██▏       | 11/50 [01:53<06:41, 10.29s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0379761 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3471204 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.52709 :
 24%|██▍       | 12/50 [02:03<06:31, 10.29s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0310775 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3802236 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51106 :
 26%|██▌       | 13/50 [02:14<06:21, 10.31s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0226985 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3750234 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50344 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6626806 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6307177 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:23, 10.28s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5567384 :
INFO:model.model_wrapper:******train score at epoch 2: 0.28108 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5599095 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:14, 10.30s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4533919 :
INFO:model.model_wrapper:******train score at epoch 3: 0.59507 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4479097 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.29538 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.29538
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:04, 10.30s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3486508 :
INFO:model.model_wrapper:******train score at epoch 4: 0.78032 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3311661 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.66593 :
INFO:model.model_wrapper:validation score is improved from 0.29538 to 0.66593
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.31s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2554537 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85111 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2938785 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54812 :
 10%|█         | 5/50 [00:51<07:43, 10.31s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1994407 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92021 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2642142 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.53802 :
 12%|█▏        | 6/50 [01:01<07:31, 10.27s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1474736 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2673510 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52833 :
 14%|█▍        | 7/50 [01:12<07:21, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0971300 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2732888 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.51903 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0797727 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2961144 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53555 :
 18%|█▊        | 9/50 [01:32<07:00, 10.26s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0598499 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3407377 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.49606 :
 20%|██        | 10/50 [01:43<06:53, 10.33s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0453767 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3677400 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.46244 :
 22%|██▏       | 11/50 [01:53<06:42, 10.32s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0361623 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3726412 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.46877 :
 24%|██▍       | 12/50 [02:03<06:31, 10.30s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0338171 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3957663 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50087 :
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0252556 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4031595 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50753 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6643966 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6224438 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:23, 10.27s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5305345 :
INFO:model.model_wrapper:******train score at epoch 2: 0.50488 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5900657 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.15131 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.15131
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:13, 10.27s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4309929 :
INFO:model.model_wrapper:******train score at epoch 3: 0.70250 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5427167 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.61214 :
INFO:model.model_wrapper:validation score is improved from 0.15131 to 0.61214
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:05, 10.34s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3289599 :
INFO:model.model_wrapper:******train score at epoch 4: 0.85424 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5139987 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.51439 :
  8%|▊         | 4/50 [00:41<07:54, 10.31s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2435570 :
INFO:model.model_wrapper:******train score at epoch 5: 0.90254 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4700793 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.51439 :
 10%|█         | 5/50 [00:51<07:43, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1754835 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4377288 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.48811 :
 12%|█▏        | 6/50 [01:01<07:32, 10.29s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1392058 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95672 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3507984 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51106 :
 14%|█▍        | 7/50 [01:12<07:21, 10.27s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0912650 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3261786 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.51009 :
 16%|█▌        | 8/50 [01:22<07:10, 10.25s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0735443 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3616069 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.47751 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0566018 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3969774 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.52146 :
 20%|██        | 10/50 [01:42<06:52, 10.30s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0446111 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3926550 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.50344 :
 22%|██▏       | 11/50 [01:53<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0310715 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3996633 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.51106 :
 24%|██▍       | 12/50 [02:03<06:29, 10.24s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0309415 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4144049 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.49606 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6603450 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5948434 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:22, 10.25s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5316768 :
INFO:model.model_wrapper:******train score at epoch 2: 0.40258 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4989458 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:12, 10.26s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4174169 :
INFO:model.model_wrapper:******train score at epoch 3: 0.72577 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4030755 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.39305 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.39305
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:04, 10.31s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3097895 :
INFO:model.model_wrapper:******train score at epoch 4: 0.84334 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3334142 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.51970 :
INFO:model.model_wrapper:validation score is improved from 0.39305 to 0.51970
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.29s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2292622 :
INFO:model.model_wrapper:******train score at epoch 5: 0.90926 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2979720 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.51009 :
 10%|█         | 5/50 [00:51<07:41, 10.26s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1627385 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92616 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2737458 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.54431 :
INFO:model.model_wrapper:validation score is improved from 0.51970 to 0.54431
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1071598 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2768758 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51903 :
 14%|█▍        | 7/50 [01:11<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0770100 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3081189 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.55206 :
INFO:model.model_wrapper:validation score is improved from 0.54431 to 0.55206
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0612169 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3538420 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53626 :
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0482109 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3600960 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.52874 :
 20%|██        | 10/50 [01:42<06:52, 10.32s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0411385 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4036357 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52146 :
 22%|██▏       | 11/50 [01:53<06:41, 10.29s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0315781 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4371653 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.48811 :
 24%|██▍       | 12/50 [02:03<06:30, 10.27s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0310538 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4352319 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.49440 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0243672 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4602577 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50087 :
 28%|██▊       | 14/50 [02:23<06:08, 10.23s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0195644 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.5086315 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.49440 :
 30%|███       | 15/50 [02:34<05:57, 10.23s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0172119 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4850815 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.49440 :
 32%|███▏      | 16/50 [02:44<05:47, 10.23s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0150413 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.5160394 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.50087 :
 34%|███▍      | 17/50 [02:54<05:37, 10.22s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0114517 :
INFO:model.model_wrapper:******train score at epoch 18: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4782184 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.50753 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6785097 :
INFO:model.model_wrapper:******train score at epoch 1: 0.12010 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7138031 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5761826 :
INFO:model.model_wrapper:******train score at epoch 2: 0.50975 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6876663 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.32397 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.32397
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:14, 10.31s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4644310 :
INFO:model.model_wrapper:******train score at epoch 3: 0.74620 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5814472 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.56595 :
INFO:model.model_wrapper:validation score is improved from 0.32397 to 0.56595
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:04, 10.32s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3489551 :
INFO:model.model_wrapper:******train score at epoch 4: 0.84708 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4640652 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.64902 :
INFO:model.model_wrapper:validation score is improved from 0.56595 to 0.64902
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.31s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2676594 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88627 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3913856 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54431 :
 10%|█         | 5/50 [00:51<07:43, 10.30s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2049043 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91601 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4256587 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.49440 :
 12%|█▏        | 6/50 [01:01<07:31, 10.27s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1409381 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4000977 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.49440 :
 14%|█▍        | 7/50 [01:12<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1152742 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95030 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3434717 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.55342 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0764261 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3061877 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.56288 :
 18%|█▊        | 9/50 [01:32<07:01, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0608717 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3811288 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.51106 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0427469 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4311643 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.49440 :
 22%|██▏       | 11/50 [01:53<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0371608 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4218729 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.46244 :
 24%|██▍       | 12/50 [02:03<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0317180 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4506013 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.46244 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0308636 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4720309 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.46244 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6710281 :
INFO:model.model_wrapper:******train score at epoch 1: 0.11251 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6274535 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.20s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5924981 :
INFO:model.model_wrapper:******train score at epoch 2: 0.29111 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5692417 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:09, 10.20s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4912973 :
INFO:model.model_wrapper:******train score at epoch 3: 0.50911 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4566372 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.25625 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.25625
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.24s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3794503 :
INFO:model.model_wrapper:******train score at epoch 4: 0.69552 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3337846 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.66418 :
INFO:model.model_wrapper:validation score is improved from 0.25625 to 0.66418
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.29s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2928584 :
INFO:model.model_wrapper:******train score at epoch 5: 0.82182 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2516566 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.62807 :
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2154040 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91026 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2195009 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.58131 :
 12%|█▏        | 6/50 [01:01<07:31, 10.25s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1563121 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2339397 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.54431 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1211741 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95672 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2423696 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.57274 :
 16%|█▌        | 8/50 [01:22<07:10, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0944599 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2729069 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.58300 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0605271 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2705669 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.58300 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0495558 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2382549 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.58300 :
 22%|██▏       | 11/50 [01:52<06:39, 10.24s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0481805 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3408621 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.50344 :
 24%|██▍       | 12/50 [02:03<06:30, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0310118 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3456074 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50344 :
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0227782 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3639332 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50344 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6722665 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09728 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6705836 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:27, 10.36s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5631478 :
INFO:model.model_wrapper:******train score at epoch 2: 0.46437 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5987002 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:16, 10.34s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4657743 :
INFO:model.model_wrapper:******train score at epoch 3: 0.67724 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5253238 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.36429 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.36429
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:06, 10.35s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3681220 :
INFO:model.model_wrapper:******train score at epoch 4: 0.76009 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4445457 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.58305 :
INFO:model.model_wrapper:validation score is improved from 0.36429 to 0.58305
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:57, 10.38s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2990393 :
INFO:model.model_wrapper:******train score at epoch 5: 0.86112 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3881474 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54812 :
 10%|█         | 5/50 [00:51<07:45, 10.35s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2261427 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90840 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2813180 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.64902 :
INFO:model.model_wrapper:validation score is improved from 0.58305 to 0.64902
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:02<07:35, 10.36s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1595174 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2791960 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.53802 :
 14%|█▍        | 7/50 [01:12<07:24, 10.34s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1230478 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3668101 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.51894 :
 16%|█▌        | 8/50 [01:22<07:13, 10.33s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0898336 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2959736 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.52833 :
 18%|█▊        | 9/50 [01:33<07:03, 10.33s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0656307 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2986402 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.52833 :
 20%|██        | 10/50 [01:43<06:53, 10.35s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0510654 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3401623 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.48522 :
 22%|██▏       | 11/50 [01:53<06:42, 10.31s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0394067 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3582537 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.47005 :
 24%|██▍       | 12/50 [02:03<06:30, 10.28s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0431482 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3783853 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.46284 :
 26%|██▌       | 13/50 [02:14<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0256761 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2773292 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.52282 :
 28%|██▊       | 14/50 [02:24<06:09, 10.25s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0458624 :
INFO:model.model_wrapper:******train score at epoch 15: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3591402 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.50149 :
 30%|███       | 15/50 [02:34<05:59, 10.28s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0367747 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98750 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.6305253 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.42381 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6788602 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5378377 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:26, 10.34s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5764443 :
INFO:model.model_wrapper:******train score at epoch 2: 0.14955 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4517417 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:15, 10.33s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4799007 :
INFO:model.model_wrapper:******train score at epoch 3: 0.38335 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3753677 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.25625 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.25625
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:05, 10.32s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3815113 :
INFO:model.model_wrapper:******train score at epoch 4: 0.59701 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3121262 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.63500 :
INFO:model.model_wrapper:validation score is improved from 0.25625 to 0.63500
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:56, 10.35s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3031216 :
INFO:model.model_wrapper:******train score at epoch 5: 0.73086 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2639507 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54531 :
 10%|█         | 5/50 [00:51<07:43, 10.30s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2265567 :
INFO:model.model_wrapper:******train score at epoch 6: 0.86524 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2767140 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.55342 :
 12%|█▏        | 6/50 [01:01<07:32, 10.28s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1830746 :
INFO:model.model_wrapper:******train score at epoch 7: 0.89671 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2648637 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52709 :
 14%|█▍        | 7/50 [01:12<07:22, 10.29s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1198483 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2657124 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.51106 :
 16%|█▌        | 8/50 [01:22<07:12, 10.30s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1022533 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96892 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2175487 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.58300 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0671135 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.1922718 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.61664 :
 20%|██        | 10/50 [01:42<06:51, 10.29s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0510871 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2398511 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.60492 :
 22%|██▏       | 11/50 [01:53<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0492010 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3444398 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53626 :
 24%|██▍       | 12/50 [02:03<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0360556 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4091841 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50087 :
 26%|██▌       | 13/50 [02:13<06:18, 10.22s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0264365 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4006270 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50753 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6578182 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5696733 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:25, 10.31s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5242205 :
INFO:model.model_wrapper:******train score at epoch 2: 0.44277 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4919407 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:13, 10.28s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4079292 :
INFO:model.model_wrapper:******train score at epoch 3: 0.72593 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4065692 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.49974 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.49974
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:04, 10.30s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.2932975 :
INFO:model.model_wrapper:******train score at epoch 4: 0.87259 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3544018 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.59346 :
INFO:model.model_wrapper:validation score is improved from 0.49974 to 0.59346
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:55, 10.34s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2123862 :
INFO:model.model_wrapper:******train score at epoch 5: 0.94465 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3539393 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.51903 :
 10%|█         | 5/50 [00:51<07:42, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1546050 :
INFO:model.model_wrapper:******train score at epoch 6: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3384503 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.56897 :
 12%|█▏        | 6/50 [01:01<07:31, 10.27s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1048811 :
INFO:model.model_wrapper:******train score at epoch 7: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3412236 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52874 :
 14%|█▍        | 7/50 [01:11<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0758089 :
INFO:model.model_wrapper:******train score at epoch 8: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3301129 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.56897 :
 16%|█▌        | 8/50 [01:22<07:10, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0537265 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3792196 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.52874 :
 18%|█▊        | 9/50 [01:32<07:00, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0511794 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4819244 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.46455 :
 20%|██        | 10/50 [01:42<06:51, 10.28s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0353596 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.6417333 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.44324 :
 22%|██▏       | 11/50 [01:53<06:40, 10.27s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0344584 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98127 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5177562 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.46455 :
 24%|██▍       | 12/50 [02:03<06:30, 10.28s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0250420 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3959738 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50753 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0225891 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3681290 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.49606 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6510048 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07559 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6490112 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:23, 10.28s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5318133 :
INFO:model.model_wrapper:******train score at epoch 2: 0.50911 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5450197 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.24s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4160006 :
INFO:model.model_wrapper:******train score at epoch 3: 0.71269 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4445185 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.54222 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.54222
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.28s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3095390 :
INFO:model.model_wrapper:******train score at epoch 4: 0.83066 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3709974 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.59346 :
INFO:model.model_wrapper:validation score is improved from 0.54222 to 0.59346
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:56, 10.36s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2290232 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88192 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3230640 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53555 :
 10%|█         | 5/50 [00:51<07:44, 10.33s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1667851 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93273 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3437830 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.47529 :
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1107612 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3367272 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.50344 :
 14%|█▍        | 7/50 [01:12<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0834489 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3198561 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.53555 :
 16%|█▌        | 8/50 [01:22<07:10, 10.25s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0625501 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3500058 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.48200 :
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0621923 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3239583 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.54431 :
 20%|██        | 10/50 [01:42<06:50, 10.25s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0378549 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3203025 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.56288 :
 22%|██▏       | 11/50 [01:53<06:40, 10.27s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0287745 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3509788 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53555 :
 24%|██▍       | 12/50 [02:03<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0297663 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3896596 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50344 :
 26%|██▌       | 13/50 [02:13<06:18, 10.23s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0262381 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3588366 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.51894 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 5 / 10 ****
INFO:runner.model.base_runner:****cv 5 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6675173 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5641382 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.22s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5565344 :
INFO:model.model_wrapper:******train score at epoch 2: 0.34777 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5086697 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.24s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4432665 :
INFO:model.model_wrapper:******train score at epoch 3: 0.58216 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4262058 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.39305 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.39305
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.27s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3487125 :
INFO:model.model_wrapper:******train score at epoch 4: 0.73065 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3430040 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.60688 :
INFO:model.model_wrapper:validation score is improved from 0.39305 to 0.60688
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.26s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2684539 :
INFO:model.model_wrapper:******train score at epoch 5: 0.84159 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2818195 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.61972 :
INFO:model.model_wrapper:validation score is improved from 0.60688 to 0.61972
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2013254 :
INFO:model.model_wrapper:******train score at epoch 6: 0.88515 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2261471 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.61972 :
 12%|█▏        | 6/50 [01:01<07:28, 10.19s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1472621 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.1965522 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.66355 :
INFO:model.model_wrapper:validation score is improved from 0.61972 to 0.66355
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:11<07:19, 10.21s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1041804 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2188852 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.66155 :
 16%|█▌        | 8/50 [01:21<07:07, 10.19s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0734126 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2491404 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.64007 :
 18%|█▊        | 9/50 [01:31<06:57, 10.18s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0552731 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2614684 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.61084 :
 20%|██        | 10/50 [01:41<06:45, 10.15s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0476297 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2780806 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.61084 :
 22%|██▏       | 11/50 [01:52<06:35, 10.13s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0396775 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2899883 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.61084 :
 24%|██▍       | 12/50 [02:02<06:25, 10.15s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0373115 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2818973 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.62022 :
 26%|██▌       | 13/50 [02:12<06:15, 10.16s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0321440 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2792885 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.62022 :
 28%|██▊       | 14/50 [02:22<06:05, 10.15s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0239128 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3195894 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.59260 :
 30%|███       | 15/50 [02:32<05:54, 10.14s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0207207 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3773047 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.58506 :
 32%|███▏      | 16/50 [02:42<05:45, 10.15s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0189185 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3361710 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.60037 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6549836 :
INFO:model.model_wrapper:******train score at epoch 1: 0.11251 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6337923 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:16, 10.13s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5266751 :
INFO:model.model_wrapper:******train score at epoch 2: 0.48891 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5953218 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:05, 10.12s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4012364 :
INFO:model.model_wrapper:******train score at epoch 3: 0.75399 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4912001 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.60888 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.60888
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:57, 10.15s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.2973905 :
INFO:model.model_wrapper:******train score at epoch 4: 0.79505 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3679036 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.58131 :
  8%|▊         | 4/50 [00:40<07:47, 10.16s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2208509 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87163 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3260360 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.67278 :
INFO:model.model_wrapper:validation score is improved from 0.60888 to 0.67278
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:50<07:39, 10.21s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1553426 :
INFO:model.model_wrapper:******train score at epoch 6: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2753329 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.66256 :
 12%|█▏        | 6/50 [01:01<07:28, 10.18s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1159748 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2659085 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.65271 :
 14%|█▍        | 7/50 [01:11<07:17, 10.18s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0812800 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2768236 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.64007 :
 16%|█▌        | 8/50 [01:21<07:07, 10.18s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0737159 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4598860 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.52027 :
 18%|█▊        | 9/50 [01:31<06:58, 10.20s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0487024 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4347144 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.52592 :
 20%|██        | 10/50 [01:41<06:48, 10.21s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0384401 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3982516 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52592 :
 22%|██▏       | 11/50 [01:52<06:37, 10.19s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0286264 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3742029 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.54630 :
 24%|██▍       | 12/50 [02:02<06:26, 10.16s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0265780 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3923203 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.54630 :
 26%|██▌       | 13/50 [02:12<06:16, 10.17s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0197853 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3749893 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.54630 :
 28%|██▊       | 14/50 [02:22<06:05, 10.16s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0224085 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3738312 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.55349 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6706727 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5888345 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5612182 :
INFO:model.model_wrapper:******train score at epoch 2: 0.30019 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5239949 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:10, 10.21s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4502999 :
INFO:model.model_wrapper:******train score at epoch 3: 0.60676 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4282511 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 3: 0.00000 :
  6%|▌         | 3/50 [00:30<07:59, 10.20s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3456783 :
INFO:model.model_wrapper:******train score at epoch 4: 0.76430 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3303306 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.60888 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.60888
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:49, 10.21s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2598597 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85261 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2742757 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.61972 :
INFO:model.model_wrapper:validation score is improved from 0.60888 to 0.61972
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1896516 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92180 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2584750 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.59675 :
 12%|█▏        | 6/50 [01:01<07:30, 10.23s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1476867 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3210606 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.61666 :
 14%|█▍        | 7/50 [01:11<07:19, 10.22s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1008867 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3282904 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.60838 :
 16%|█▌        | 8/50 [01:21<07:09, 10.22s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0852870 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3757266 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.57775 :
 18%|█▊        | 9/50 [01:31<06:59, 10.23s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0713366 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3722089 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.58506 :
 20%|██        | 10/50 [01:42<06:49, 10.25s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0467630 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3924209 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.57775 :
 22%|██▏       | 11/50 [01:52<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0417555 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4047710 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.57775 :
 24%|██▍       | 12/50 [02:02<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0297378 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3840020 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.59260 :
 26%|██▌       | 13/50 [02:13<06:19, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0268636 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3385001 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.59260 :
 28%|██▊       | 14/50 [02:23<06:08, 10.25s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0233988 :
INFO:model.model_wrapper:******train score at epoch 15: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3175954 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.63406 :
INFO:model.model_wrapper:validation score is improved from 0.61972 to 0.63406
INFO:model.model_wrapper:Checkpoint saved
 30%|███       | 15/50 [02:33<05:59, 10.28s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0235322 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3400157 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.60037 :
 32%|███▏      | 16/50 [02:43<05:48, 10.24s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0186083 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3552820 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.60037 :
 34%|███▍      | 17/50 [02:54<05:39, 10.27s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0182104 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3422267 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.60037 :
 36%|███▌      | 18/50 [03:04<05:28, 10.26s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0186241 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3718523 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.60037 :
 38%|███▊      | 19/50 [03:14<05:17, 10.24s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0136587 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3411250 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.61666 :
 40%|████      | 20/50 [03:24<05:07, 10.25s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0130583 :
INFO:model.model_wrapper:******train score at epoch 21: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3357162 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.60037 :
 42%|████▏     | 21/50 [03:35<04:57, 10.24s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0125604 :
INFO:model.model_wrapper:******train score at epoch 22: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.3801163 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.60037 :
 44%|████▍     | 22/50 [03:45<04:46, 10.24s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0121729 :
INFO:model.model_wrapper:******train score at epoch 23: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.4004803 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.58506 :
 46%|████▌     | 23/50 [03:55<04:36, 10.23s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.0108880 :
INFO:model.model_wrapper:******train score at epoch 24: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.4010176 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.59260 :
 48%|████▊     | 24/50 [04:05<04:26, 10.25s/it]INFO:model.model_wrapper:training 25  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 25: 0.0111259 :
INFO:model.model_wrapper:******train score at epoch 25: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 25: 0.3864748 :
INFO:model.model_wrapper:******valid score at epoch 25: 0.59260 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6705423 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6306117 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:23, 10.27s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5586458 :
INFO:model.model_wrapper:******train score at epoch 2: 0.30356 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5533848 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.24s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4589260 :
INFO:model.model_wrapper:******train score at epoch 3: 0.48531 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4313756 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.11502 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.11502
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.26s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3669143 :
INFO:model.model_wrapper:******train score at epoch 4: 0.66072 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3079869 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.49974 :
INFO:model.model_wrapper:validation score is improved from 0.11502 to 0.49974
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.28s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2773866 :
INFO:model.model_wrapper:******train score at epoch 5: 0.80908 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2349826 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.64902 :
INFO:model.model_wrapper:validation score is improved from 0.49974 to 0.64902
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:43, 10.30s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2197755 :
INFO:model.model_wrapper:******train score at epoch 6: 0.87077 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2120578 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.65116 :
INFO:model.model_wrapper:validation score is improved from 0.64902 to 0.65116
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:33, 10.31s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1603274 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92681 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.1956039 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.69445 :
INFO:model.model_wrapper:validation score is improved from 0.65116 to 0.69445
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:12<07:23, 10.31s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1156494 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.1889600 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.67278 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0855340 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.1769298 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.70596 :
INFO:model.model_wrapper:validation score is improved from 0.69445 to 0.70596
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:32<07:04, 10.34s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0729525 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.1797532 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.70596 :
 20%|██        | 10/50 [01:43<06:53, 10.33s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0660487 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.1584806 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.68492 :
 22%|██▏       | 11/50 [01:53<06:42, 10.32s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0414668 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2118578 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.69445 :
 24%|██▍       | 12/50 [02:03<06:31, 10.31s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0381702 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2146221 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.70596 :
 26%|██▌       | 13/50 [02:13<06:20, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0278976 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2445903 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.67278 :
 28%|██▊       | 14/50 [02:24<06:10, 10.29s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0216786 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2826879 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.65271 :
 30%|███       | 15/50 [02:34<06:00, 10.29s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0183933 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2820775 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.63406 :
 32%|███▏      | 16/50 [02:44<05:49, 10.28s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0139230 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3231235 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.60838 :
 34%|███▍      | 17/50 [02:54<05:39, 10.28s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0151504 :
INFO:model.model_wrapper:******train score at epoch 18: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.2706422 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.64322 :
 36%|███▌      | 18/50 [03:05<05:27, 10.25s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0109139 :
INFO:model.model_wrapper:******train score at epoch 19: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.2858544 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.64322 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6711928 :
INFO:model.model_wrapper:******train score at epoch 1: 0.12599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6849493 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.19s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5536719 :
INFO:model.model_wrapper:******train score at epoch 2: 0.47939 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6080967 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:08, 10.18s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4425258 :
INFO:model.model_wrapper:******train score at epoch 3: 0.73086 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5009741 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.44853 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.44853
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:59, 10.20s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3370300 :
INFO:model.model_wrapper:******train score at epoch 4: 0.78032 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3948045 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.55927 :
INFO:model.model_wrapper:validation score is improved from 0.44853 to 0.55927
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.26s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2635987 :
INFO:model.model_wrapper:******train score at epoch 5: 0.84708 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3371448 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.61664 :
INFO:model.model_wrapper:validation score is improved from 0.55927 to 0.61664
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:44, 10.32s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2053295 :
INFO:model.model_wrapper:******train score at epoch 6: 0.87370 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3325092 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.64322 :
INFO:model.model_wrapper:validation score is improved from 0.61664 to 0.64322
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:36, 10.38s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1331328 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3364590 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62522 :
 14%|█▍        | 7/50 [01:12<07:23, 10.31s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1000516 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2690717 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.65059 :
INFO:model.model_wrapper:validation score is improved from 0.64322 to 0.65059
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:22<07:13, 10.32s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0771666 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2525082 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.63932 :
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0614259 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2341681 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.69740 :
INFO:model.model_wrapper:validation score is improved from 0.65059 to 0.69740
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:43<06:52, 10.32s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0564342 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2514470 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.67298 :
 22%|██▏       | 11/50 [01:53<06:41, 10.31s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0335930 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2857652 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.61666 :
 24%|██▍       | 12/50 [02:03<06:31, 10.29s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0333308 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2688500 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.62522 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0230666 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2629242 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.63406 :
 28%|██▊       | 14/50 [02:23<06:07, 10.22s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0188308 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2745075 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.65271 :
 30%|███       | 15/50 [02:34<05:57, 10.21s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0182524 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2313752 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.64007 :
 32%|███▏      | 16/50 [02:44<05:47, 10.23s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0191497 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.2540207 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.66256 :
 34%|███▍      | 17/50 [02:54<05:38, 10.24s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0151283 :
INFO:model.model_wrapper:******train score at epoch 18: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.2734669 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.65059 :
 36%|███▌      | 18/50 [03:04<05:27, 10.25s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0143897 :
INFO:model.model_wrapper:******train score at epoch 19: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.2809851 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.64007 :
 38%|███▊      | 19/50 [03:15<05:18, 10.26s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0106378 :
INFO:model.model_wrapper:******train score at epoch 20: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.2472967 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.67298 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6727796 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07931 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6803955 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.23s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5621801 :
INFO:model.model_wrapper:******train score at epoch 2: 0.45056 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6696988 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.29538 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.29538
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:12, 10.26s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4545467 :
INFO:model.model_wrapper:******train score at epoch 3: 0.69714 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6211522 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.58547 :
INFO:model.model_wrapper:validation score is improved from 0.29538 to 0.58547
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:04, 10.31s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3483634 :
INFO:model.model_wrapper:******train score at epoch 4: 0.86372 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5479930 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.57274 :
  8%|▊         | 4/50 [00:41<07:52, 10.28s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2688044 :
INFO:model.model_wrapper:******train score at epoch 5: 0.92180 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4761404 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.60179 :
INFO:model.model_wrapper:validation score is improved from 0.58547 to 0.60179
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:44, 10.31s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2087414 :
INFO:model.model_wrapper:******train score at epoch 6: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4211944 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.60838 :
INFO:model.model_wrapper:validation score is improved from 0.60179 to 0.60838
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:34, 10.33s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1551601 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3989949 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.59260 :
 14%|█▍        | 7/50 [01:12<07:25, 10.35s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1120422 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3300975 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.64322 :
INFO:model.model_wrapper:validation score is improved from 0.60838 to 0.64322
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:22<07:15, 10.37s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0830161 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2816192 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.64322 :
 18%|█▊        | 9/50 [01:33<07:05, 10.39s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0688793 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2785408 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.63406 :
 20%|██        | 10/50 [01:43<06:53, 10.35s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0478164 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2941873 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.63406 :
 22%|██▏       | 11/50 [01:53<06:42, 10.32s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0526372 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2946452 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.64322 :
 24%|██▍       | 12/50 [02:04<06:32, 10.33s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0340950 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2608481 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.62996 :
 26%|██▌       | 13/50 [02:14<06:21, 10.31s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0330009 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2702906 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.60179 :
 28%|██▊       | 14/50 [02:24<06:09, 10.27s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0262073 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3534239 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.60037 :
 30%|███       | 15/50 [02:34<05:58, 10.25s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0213787 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3891830 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.58506 :
 32%|███▏      | 16/50 [02:44<05:48, 10.25s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0201956 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3918430 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.58506 :
 34%|███▍      | 17/50 [02:55<05:37, 10.23s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0177302 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3810076 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.58506 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6519762 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09728 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6003110 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.19s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5121447 :
INFO:model.model_wrapper:******train score at epoch 2: 0.34479 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4826081 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:10, 10.22s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4122747 :
INFO:model.model_wrapper:******train score at epoch 3: 0.48934 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3376658 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.18560 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.18560
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.29s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3201346 :
INFO:model.model_wrapper:******train score at epoch 4: 0.68054 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.2243194 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.60888 :
INFO:model.model_wrapper:validation score is improved from 0.18560 to 0.60888
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.32s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2423203 :
INFO:model.model_wrapper:******train score at epoch 5: 0.79098 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.1816575 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.62807 :
INFO:model.model_wrapper:validation score is improved from 0.60888 to 0.62807
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:44, 10.31s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1892008 :
INFO:model.model_wrapper:******train score at epoch 6: 0.85815 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.1898614 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.64184 :
INFO:model.model_wrapper:validation score is improved from 0.62807 to 0.64184
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:34, 10.32s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1563799 :
INFO:model.model_wrapper:******train score at epoch 7: 0.87370 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2235826 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62799 :
 14%|█▍        | 7/50 [01:12<07:23, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1005056 :
INFO:model.model_wrapper:******train score at epoch 8: 0.93867 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2226602 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.62996 :
 16%|█▌        | 8/50 [01:22<07:12, 10.31s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0712655 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2445355 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.61084 :
 18%|█▊        | 9/50 [01:32<07:02, 10.29s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0561326 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2786570 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.60838 :
 20%|██        | 10/50 [01:43<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0426903 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3052482 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.59260 :
 22%|██▏       | 11/50 [01:53<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0310196 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2949097 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.60037 :
 24%|██▍       | 12/50 [02:03<06:29, 10.24s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0283080 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2679142 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.60179 :
 26%|██▌       | 13/50 [02:13<06:18, 10.22s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0233809 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2680374 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.57788 :
 28%|██▊       | 14/50 [02:23<06:07, 10.20s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0197764 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2472797 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.59675 :
 30%|███       | 15/50 [02:34<05:57, 10.22s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0178305 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2903463 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.58462 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6660268 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5964833 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.20s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5455195 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32752 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5384426 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:08, 10.19s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4458021 :
INFO:model.model_wrapper:******train score at epoch 3: 0.60142 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4600545 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.30580 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.30580
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:00, 10.22s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3516825 :
INFO:model.model_wrapper:******train score at epoch 4: 0.73587 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3875132 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.62807 :
INFO:model.model_wrapper:validation score is improved from 0.30580 to 0.62807
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.26s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2695794 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87077 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3305825 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.62799 :
 10%|█         | 5/50 [00:51<07:41, 10.25s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2054978 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3097254 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.62022 :
 12%|█▏        | 6/50 [01:01<07:29, 10.22s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1604010 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3038253 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62022 :
 14%|█▍        | 7/50 [01:11<07:18, 10.21s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1169004 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3540789 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.56856 :
 16%|█▌        | 8/50 [01:21<07:08, 10.19s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0834366 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3543582 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.56856 :
 18%|█▊        | 9/50 [01:31<06:58, 10.21s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0668488 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3283811 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.60179 :
 20%|██        | 10/50 [01:42<06:47, 10.20s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0512864 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3255162 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.58462 :
 22%|██▏       | 11/50 [01:52<06:37, 10.20s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0410828 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3197842 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.57646 :
 24%|██▍       | 12/50 [02:02<06:28, 10.21s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0372007 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3684338 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.57646 :
 26%|██▌       | 13/50 [02:12<06:17, 10.21s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0275929 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4257714 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.57775 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6748167 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5209081 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:18, 10.18s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5678044 :
INFO:model.model_wrapper:******train score at epoch 2: 0.07931 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4674761 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:08, 10.18s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4762384 :
INFO:model.model_wrapper:******train score at epoch 3: 0.33909 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4013657 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 3: 0.00000 :
  6%|▌         | 3/50 [00:30<07:57, 10.17s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3794790 :
INFO:model.model_wrapper:******train score at epoch 4: 0.61164 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3186129 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.64469 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.64469
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:47, 10.17s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2808445 :
INFO:model.model_wrapper:******train score at epoch 5: 0.81983 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2813197 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.64184 :
 10%|█         | 5/50 [00:50<07:38, 10.18s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2093069 :
INFO:model.model_wrapper:******train score at epoch 6: 0.88515 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2742303 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.63406 :
 12%|█▏        | 6/50 [01:01<07:27, 10.16s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1462103 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2711914 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.60838 :
 14%|█▍        | 7/50 [01:11<07:18, 10.20s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1043865 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2715272 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.61666 :
 16%|█▌        | 8/50 [01:21<07:09, 10.22s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0922848 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3016366 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.57064 :
 18%|█▊        | 9/50 [01:31<07:00, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0601391 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3440366 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.57064 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0572551 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2493005 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.64007 :
 22%|██▏       | 11/50 [01:52<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0523774 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2499114 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.65059 :
INFO:model.model_wrapper:validation score is improved from 0.64469 to 0.65059
INFO:model.model_wrapper:Checkpoint saved
 24%|██▍       | 12/50 [02:02<06:32, 10.33s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0327732 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3362609 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.60037 :
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0342355 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98127 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4001524 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.54413 :
 28%|██▊       | 14/50 [02:23<06:09, 10.27s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0249617 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2794411 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.61084 :
 30%|███       | 15/50 [02:33<05:58, 10.24s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0358998 :
INFO:model.model_wrapper:******train score at epoch 16: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2717106 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.60674 :
 32%|███▏      | 16/50 [02:43<05:46, 10.20s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0209549 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4145452 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.53931 :
 34%|███▍      | 17/50 [02:53<05:36, 10.20s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0324019 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98127 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4372841 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.52592 :
 36%|███▌      | 18/50 [03:03<05:25, 10.18s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0149239 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3271781 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.57788 :
 38%|███▊      | 19/50 [03:14<05:15, 10.18s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0185993 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.2919489 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.57274 :
 40%|████      | 20/50 [03:24<05:05, 10.18s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0473687 :
INFO:model.model_wrapper:******train score at epoch 21: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3805421 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.55349 :
 42%|████▏     | 21/50 [03:34<04:55, 10.18s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0181345 :
INFO:model.model_wrapper:******train score at epoch 22: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.4374307 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.55703 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 291
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6591466 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07559 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6861862 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:22, 10.26s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5525473 :
INFO:model.model_wrapper:******train score at epoch 2: 0.49925 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6400338 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.22869 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.22869
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:12, 10.26s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4440825 :
INFO:model.model_wrapper:******train score at epoch 3: 0.76009 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5834537 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.54222 :
INFO:model.model_wrapper:validation score is improved from 0.22869 to 0.54222
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.25s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3459552 :
INFO:model.model_wrapper:******train score at epoch 4: 0.90453 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5111324 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.65542 :
INFO:model.model_wrapper:validation score is improved from 0.54222 to 0.65542
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.28s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2700982 :
INFO:model.model_wrapper:******train score at epoch 5: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4653787 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.64322 :
 10%|█         | 5/50 [00:51<07:40, 10.23s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2013900 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4092614 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.60037 :
 12%|█▏        | 6/50 [01:01<07:29, 10.22s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1568000 :
INFO:model.model_wrapper:******train score at epoch 7: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3774351 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.60838 :
 14%|█▍        | 7/50 [01:11<07:19, 10.23s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1090949 :
INFO:model.model_wrapper:******train score at epoch 8: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3089830 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.67278 :
INFO:model.model_wrapper:validation score is improved from 0.65542 to 0.67278
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0935267 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3417587 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.68340 :
INFO:model.model_wrapper:validation score is improved from 0.67278 to 0.68340
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0694538 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3721768 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.63406 :
 20%|██        | 10/50 [01:42<06:50, 10.25s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0563615 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4180160 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.55703 :
 22%|██▏       | 11/50 [01:52<06:39, 10.23s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0631990 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4497144 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.55049 :
 24%|██▍       | 12/50 [02:02<06:27, 10.20s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0347178 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.6742756 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.43971 :
 26%|██▌       | 13/50 [02:12<06:16, 10.18s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0352318 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.6116896 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.43971 :
 28%|██▊       | 14/50 [02:23<06:06, 10.17s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0255997 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2838253 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.59675 :
 30%|███       | 15/50 [02:33<05:56, 10.19s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0216476 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2669310 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.59372 :
 32%|███▏      | 16/50 [02:43<05:47, 10.21s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0243004 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3302354 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.60179 :
 34%|███▍      | 17/50 [02:53<05:37, 10.22s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0206081 :
INFO:model.model_wrapper:******train score at epoch 18: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3731591 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.59306 :
 36%|███▌      | 18/50 [03:04<05:26, 10.21s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0174385 :
INFO:model.model_wrapper:******train score at epoch 19: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3216231 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.58462 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 6 / 10 ****
INFO:runner.model.base_runner:****cv 6 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6665650 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6428866 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.20s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5695855 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32752 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5753182 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:09, 10.19s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4679657 :
INFO:model.model_wrapper:******train score at epoch 3: 0.64102 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4989309 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.40509 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.40509
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.23s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3776948 :
INFO:model.model_wrapper:******train score at epoch 4: 0.78783 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4447297 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.56960 :
INFO:model.model_wrapper:validation score is improved from 0.40509 to 0.56960
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:51, 10.26s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2886042 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87633 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4322716 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.58701 :
INFO:model.model_wrapper:validation score is improved from 0.56960 to 0.58701
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:40, 10.24s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2188929 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4076936 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.58450 :
 12%|█▏        | 6/50 [01:01<07:29, 10.22s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1678109 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3850280 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55192 :
 14%|█▍        | 7/50 [01:11<07:19, 10.21s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1254792 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3957528 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.56843 :
 16%|█▌        | 8/50 [01:21<07:09, 10.23s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0950190 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4311708 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.56077 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0693634 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3827509 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.58450 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0530411 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3403708 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.60167 :
INFO:model.model_wrapper:validation score is improved from 0.58701 to 0.60167
INFO:model.model_wrapper:Checkpoint saved
 22%|██▏       | 11/50 [01:52<06:41, 10.29s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0414970 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3579435 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.61072 :
INFO:model.model_wrapper:validation score is improved from 0.60167 to 0.61072
INFO:model.model_wrapper:Checkpoint saved
 24%|██▍       | 12/50 [02:03<06:31, 10.30s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0359111 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4150046 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.59294 :
 26%|██▌       | 13/50 [02:13<06:20, 10.28s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0306908 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3416034 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.56023 :
 28%|██▊       | 14/50 [02:23<06:09, 10.25s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0213064 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3645436 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.56023 :
 30%|███       | 15/50 [02:33<05:58, 10.24s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0204540 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4249180 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.58450 :
 32%|███▏      | 16/50 [02:44<05:48, 10.24s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0162328 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4470037 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.53916 :
 34%|███▍      | 17/50 [02:54<05:38, 10.26s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0227378 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98127 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4200640 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.56077 :
 36%|███▌      | 18/50 [03:04<05:28, 10.27s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0208692 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3395175 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.61072 :
 38%|███▊      | 19/50 [03:14<05:19, 10.30s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0189029 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3848148 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.58450 :
 40%|████      | 20/50 [03:25<05:08, 10.28s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0138573 :
INFO:model.model_wrapper:******train score at epoch 21: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.4804740 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.53916 :
 42%|████▏     | 21/50 [03:35<04:57, 10.25s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0192132 :
INFO:model.model_wrapper:******train score at epoch 22: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.4566011 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.54615 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6638683 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5683852 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:23, 10.27s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5548718 :
INFO:model.model_wrapper:******train score at epoch 2: 0.18868 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4751033 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:13, 10.28s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4480200 :
INFO:model.model_wrapper:******train score at epoch 3: 0.45859 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3888303 :
INFO:model.model_wrapper:******valid score at epoch 3: -0.01513 :
  6%|▌         | 3/50 [00:30<08:01, 10.25s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3559544 :
INFO:model.model_wrapper:******train score at epoch 4: 0.72577 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3203046 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.59237 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.59237
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.27s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2623021 :
INFO:model.model_wrapper:******train score at epoch 5: 0.83611 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2743678 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.69013 :
INFO:model.model_wrapper:validation score is improved from 0.59237 to 0.69013
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:42, 10.28s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2103079 :
INFO:model.model_wrapper:******train score at epoch 6: 0.89884 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2582259 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.66346 :
 12%|█▏        | 6/50 [01:01<07:31, 10.26s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1543306 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2697867 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62789 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1078214 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2722245 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.63997 :
 16%|█▌        | 8/50 [01:21<07:09, 10.23s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0741148 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2893736 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.63997 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0642909 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3450450 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.60167 :
 20%|██        | 10/50 [01:42<06:49, 10.24s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0464825 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3012981 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.63997 :
 22%|██▏       | 11/50 [01:52<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0423836 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3521176 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.59294 :
 24%|██▍       | 12/50 [02:03<06:28, 10.24s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0362406 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2536913 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.66146 :
 26%|██▌       | 13/50 [02:13<06:19, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0283944 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2538952 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.67289 :
 28%|██▊       | 14/50 [02:23<06:09, 10.26s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0278793 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2622573 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.66146 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6595776 :
INFO:model.model_wrapper:******train score at epoch 1: 0.13823 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6494345 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5343167 :
INFO:model.model_wrapper:******train score at epoch 2: 0.51946 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5715858 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.25s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4354860 :
INFO:model.model_wrapper:******train score at epoch 3: 0.74878 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5192549 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.54743 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.54743
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.27s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3418281 :
INFO:model.model_wrapper:******train score at epoch 4: 0.85111 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4483337 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.61962 :
INFO:model.model_wrapper:validation score is improved from 0.54743 to 0.61962
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.28s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2649206 :
INFO:model.model_wrapper:******train score at epoch 5: 0.91508 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4053904 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.66346 :
INFO:model.model_wrapper:validation score is improved from 0.61962 to 0.66346
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:42, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2120187 :
INFO:model.model_wrapper:******train score at epoch 6: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3564939 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.61703 :
 12%|█▏        | 6/50 [01:01<07:32, 10.28s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1598939 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3538129 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56883 :
 14%|█▍        | 7/50 [01:11<07:21, 10.26s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1096409 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3119054 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.60662 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0977357 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2979497 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.60662 :
 18%|█▊        | 9/50 [01:32<07:00, 10.26s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0811034 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2911510 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.65106 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0607375 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2882477 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.63922 :
 22%|██▏       | 11/50 [01:52<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0397628 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3421982 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.61072 :
 24%|██▍       | 12/50 [02:03<06:30, 10.28s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0404326 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4032478 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.57633 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0295919 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4198433 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.56077 :
 28%|██▊       | 14/50 [02:23<06:09, 10.26s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0269127 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3761099 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.56843 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6687138 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5540782 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.19s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5733166 :
INFO:model.model_wrapper:******train score at epoch 2: 0.17961 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4883015 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:08, 10.17s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4797013 :
INFO:model.model_wrapper:******train score at epoch 3: 0.31250 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3903934 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.25619 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.25619
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:58, 10.17s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3864133 :
INFO:model.model_wrapper:******train score at epoch 4: 0.50418 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3002940 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.44845 :
INFO:model.model_wrapper:validation score is improved from 0.25619 to 0.44845
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:49, 10.20s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3026644 :
INFO:model.model_wrapper:******train score at epoch 5: 0.71375 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2544306 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.68478 :
INFO:model.model_wrapper:validation score is improved from 0.44845 to 0.68478
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:42, 10.27s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2283788 :
INFO:model.model_wrapper:******train score at epoch 6: 0.83254 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2319238 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.67647 :
 12%|█▏        | 6/50 [01:01<07:31, 10.25s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1844936 :
INFO:model.model_wrapper:******train score at epoch 7: 0.88627 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2509459 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.60167 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1249874 :
INFO:model.model_wrapper:******train score at epoch 8: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3028592 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.52577 :
 16%|█▌        | 8/50 [01:21<07:09, 10.23s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0908304 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2949227 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53237 :
 18%|█▊        | 9/50 [01:31<06:58, 10.21s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0723862 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3710992 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.49529 :
 20%|██        | 10/50 [01:42<06:48, 10.22s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0557568 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3337861 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.53916 :
 22%|██▏       | 11/50 [01:52<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0396061 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3688879 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53237 :
 24%|██▍       | 12/50 [02:02<06:31, 10.30s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0361580 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3836517 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51935 :
 26%|██▌       | 13/50 [02:13<06:21, 10.31s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0287181 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3422393 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.53916 :
 28%|██▊       | 14/50 [02:23<06:10, 10.29s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0269743 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3691051 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.53916 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6717509 :
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6518602 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5610728 :
INFO:model.model_wrapper:******train score at epoch 2: 0.33333 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5556636 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.23s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4438234 :
INFO:model.model_wrapper:******train score at epoch 3: 0.61653 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4213112 :
INFO:model.model_wrapper:******valid score at epoch 3: -0.01513 :
  6%|▌         | 3/50 [00:30<08:01, 10.24s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3588137 :
INFO:model.model_wrapper:******train score at epoch 4: 0.74636 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.2887963 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.47261 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.47261
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:51, 10.26s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2652121 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85815 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2272881 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.61962 :
INFO:model.model_wrapper:validation score is improved from 0.47261 to 0.61962
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:43, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1995133 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91508 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2051456 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.66346 :
INFO:model.model_wrapper:validation score is improved from 0.61962 to 0.66346
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1337072 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.1975722 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.65106 :
 14%|█▍        | 7/50 [01:11<07:22, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1067496 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2194328 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.65106 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0734921 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2368519 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.67289 :
INFO:model.model_wrapper:validation score is improved from 0.66346 to 0.67289
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:32<07:02, 10.32s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0518066 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2842136 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.66146 :
 20%|██        | 10/50 [01:42<06:51, 10.28s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0476718 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2996642 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.61072 :
 22%|██▏       | 11/50 [01:53<06:40, 10.28s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0364427 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3033314 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.65049 :
 24%|██▍       | 12/50 [02:03<06:30, 10.28s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0321064 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3192895 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.62511 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0277334 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3548206 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.60827 :
 28%|██▊       | 14/50 [02:23<06:09, 10.27s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0247657 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3545878 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.60025 :
 30%|███       | 15/50 [02:34<05:59, 10.26s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0194293 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3480696 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.61655 :
 32%|███▏      | 16/50 [02:44<05:49, 10.28s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0204747 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3268001 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.61072 :
 34%|███▍      | 17/50 [02:54<05:38, 10.24s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0182758 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3464788 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.63396 :
 36%|███▌      | 18/50 [03:04<05:27, 10.23s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0169925 :
INFO:model.model_wrapper:******train score at epoch 19: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3643748 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.61655 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6556637 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6246042 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.20s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5453546 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32163 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5647214 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:10, 10.22s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4372218 :
INFO:model.model_wrapper:******train score at epoch 3: 0.65465 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4752652 :
INFO:model.model_wrapper:******valid score at epoch 3: -0.02630 :
  6%|▌         | 3/50 [00:30<07:59, 10.20s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3449012 :
INFO:model.model_wrapper:******train score at epoch 4: 0.81254 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3800408 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.59706 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.59706
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:49, 10.22s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2426728 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89197 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3541602 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.56883 :
 10%|█         | 5/50 [00:51<07:39, 10.20s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1761650 :
INFO:model.model_wrapper:******train score at epoch 6: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3231634 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.55192 :
 12%|█▏        | 6/50 [01:01<07:29, 10.23s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1438907 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2946168 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56023 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0989828 :
INFO:model.model_wrapper:******train score at epoch 8: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3382609 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.59294 :
 16%|█▌        | 8/50 [01:21<07:08, 10.21s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0740399 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3260861 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.59294 :
 18%|█▊        | 9/50 [01:31<06:58, 10.21s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0557603 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3207066 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.57633 :
 20%|██        | 10/50 [01:42<06:49, 10.25s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0698381 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2825186 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.56883 :
 22%|██▏       | 11/50 [01:52<06:38, 10.23s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0428772 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3629620 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.58450 :
 24%|██▍       | 12/50 [02:02<06:27, 10.21s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0332307 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3419373 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.56843 :
 26%|██▌       | 13/50 [02:12<06:18, 10.23s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0305462 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3430431 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.56077 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6630941 :
INFO:model.model_wrapper:******train score at epoch 1: 0.14955 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7153081 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:25, 10.32s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5399778 :
INFO:model.model_wrapper:******train score at epoch 2: 0.56779 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6432442 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.15125 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.15125
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:16, 10.35s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4245883 :
INFO:model.model_wrapper:******train score at epoch 3: 0.77502 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5739066 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.44145 :
INFO:model.model_wrapper:validation score is improved from 0.15125 to 0.44145
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:05, 10.33s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3241690 :
INFO:model.model_wrapper:******train score at epoch 4: 0.87370 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4995214 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.61072 :
INFO:model.model_wrapper:validation score is improved from 0.44145 to 0.61072
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:55, 10.33s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2502280 :
INFO:model.model_wrapper:******train score at epoch 5: 0.91508 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4164281 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.58701 :
 10%|█         | 5/50 [00:51<07:44, 10.33s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1883814 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93346 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4030614 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.56077 :
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1464451 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94465 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3584953 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56077 :
 14%|█▍        | 7/50 [01:12<07:22, 10.29s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0915277 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3169095 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.57775 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0795896 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3472699 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.55192 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0575357 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3713950 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.53612 :
 20%|██        | 10/50 [01:43<06:52, 10.30s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0480244 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4079900 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52130 :
 22%|██▏       | 11/50 [01:53<06:40, 10.27s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0370992 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4089213 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.56843 :
 24%|██▍       | 12/50 [02:03<06:30, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0296294 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4163330 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.53916 :
 26%|██▌       | 13/50 [02:13<06:18, 10.24s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0258329 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4117397 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.53916 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6632185 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5684672 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:17, 10.16s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5394953 :
INFO:model.model_wrapper:******train score at epoch 2: 0.38335 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5090255 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:08, 10.17s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4293247 :
INFO:model.model_wrapper:******train score at epoch 3: 0.67420 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4456427 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.21465 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.21465
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:00, 10.22s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3298794 :
INFO:model.model_wrapper:******train score at epoch 4: 0.82717 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3936895 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.55696 :
INFO:model.model_wrapper:validation score is improved from 0.21465 to 0.55696
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.29s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2573157 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89884 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3505805 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.57261 :
INFO:model.model_wrapper:validation score is improved from 0.55696 to 0.57261
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:44, 10.32s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2002539 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92180 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3200297 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.60662 :
INFO:model.model_wrapper:validation score is improved from 0.57261 to 0.60662
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:34, 10.32s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1371573 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2910838 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62789 :
INFO:model.model_wrapper:validation score is improved from 0.60662 to 0.62789
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:12<07:24, 10.34s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1099063 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2699478 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.61703 :
 16%|█▌        | 8/50 [01:22<07:12, 10.30s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0746778 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3004150 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.62985 :
INFO:model.model_wrapper:validation score is improved from 0.62789 to 0.62985
INFO:model.model_wrapper:Checkpoint saved
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0535286 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2520355 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.61703 :
 20%|██        | 10/50 [01:43<06:51, 10.30s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0438284 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2502453 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.62789 :
 22%|██▏       | 11/50 [01:53<06:41, 10.30s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0318376 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2729941 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.59663 :
 24%|██▍       | 12/50 [02:03<06:30, 10.27s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0292499 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2706436 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.60662 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0248578 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3149972 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.61072 :
 28%|██▊       | 14/50 [02:23<06:08, 10.23s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0238744 :
INFO:model.model_wrapper:******train score at epoch 15: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2798466 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.62011 :
 30%|███       | 15/50 [02:34<05:58, 10.24s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0189197 :
INFO:model.model_wrapper:******train score at epoch 16: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2983183 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.62985 :
 32%|███▏      | 16/50 [02:44<05:49, 10.27s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0138603 :
INFO:model.model_wrapper:******train score at epoch 17: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3303946 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.60167 :
 34%|███▍      | 17/50 [02:54<05:38, 10.24s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0152925 :
INFO:model.model_wrapper:******train score at epoch 18: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3571445 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.60167 :
 36%|███▌      | 18/50 [03:04<05:27, 10.23s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0175750 :
INFO:model.model_wrapper:******train score at epoch 19: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3062349 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.59663 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6473038 :
INFO:model.model_wrapper:******train score at epoch 1: 0.18868 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6700036 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:25, 10.32s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5252799 :
INFO:model.model_wrapper:******train score at epoch 2: 0.60267 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6204057 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.21465 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.21465
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:15, 10.32s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4314636 :
INFO:model.model_wrapper:******train score at epoch 3: 0.79441 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5674049 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.52069 :
INFO:model.model_wrapper:validation score is improved from 0.21465 to 0.52069
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:31<08:06, 10.36s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3573953 :
INFO:model.model_wrapper:******train score at epoch 4: 0.89092 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5066130 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.64174 :
INFO:model.model_wrapper:validation score is improved from 0.52069 to 0.64174
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:57, 10.37s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2750609 :
INFO:model.model_wrapper:******train score at epoch 5: 0.91963 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4467310 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.62883 :
 10%|█         | 5/50 [00:51<07:45, 10.35s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2472297 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92529 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3643926 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.62883 :
 12%|█▏        | 6/50 [01:01<07:33, 10.30s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1716390 :
INFO:model.model_wrapper:******train score at epoch 7: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3266238 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.60481 :
 14%|█▍        | 7/50 [01:12<07:21, 10.27s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1343881 :
INFO:model.model_wrapper:******train score at epoch 8: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2950984 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.61703 :
 16%|█▌        | 8/50 [01:22<07:12, 10.29s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1057021 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2832758 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.61703 :
 18%|█▊        | 9/50 [01:32<07:02, 10.30s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0754460 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2602940 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.61703 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0691311 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2403045 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.63922 :
 22%|██▏       | 11/50 [01:53<06:39, 10.24s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0482126 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2320359 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.65106 :
INFO:model.model_wrapper:validation score is improved from 0.64174 to 0.65106
INFO:model.model_wrapper:Checkpoint saved
 24%|██▍       | 12/50 [02:03<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0391172 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2227065 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.65106 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0320391 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2503984 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.62789 :
 28%|██▊       | 14/50 [02:23<06:08, 10.24s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0278689 :
INFO:model.model_wrapper:******train score at epoch 15: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2918606 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.62011 :
 30%|███       | 15/50 [02:34<05:58, 10.23s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0235609 :
INFO:model.model_wrapper:******train score at epoch 16: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3142902 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.59294 :
 32%|███▏      | 16/50 [02:44<05:47, 10.23s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0214014 :
INFO:model.model_wrapper:******train score at epoch 17: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.2865713 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.59294 :
 34%|███▍      | 17/50 [02:54<05:37, 10.22s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0185003 :
INFO:model.model_wrapper:******train score at epoch 18: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.2820629 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.59294 :
 36%|███▌      | 18/50 [03:04<05:26, 10.21s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0182021 :
INFO:model.model_wrapper:******train score at epoch 19: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.2586244 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.60662 :
 38%|███▊      | 19/50 [03:15<05:17, 10.23s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0164307 :
INFO:model.model_wrapper:******train score at epoch 20: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.2397196 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.62789 :
 40%|████      | 20/50 [03:25<05:06, 10.23s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0150228 :
INFO:model.model_wrapper:******train score at epoch 21: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.2660075 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.61703 :
 42%|████▏     | 21/50 [03:35<04:56, 10.22s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0129196 :
INFO:model.model_wrapper:******train score at epoch 22: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.2982774 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.61072 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6672642 :
INFO:model.model_wrapper:******train score at epoch 1: 0.12599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6975246 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:22, 10.26s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5529145 :
INFO:model.model_wrapper:******train score at epoch 2: 0.46341 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6003937 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.15125 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.15125
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:12, 10.27s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4440775 :
INFO:model.model_wrapper:******train score at epoch 3: 0.73065 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4910747 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.36603 :
INFO:model.model_wrapper:validation score is improved from 0.15125 to 0.36603
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.28s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3448248 :
INFO:model.model_wrapper:******train score at epoch 4: 0.82029 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4023827 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.56960 :
INFO:model.model_wrapper:validation score is improved from 0.36603 to 0.56960
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.27s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2656907 :
INFO:model.model_wrapper:******train score at epoch 5: 0.83444 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3250604 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.60481 :
INFO:model.model_wrapper:validation score is improved from 0.56960 to 0.60481
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:43, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1774876 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2986525 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.59663 :
 12%|█▏        | 6/50 [01:01<07:32, 10.28s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1358417 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3048347 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.60662 :
INFO:model.model_wrapper:validation score is improved from 0.60481 to 0.60662
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:12<07:22, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0870184 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3263443 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.60662 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0612042 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3180651 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.59663 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0475753 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3465024 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.59663 :
 20%|██        | 10/50 [01:42<06:50, 10.26s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0358060 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3337043 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.59663 :
 22%|██▏       | 11/50 [01:52<06:39, 10.24s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0266295 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3804767 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.59663 :
 24%|██▍       | 12/50 [02:03<06:28, 10.22s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0244910 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3337962 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.57261 :
 26%|██▌       | 13/50 [02:13<06:18, 10.22s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0436191 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2669899 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.60481 :
 28%|██▊       | 14/50 [02:23<06:07, 10.21s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0197015 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2407194 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.64174 :
INFO:model.model_wrapper:validation score is improved from 0.60662 to 0.64174
INFO:model.model_wrapper:Checkpoint saved
 30%|███       | 15/50 [02:33<05:58, 10.25s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0153814 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2995613 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.62883 :
 32%|███▏      | 16/50 [02:44<05:47, 10.23s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0150006 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3337176 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.59360 :
 34%|███▍      | 17/50 [02:54<05:38, 10.26s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0141946 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4100135 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.51090 :
 36%|███▌      | 18/50 [03:04<05:27, 10.25s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0152697 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.4179155 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.52859 :
 38%|███▊      | 19/50 [03:14<05:17, 10.25s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0113204 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.5163583 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.51423 :
 40%|████      | 20/50 [03:24<05:06, 10.22s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0124378 :
INFO:model.model_wrapper:******train score at epoch 21: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.4766685 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.52130 :
 42%|████▏     | 21/50 [03:35<04:57, 10.25s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0124887 :
INFO:model.model_wrapper:******train score at epoch 22: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.4247556 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.52859 :
 44%|████▍     | 22/50 [03:45<04:47, 10.25s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0089495 :
INFO:model.model_wrapper:******train score at epoch 23: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.4204383 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.53612 :
 46%|████▌     | 23/50 [03:55<04:36, 10.26s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.0105645 :
INFO:model.model_wrapper:******train score at epoch 24: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.4370117 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.53612 :
 48%|████▊     | 24/50 [04:06<04:26, 10.23s/it]INFO:model.model_wrapper:training 25  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 25: 0.0112543 :
INFO:model.model_wrapper:******train score at epoch 25: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 25: 0.4479044 :
INFO:model.model_wrapper:******valid score at epoch 25: 0.53612 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 7 / 10 ****
INFO:runner.model.base_runner:****cv 7 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6780803 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05599 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7015720 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.20s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5548100 :
INFO:model.model_wrapper:******train score at epoch 2: 0.52377 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6452250 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.32394 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.32394
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:10, 10.22s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4490165 :
INFO:model.model_wrapper:******train score at epoch 3: 0.76974 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6057627 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.52003 :
INFO:model.model_wrapper:validation score is improved from 0.32394 to 0.52003
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.25s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3725532 :
INFO:model.model_wrapper:******train score at epoch 4: 0.89092 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5682671 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.45010 :
  8%|▊         | 4/50 [00:40<07:50, 10.22s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3270118 :
INFO:model.model_wrapper:******train score at epoch 5: 0.86494 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5611216 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54399 :
INFO:model.model_wrapper:validation score is improved from 0.52003 to 0.54399
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:42, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2336011 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.5185250 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.56360 :
INFO:model.model_wrapper:validation score is improved from 0.54399 to 0.56360
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:34, 10.33s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1988330 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93934 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4947727 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56360 :
 14%|█▍        | 7/50 [01:12<07:23, 10.32s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1528061 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4381535 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.55335 :
 16%|█▌        | 8/50 [01:22<07:12, 10.30s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1203044 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4068307 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.55335 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0953076 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95067 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4232849 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.56843 :
INFO:model.model_wrapper:validation score is improved from 0.56360 to 0.56843
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:42<06:51, 10.29s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0686231 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3480192 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.58450 :
INFO:model.model_wrapper:validation score is improved from 0.56843 to 0.58450
INFO:model.model_wrapper:Checkpoint saved
 22%|██▏       | 11/50 [01:53<06:41, 10.29s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0603536 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3899870 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.56077 :
 24%|██▍       | 12/50 [02:03<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0418288 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5314717 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.54399 :
 26%|██▌       | 13/50 [02:13<06:19, 10.27s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0355394 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.6056536 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.51450 :
 28%|██▊       | 14/50 [02:23<06:10, 10.28s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0327969 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4903282 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.57051 :
 30%|███       | 15/50 [02:34<05:59, 10.26s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0256273 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4437937 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.58493 :
INFO:model.model_wrapper:validation score is improved from 0.58450 to 0.58493
INFO:model.model_wrapper:Checkpoint saved
 32%|███▏      | 16/50 [02:44<05:49, 10.28s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0246959 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4225690 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.61655 :
INFO:model.model_wrapper:validation score is improved from 0.58493 to 0.61655
INFO:model.model_wrapper:Checkpoint saved
 34%|███▍      | 17/50 [02:54<05:39, 10.29s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0216723 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4016542 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.60827 :
 36%|███▌      | 18/50 [03:05<05:28, 10.28s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0224091 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.4194659 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.60827 :
 38%|███▊      | 19/50 [03:15<05:18, 10.27s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0204015 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.4238549 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.61655 :
 40%|████      | 20/50 [03:25<05:08, 10.29s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0156777 :
INFO:model.model_wrapper:******train score at epoch 21: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3982845 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.61655 :
 42%|████▏     | 21/50 [03:35<04:57, 10.26s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0151087 :
INFO:model.model_wrapper:******train score at epoch 22: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.3932402 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.61655 :
 44%|████▍     | 22/50 [03:46<04:47, 10.26s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0123051 :
INFO:model.model_wrapper:******train score at epoch 23: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.4092758 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.60025 :
 46%|████▌     | 23/50 [03:56<04:37, 10.27s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.0128713 :
INFO:model.model_wrapper:******train score at epoch 24: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.4408710 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.57051 :
 48%|████▊     | 24/50 [04:06<04:26, 10.23s/it]INFO:model.model_wrapper:training 25  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 25: 0.0112474 :
INFO:model.model_wrapper:******train score at epoch 25: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 25: 0.4208682 :
INFO:model.model_wrapper:******valid score at epoch 25: 0.56843 :
 50%|█████     | 25/50 [04:16<04:15, 10.21s/it]INFO:model.model_wrapper:training 26  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 26: 0.0125656 :
INFO:model.model_wrapper:******train score at epoch 26: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 26: 0.4410172 :
INFO:model.model_wrapper:******valid score at epoch 26: 0.56843 :
 52%|█████▏    | 26/50 [04:26<04:04, 10.20s/it]INFO:model.model_wrapper:training 27  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 27: 0.0087512 :
INFO:model.model_wrapper:******train score at epoch 27: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 27: 0.4275716 :
INFO:model.model_wrapper:******valid score at epoch 27: 0.59247 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6708513 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6025403 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:19, 10.19s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5784711 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32752 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5470929 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:09, 10.19s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4632423 :
INFO:model.model_wrapper:******train score at epoch 3: 0.70876 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5155314 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.57798 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.57798
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:00, 10.22s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3626923 :
INFO:model.model_wrapper:******train score at epoch 4: 0.84708 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4653552 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.62883 :
INFO:model.model_wrapper:validation score is improved from 0.57798 to 0.62883
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:51, 10.24s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2786769 :
INFO:model.model_wrapper:******train score at epoch 5: 0.92180 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4391300 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.56843 :
 10%|█         | 5/50 [00:51<07:40, 10.23s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2493551 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91429 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4045072 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.57633 :
 12%|█▏        | 6/50 [01:01<07:29, 10.22s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1770772 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3466092 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.59294 :
 14%|█▍        | 7/50 [01:11<07:18, 10.19s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1351137 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3569549 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.58450 :
 16%|█▌        | 8/50 [01:21<07:10, 10.24s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1036036 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3586736 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.59294 :
 18%|█▊        | 9/50 [01:31<06:58, 10.20s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0790966 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3520923 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.58450 :
 20%|██        | 10/50 [01:42<06:50, 10.25s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0630906 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3802337 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.58450 :
 22%|██▏       | 11/50 [01:52<06:40, 10.28s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0518614 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3672447 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.59294 :
 24%|██▍       | 12/50 [02:02<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0370506 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3456286 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.59294 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0314115 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3617430 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.58450 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6663653 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6269248 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5385463 :
INFO:model.model_wrapper:******train score at epoch 2: 0.24701 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4987169 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:11, 10.23s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4259168 :
INFO:model.model_wrapper:******train score at epoch 3: 0.41492 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3544037 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.29530 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.29530
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.29s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3375309 :
INFO:model.model_wrapper:******train score at epoch 4: 0.58216 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.2462428 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.54743 :
INFO:model.model_wrapper:validation score is improved from 0.29530 to 0.54743
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.28s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2700638 :
INFO:model.model_wrapper:******train score at epoch 5: 0.73885 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2272296 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.59335 :
INFO:model.model_wrapper:validation score is improved from 0.54743 to 0.59335
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:42, 10.29s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2092653 :
INFO:model.model_wrapper:******train score at epoch 6: 0.84878 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2719776 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.56023 :
 12%|█▏        | 6/50 [01:01<07:31, 10.26s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1600823 :
INFO:model.model_wrapper:******train score at epoch 7: 0.91026 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3057615 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.60025 :
INFO:model.model_wrapper:validation score is improved from 0.59335 to 0.60025
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:11<07:22, 10.29s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1271364 :
INFO:model.model_wrapper:******train score at epoch 8: 0.92761 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3345133 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.60827 :
INFO:model.model_wrapper:validation score is improved from 0.60025 to 0.60827
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0858148 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3387565 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.60827 :
 18%|█▊        | 9/50 [01:32<07:01, 10.28s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0691136 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3621905 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.60827 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0624072 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4404713 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.60025 :
 22%|██▏       | 11/50 [01:52<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0506429 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4366579 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.57762 :
 24%|██▍       | 12/50 [02:03<06:29, 10.25s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0494130 :
INFO:model.model_wrapper:******train score at epoch 13: 0.96318 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3873372 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.58493 :
 26%|██▌       | 13/50 [02:13<06:18, 10.24s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0310381 :
INFO:model.model_wrapper:******train score at epoch 14: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3846104 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.60025 :
 28%|██▊       | 14/50 [02:23<06:09, 10.26s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0236193 :
INFO:model.model_wrapper:******train score at epoch 15: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3455263 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.60827 :
 30%|███       | 15/50 [02:33<05:58, 10.23s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0291146 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3220302 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.56023 :
 32%|███▏      | 16/50 [02:44<05:47, 10.22s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0184312 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3117901 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.62511 :
INFO:model.model_wrapper:validation score is improved from 0.60827 to 0.62511
INFO:model.model_wrapper:Checkpoint saved
 34%|███▍      | 17/50 [02:54<05:39, 10.28s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0218313 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.4019447 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.57762 :
 36%|███▌      | 18/50 [03:04<05:28, 10.26s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0207074 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.5731011 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.52011 :
 38%|███▊      | 19/50 [03:15<05:19, 10.31s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0156679 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.6851493 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.46481 :
 40%|████      | 20/50 [03:25<05:09, 10.33s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0133037 :
INFO:model.model_wrapper:******train score at epoch 21: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.6808541 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.48831 :
 42%|████▏     | 21/50 [03:35<04:58, 10.29s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0114700 :
INFO:model.model_wrapper:******train score at epoch 22: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.6056481 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.52011 :
 44%|████▍     | 22/50 [03:46<04:47, 10.28s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0095067 :
INFO:model.model_wrapper:******train score at epoch 23: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.5534541 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.53175 :
 46%|████▌     | 23/50 [03:56<04:37, 10.26s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.0097055 :
INFO:model.model_wrapper:******train score at epoch 24: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.4909624 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.52577 :
 48%|████▊     | 24/50 [04:06<04:26, 10.25s/it]INFO:model.model_wrapper:training 25  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 25: 0.0092249 :
INFO:model.model_wrapper:******train score at epoch 25: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 25: 0.4190033 :
INFO:model.model_wrapper:******valid score at epoch 25: 0.53916 :
 50%|█████     | 25/50 [04:16<04:16, 10.24s/it]INFO:model.model_wrapper:training 26  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 26: 0.0090890 :
INFO:model.model_wrapper:******train score at epoch 26: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 26: 0.4017081 :
INFO:model.model_wrapper:******valid score at epoch 26: 0.53916 :
 52%|█████▏    | 26/50 [04:26<04:05, 10.24s/it]INFO:model.model_wrapper:training 27  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 27: 0.0093583 :
INFO:model.model_wrapper:******train score at epoch 27: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 27: 0.5241475 :
INFO:model.model_wrapper:******valid score at epoch 27: 0.55035 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6681538 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5979718 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:20, 10.21s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5851069 :
INFO:model.model_wrapper:******train score at epoch 2: 0.11251 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5260507 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:10, 10.23s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4873961 :
INFO:model.model_wrapper:******train score at epoch 3: 0.25124 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4101639 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 3: 0.00000 :
  6%|▌         | 3/50 [00:30<08:00, 10.23s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4009320 :
INFO:model.model_wrapper:******train score at epoch 4: 0.44554 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.2897399 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.42513 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.42513
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.27s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3229721 :
INFO:model.model_wrapper:******train score at epoch 5: 0.66441 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2298364 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.64461 :
INFO:model.model_wrapper:validation score is improved from 0.42513 to 0.64461
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:45, 10.33s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2607737 :
INFO:model.model_wrapper:******train score at epoch 6: 0.78032 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2153476 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.59335 :
 12%|█▏        | 6/50 [01:01<07:32, 10.29s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2219251 :
INFO:model.model_wrapper:******train score at epoch 7: 0.84159 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2353904 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62011 :
 14%|█▍        | 7/50 [01:11<07:21, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1577468 :
INFO:model.model_wrapper:******train score at epoch 8: 0.91601 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2456668 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.61655 :
 16%|█▌        | 8/50 [01:22<07:11, 10.27s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1140652 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2586582 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.61655 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0955482 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2723489 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.60025 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0770076 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2546283 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.55335 :
 22%|██▏       | 11/50 [01:53<06:40, 10.27s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0563246 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3180026 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53916 :
 24%|██▍       | 12/50 [02:03<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0383088 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3521324 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.53916 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0375309 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2994821 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.55335 :
 28%|██▊       | 14/50 [02:23<06:08, 10.24s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0317850 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3215603 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.56843 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6614435 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09728 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6239620 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:22, 10.26s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5255989 :
INFO:model.model_wrapper:******train score at epoch 2: 0.52377 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5968326 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:10, 10.22s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4111845 :
INFO:model.model_wrapper:******train score at epoch 3: 0.77502 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5590275 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.54519 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.54519
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:01, 10.24s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3066116 :
INFO:model.model_wrapper:******train score at epoch 4: 0.89884 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5122416 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.57633 :
INFO:model.model_wrapper:validation score is improved from 0.54519 to 0.57633
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.28s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2464310 :
INFO:model.model_wrapper:******train score at epoch 5: 0.91601 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4657848 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53916 :
 10%|█         | 5/50 [00:51<07:41, 10.26s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1854529 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4688478 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.52577 :
 12%|█▏        | 6/50 [01:01<07:30, 10.24s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1317765 :
INFO:model.model_wrapper:******train score at epoch 7: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4249577 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.53916 :
 14%|█▍        | 7/50 [01:11<07:20, 10.24s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0934722 :
INFO:model.model_wrapper:******train score at epoch 8: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4726200 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.51935 :
 16%|█▌        | 8/50 [01:21<07:09, 10.24s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0997376 :
INFO:model.model_wrapper:******train score at epoch 9: 0.97508 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3687019 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.54615 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0605849 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3371716 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.54389 :
 20%|██        | 10/50 [01:42<06:51, 10.29s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0494117 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3381657 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.56883 :
 22%|██▏       | 11/50 [01:52<06:41, 10.29s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0334988 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3566695 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53612 :
 24%|██▍       | 12/50 [02:03<06:32, 10.32s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0342122 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4218429 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.50737 :
 26%|██▌       | 13/50 [02:13<06:20, 10.29s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0275459 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5586402 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50701 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6646860 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6261302 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5435600 :
INFO:model.model_wrapper:******train score at epoch 2: 0.24414 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5176557 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:10, 10.22s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4509906 :
INFO:model.model_wrapper:******train score at epoch 3: 0.44049 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4239687 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.36422 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.36422
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.27s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3523264 :
INFO:model.model_wrapper:******train score at epoch 4: 0.64007 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3325038 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.58523 :
INFO:model.model_wrapper:validation score is improved from 0.36422 to 0.58523
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:52, 10.27s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2659629 :
INFO:model.model_wrapper:******train score at epoch 5: 0.80591 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2614490 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.58119 :
 10%|█         | 5/50 [00:51<07:40, 10.24s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1949411 :
INFO:model.model_wrapper:******train score at epoch 6: 0.86372 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2840090 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.60167 :
INFO:model.model_wrapper:validation score is improved from 0.58523 to 0.60167
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:32, 10.28s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1401513 :
INFO:model.model_wrapper:******train score at epoch 7: 0.91508 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2864995 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62511 :
INFO:model.model_wrapper:validation score is improved from 0.60167 to 0.62511
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:11<07:22, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.0951547 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3317245 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.58493 :
 16%|█▌        | 8/50 [01:22<07:10, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0712574 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3103572 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.60827 :
 18%|█▊        | 9/50 [01:32<07:00, 10.25s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0553089 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3575520 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.57051 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0405238 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3594045 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.58493 :
 22%|██▏       | 11/50 [01:52<06:40, 10.27s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0291231 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4040289 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.56360 :
 24%|██▍       | 12/50 [02:03<06:29, 10.24s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0259100 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3795947 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.57051 :
 26%|██▌       | 13/50 [02:13<06:18, 10.24s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0243017 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3971056 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.57051 :
 28%|██▊       | 14/50 [02:23<06:09, 10.26s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0185014 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4081392 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.56360 :
 30%|███       | 15/50 [02:33<05:58, 10.25s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0191120 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4126173 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.56360 :
 32%|███▏      | 16/50 [02:44<05:48, 10.26s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0187406 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4334916 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.54399 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6606850 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6722929 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:18, 10.18s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5282507 :
INFO:model.model_wrapper:******train score at epoch 2: 0.33333 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4987150 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:07, 10.16s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4249726 :
INFO:model.model_wrapper:******train score at epoch 3: 0.51946 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3695936 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.42513 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.42513
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<07:59, 10.21s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3265115 :
INFO:model.model_wrapper:******train score at epoch 4: 0.71564 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.2981822 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.50119 :
INFO:model.model_wrapper:validation score is improved from 0.42513 to 0.50119
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:40<07:50, 10.23s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2785710 :
INFO:model.model_wrapper:******train score at epoch 5: 0.73659 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2646887 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.58288 :
INFO:model.model_wrapper:validation score is improved from 0.50119 to 0.58288
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:42, 10.27s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1764879 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90254 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2470039 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.58701 :
INFO:model.model_wrapper:validation score is improved from 0.58288 to 0.58701
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:01<07:32, 10.29s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1237292 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2854861 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.59247 :
INFO:model.model_wrapper:validation score is improved from 0.58701 to 0.59247
INFO:model.model_wrapper:Checkpoint saved
 14%|█▍        | 7/50 [01:11<07:23, 10.30s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1006390 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2770478 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.56843 :
 16%|█▌        | 8/50 [01:22<07:12, 10.29s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0727429 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96922 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3238110 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.57762 :
 18%|█▊        | 9/50 [01:32<07:01, 10.29s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0514041 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3458198 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.56360 :
 20%|██        | 10/50 [01:42<06:51, 10.28s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0473555 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4300163 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.53779 :
 22%|██▏       | 11/50 [01:52<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0302714 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4102613 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.55035 :
 24%|██▍       | 12/50 [02:03<06:29, 10.26s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0223807 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3846171 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.53916 :
 26%|██▌       | 13/50 [02:13<06:19, 10.25s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0220397 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4018148 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.51423 :
 28%|██▊       | 14/50 [02:23<06:08, 10.24s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0212567 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3972523 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.57051 :
 30%|███       | 15/50 [02:33<05:58, 10.23s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0164281 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4480866 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.55689 :
 32%|███▏      | 16/50 [02:44<05:47, 10.23s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0138055 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4780223 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.56360 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6767023 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6233102 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:27, 10.35s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5734929 :
INFO:model.model_wrapper:******train score at epoch 2: 0.37411 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5833502 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:15, 10.32s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4657421 :
INFO:model.model_wrapper:******train score at epoch 3: 0.68553 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5132758 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.48022 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.48022
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:04, 10.31s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3787751 :
INFO:model.model_wrapper:******train score at epoch 4: 0.76753 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4189881 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.54519 :
INFO:model.model_wrapper:validation score is improved from 0.48022 to 0.54519
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:54, 10.32s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2879196 :
INFO:model.model_wrapper:******train score at epoch 5: 0.85111 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3371769 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.56961 :
INFO:model.model_wrapper:validation score is improved from 0.54519 to 0.56961
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:44, 10.33s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2183077 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91601 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3496327 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.56843 :
 12%|█▏        | 6/50 [01:01<07:32, 10.28s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1574433 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94525 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3849746 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55335 :
 14%|█▍        | 7/50 [01:11<07:20, 10.25s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1417496 :
INFO:model.model_wrapper:******train score at epoch 8: 0.93867 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4121398 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.55335 :
 16%|█▌        | 8/50 [01:22<07:11, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0877565 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3151205 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.54417 :
 18%|█▊        | 9/50 [01:32<07:01, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0752639 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95119 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2729326 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.57261 :
INFO:model.model_wrapper:validation score is improved from 0.56961 to 0.57261
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:42<06:52, 10.31s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0717764 :
INFO:model.model_wrapper:******train score at epoch 11: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3734076 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.56843 :
 22%|██▏       | 11/50 [01:53<06:41, 10.30s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0419614 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97530 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5087855 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.55035 :
 24%|██▍       | 12/50 [02:03<06:30, 10.28s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0372644 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.5680090 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51450 :
 26%|██▌       | 13/50 [02:13<06:19, 10.26s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0283069 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5723268 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.50366 :
 28%|██▊       | 14/50 [02:23<06:10, 10.28s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0262635 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.5358597 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.52011 :
 30%|███       | 15/50 [02:34<05:57, 10.22s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.0237496 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.5193847 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.52585 :
 32%|███▏      | 16/50 [02:44<05:47, 10.21s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0183004 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4845687 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.55689 :
 34%|███▍      | 17/50 [02:54<05:37, 10.22s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.0220030 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3986713 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.60827 :
INFO:model.model_wrapper:validation score is improved from 0.57261 to 0.60827
INFO:model.model_wrapper:Checkpoint saved
 36%|███▌      | 18/50 [03:04<05:29, 10.30s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.0181675 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3902963 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.62511 :
INFO:model.model_wrapper:validation score is improved from 0.60827 to 0.62511
INFO:model.model_wrapper:Checkpoint saved
 38%|███▊      | 19/50 [03:15<05:20, 10.33s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.0126225 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3850656 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.62511 :
 40%|████      | 20/50 [03:25<05:08, 10.29s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.0148649 :
INFO:model.model_wrapper:******train score at epoch 21: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.4146787 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.62511 :
 42%|████▏     | 21/50 [03:35<04:58, 10.28s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.0125420 :
INFO:model.model_wrapper:******train score at epoch 22: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.4356085 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.60025 :
 44%|████▍     | 22/50 [03:46<04:47, 10.28s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.0122044 :
INFO:model.model_wrapper:******train score at epoch 23: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.4505794 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.57762 :
 46%|████▌     | 23/50 [03:56<04:36, 10.25s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.0124937 :
INFO:model.model_wrapper:******train score at epoch 24: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.4795462 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.57762 :
 48%|████▊     | 24/50 [04:06<04:26, 10.24s/it]INFO:model.model_wrapper:training 25  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 25: 0.0121986 :
INFO:model.model_wrapper:******train score at epoch 25: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 25: 0.4590727 :
INFO:model.model_wrapper:******valid score at epoch 25: 0.57762 :
 50%|█████     | 25/50 [04:16<04:16, 10.26s/it]INFO:model.model_wrapper:training 26  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 26: 0.0113138 :
INFO:model.model_wrapper:******train score at epoch 26: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 26: 0.4426071 :
INFO:model.model_wrapper:******valid score at epoch 26: 0.59247 :
 52%|█████▏    | 26/50 [04:27<04:06, 10.26s/it]INFO:model.model_wrapper:training 27  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 27: 0.0100266 :
INFO:model.model_wrapper:******train score at epoch 27: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 27: 0.5123891 :
INFO:model.model_wrapper:******valid score at epoch 27: 0.57051 :
 54%|█████▍    | 27/50 [04:37<03:55, 10.23s/it]INFO:model.model_wrapper:training 28  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 28: 0.0087664 :
INFO:model.model_wrapper:******train score at epoch 28: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 28: 0.5467678 :
INFO:model.model_wrapper:******valid score at epoch 28: 0.55689 :
 56%|█████▌    | 28/50 [04:47<03:45, 10.24s/it]INFO:model.model_wrapper:training 29  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 29: 0.0110835 :
INFO:model.model_wrapper:******train score at epoch 29: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 29: 0.4947328 :
INFO:model.model_wrapper:******valid score at epoch 29: 0.58493 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6722122 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6560374 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:18, 10.18s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5663434 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32451 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5639578 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:20<08:10, 10.22s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4686126 :
INFO:model.model_wrapper:******train score at epoch 3: 0.58296 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4661820 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.29530 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.29530
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:03, 10.29s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3763122 :
INFO:model.model_wrapper:******train score at epoch 4: 0.77732 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3756069 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.64976 :
INFO:model.model_wrapper:validation score is improved from 0.29530 to 0.64976
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:56, 10.35s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2945559 :
INFO:model.model_wrapper:******train score at epoch 5: 0.82182 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3026599 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53355 :
 10%|█         | 5/50 [00:51<07:45, 10.34s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2309008 :
INFO:model.model_wrapper:******train score at epoch 6: 0.87077 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2715948 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.63997 :
 12%|█▏        | 6/50 [01:02<07:33, 10.31s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1862692 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93867 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2553334 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.62985 :
 14%|█▍        | 7/50 [01:12<07:22, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1213305 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2625592 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.61655 :
 16%|█▌        | 8/50 [01:22<07:10, 10.26s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1007657 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95717 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2772433 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.60827 :
 18%|█▊        | 9/50 [01:32<07:00, 10.27s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0771332 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2703155 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.62511 :
 20%|██        | 10/50 [01:43<06:51, 10.30s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0674149 :
INFO:model.model_wrapper:******train score at epoch 11: 0.99377 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3263469 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.60827 :
 22%|██▏       | 11/50 [01:53<06:40, 10.26s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0456159 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2770853 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.64312 :
 24%|██▍       | 12/50 [02:03<06:29, 10.24s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0382816 :
INFO:model.model_wrapper:******train score at epoch 13: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2887286 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.61072 :
 26%|██▌       | 13/50 [02:13<06:18, 10.23s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0300407 :
INFO:model.model_wrapper:******train score at epoch 14: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3112840 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.58450 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 320
INFO:model.model_wrapper:valid with data size: 290
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6779488 :
INFO:model.model_wrapper:******train score at epoch 1: 0.02520 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6864439 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:10<08:21, 10.24s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5577662 :
INFO:model.model_wrapper:******train score at epoch 2: 0.41191 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6012669 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.25619 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.25619
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:20<08:10, 10.23s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4414257 :
INFO:model.model_wrapper:******train score at epoch 3: 0.63729 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4866795 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.44845 :
INFO:model.model_wrapper:validation score is improved from 0.25619 to 0.44845
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:30<08:02, 10.27s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3592752 :
INFO:model.model_wrapper:******train score at epoch 4: 0.75135 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3616063 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.48110 :
INFO:model.model_wrapper:validation score is improved from 0.44845 to 0.48110
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:41<07:53, 10.30s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.2569703 :
INFO:model.model_wrapper:******train score at epoch 5: 0.84553 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2833925 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.62789 :
INFO:model.model_wrapper:validation score is improved from 0.48110 to 0.62789
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:51<07:44, 10.33s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.1827219 :
INFO:model.model_wrapper:******train score at epoch 6: 0.89197 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2829318 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.56023 :
 12%|█▏        | 6/50 [01:01<07:33, 10.31s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.1429883 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93273 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3330556 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.56843 :
 14%|█▍        | 7/50 [01:12<07:21, 10.28s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.1030482 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96280 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2886686 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.55192 :
 16%|█▌        | 8/50 [01:22<07:11, 10.28s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.0656696 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98142 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2382176 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.57261 :
 18%|█▊        | 9/50 [01:32<07:00, 10.26s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.0508240 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2689884 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.54417 :
 20%|██        | 10/50 [01:42<06:50, 10.27s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.0428650 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3578344 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.56077 :
 22%|██▏       | 11/50 [01:53<06:39, 10.25s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.0328179 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3808672 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.55335 :
 24%|██▍       | 12/50 [02:03<06:28, 10.23s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.0290823 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4113452 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.57051 :
 26%|██▌       | 13/50 [02:13<06:17, 10.21s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.0204589 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4464525 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.58493 :
 28%|██▊       | 14/50 [02:23<06:07, 10.22s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.0173138 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4260098 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.58493 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 8 / 10 ****
INFO:runner.model.base_runner:****cv 8 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6942727 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09698 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6641312 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:22, 11.48s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5880842 :
INFO:model.model_wrapper:******train score at epoch 2: 0.48344 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5512471 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:09, 11.44s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4914888 :
INFO:model.model_wrapper:******train score at epoch 3: 0.62765 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4045740 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.24758 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.24758
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:59, 11.48s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4120892 :
INFO:model.model_wrapper:******train score at epoch 4: 0.74766 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3800306 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.64912 :
INFO:model.model_wrapper:validation score is improved from 0.24758 to 0.64912
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:48, 11.49s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3682949 :
INFO:model.model_wrapper:******train score at epoch 5: 0.82088 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3368511 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.55278 :
 10%|█         | 5/50 [00:57<08:35, 11.46s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2952382 :
INFO:model.model_wrapper:******train score at epoch 6: 0.84966 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3088399 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.53825 :
 12%|█▏        | 6/50 [01:08<08:22, 11.43s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2293228 :
INFO:model.model_wrapper:******train score at epoch 7: 0.91652 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2683080 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55759 :
 14%|█▍        | 7/50 [01:20<08:11, 11.44s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2523798 :
INFO:model.model_wrapper:******train score at epoch 8: 0.94558 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2639844 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.54171 :
 16%|█▌        | 8/50 [01:31<08:00, 11.44s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2198005 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2163470 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.55278 :
 18%|█▊        | 9/50 [01:42<07:48, 11.44s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.1806787 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2805359 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.53825 :
 20%|██        | 10/50 [01:54<07:36, 11.42s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.1752016 :
INFO:model.model_wrapper:******train score at epoch 11: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4318399 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.54171 :
 22%|██▏       | 11/50 [02:05<07:24, 11.39s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1369054 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4305217 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.47399 :
 24%|██▍       | 12/50 [02:17<07:12, 11.37s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1910430 :
INFO:model.model_wrapper:******train score at epoch 13: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3917821 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.48115 :
 26%|██▌       | 13/50 [02:28<07:01, 11.38s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.2563711 :
INFO:model.model_wrapper:******train score at epoch 14: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3645760 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.48758 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6762979 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6338194 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:18, 11.39s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5788297 :
INFO:model.model_wrapper:******train score at epoch 2: 0.23609 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4646306 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:06, 11.38s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5320583 :
INFO:model.model_wrapper:******train score at epoch 3: 0.45256 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3727122 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.40601 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.40601
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:56, 11.42s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4369769 :
INFO:model.model_wrapper:******train score at epoch 4: 0.70223 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3299230 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.66649 :
INFO:model.model_wrapper:validation score is improved from 0.40601 to 0.66649
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:47, 11.47s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3758913 :
INFO:model.model_wrapper:******train score at epoch 5: 0.82994 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3315009 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.56441 :
 10%|█         | 5/50 [00:57<08:36, 11.47s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3217573 :
INFO:model.model_wrapper:******train score at epoch 6: 0.87445 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3964724 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.50102 :
 12%|█▏        | 6/50 [01:08<08:25, 11.49s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2953593 :
INFO:model.model_wrapper:******train score at epoch 7: 0.85915 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2863291 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.53113 :
 14%|█▍        | 7/50 [01:20<08:12, 11.45s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2666875 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3024640 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.54772 :
 16%|█▌        | 8/50 [01:31<08:02, 11.48s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2054359 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96303 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3562874 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.51532 :
 18%|█▊        | 9/50 [01:43<07:50, 11.46s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2886540 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4557842 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.46882 :
 20%|██        | 10/50 [01:54<07:38, 11.46s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2662160 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3479260 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.53056 :
 22%|██▏       | 11/50 [02:06<07:26, 11.44s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.2079232 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2549102 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.55278 :
 24%|██▍       | 12/50 [02:17<07:14, 11.43s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1830754 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2582598 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.57851 :
 26%|██▌       | 13/50 [02:28<07:03, 11.44s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1782666 :
INFO:model.model_wrapper:******train score at epoch 14: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.5188092 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.34324 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6755132 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07535 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6642906 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:15, 11.34s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.6199814 :
INFO:model.model_wrapper:******train score at epoch 2: 0.44623 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6635781 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.46315 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.46315
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:08, 11.42s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5409246 :
INFO:model.model_wrapper:******train score at epoch 3: 0.69865 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6142967 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.60315 :
INFO:model.model_wrapper:validation score is improved from 0.46315 to 0.60315
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:58, 11.46s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4590961 :
INFO:model.model_wrapper:******train score at epoch 4: 0.80702 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5670978 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.51197 :
  8%|▊         | 4/50 [00:45<08:46, 11.44s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3915693 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88695 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5469613 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.44773 :
 10%|█         | 5/50 [00:57<08:34, 11.43s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3772139 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91559 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.5375108 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.46291 :
 12%|█▏        | 6/50 [01:08<08:22, 11.42s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2773560 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4690166 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51532 :
 14%|█▍        | 7/50 [01:20<08:10, 11.40s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.3300256 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95698 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4730880 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.44607 :
 16%|█▌        | 8/50 [01:31<07:59, 11.41s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2598624 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4829505 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.42549 :
 18%|█▊        | 9/50 [01:42<07:48, 11.42s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2857777 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95097 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4511165 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.43553 :
 20%|██        | 10/50 [01:54<07:37, 11.43s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2420217 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3765622 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.50806 :
 22%|██▏       | 11/50 [02:05<07:26, 11.44s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.2075426 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3820188 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53113 :
 24%|██▍       | 12/50 [02:17<07:14, 11.45s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.2154759 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3863546 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.49349 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6810009 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09698 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6732996 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:17, 11.38s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5766224 :
INFO:model.model_wrapper:******train score at epoch 2: 0.45175 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6546025 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.40967 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.40967
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:08, 11.43s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5130864 :
INFO:model.model_wrapper:******train score at epoch 3: 0.76318 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6262407 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.56441 :
INFO:model.model_wrapper:validation score is improved from 0.40967 to 0.56441
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:58, 11.46s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4044502 :
INFO:model.model_wrapper:******train score at epoch 4: 0.86395 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5987715 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.51197 :
  8%|▊         | 4/50 [00:45<08:46, 11.46s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.4320937 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89484 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5599167 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.45400 :
 10%|█         | 5/50 [00:57<08:34, 11.44s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3760574 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95669 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4827299 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.46046 :
 12%|█▏        | 6/50 [01:08<08:22, 11.43s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.3678963 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93789 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4697840 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.42995 :
 14%|█▍        | 7/50 [01:20<08:12, 11.45s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2960236 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4198188 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.53113 :
 16%|█▌        | 8/50 [01:31<08:00, 11.45s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2722747 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4172532 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.47416 :
 18%|█▊        | 9/50 [01:43<07:51, 11.51s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2540056 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4841392 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.37849 :
 20%|██        | 10/50 [01:54<07:38, 11.46s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2203833 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4465993 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.43544 :
 22%|██▏       | 11/50 [02:06<07:26, 11.44s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1926881 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4585449 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.58253 :
INFO:model.model_wrapper:validation score is improved from 0.56441 to 0.58253
INFO:model.model_wrapper:Checkpoint saved
 24%|██▍       | 12/50 [02:17<07:16, 11.48s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1845090 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4277936 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.46984 :
 26%|██▌       | 13/50 [02:29<07:04, 11.47s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.2163067 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4043688 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.39555 :
 28%|██▊       | 14/50 [02:40<06:51, 11.44s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.1805875 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4423291 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.39763 :
 30%|███       | 15/50 [02:51<06:40, 11.43s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.1872254 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.5041611 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.35003 :
 32%|███▏      | 16/50 [03:03<06:28, 11.43s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.1609090 :
INFO:model.model_wrapper:******train score at epoch 17: 1.00000 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4347724 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.47558 :
 34%|███▍      | 17/50 [03:14<06:17, 11.44s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.2052913 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3585039 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.43609 :
 36%|███▌      | 18/50 [03:26<06:06, 11.45s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.1603963 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3649664 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.38526 :
 38%|███▊      | 19/50 [03:37<05:54, 11.43s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.1637136 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.4070515 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.41887 :
 40%|████      | 20/50 [03:48<05:42, 11.40s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.1358197 :
INFO:model.model_wrapper:******train score at epoch 21: 0.99381 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.3873463 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.39763 :
 42%|████▏     | 21/50 [04:00<05:30, 11.40s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.1870998 :
INFO:model.model_wrapper:******train score at epoch 22: 0.99381 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.3546469 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.39555 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6750285 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05581 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6352843 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:19, 11.42s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5835912 :
INFO:model.model_wrapper:******train score at epoch 2: 0.34471 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5404081 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:08, 11.43s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5007006 :
INFO:model.model_wrapper:******train score at epoch 3: 0.61968 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4337847 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.53769 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.53769
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:58, 11.45s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4373298 :
INFO:model.model_wrapper:******train score at epoch 4: 0.73239 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3753787 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.64912 :
INFO:model.model_wrapper:validation score is improved from 0.53769 to 0.64912
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:47, 11.46s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3674037 :
INFO:model.model_wrapper:******train score at epoch 5: 0.81553 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3422654 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.55278 :
 10%|█         | 5/50 [00:57<08:34, 11.43s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3144256 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92805 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3055039 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.54171 :
 12%|█▏        | 6/50 [01:08<08:21, 11.39s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2743182 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94558 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2915847 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52103 :
 14%|█▍        | 7/50 [01:19<08:09, 11.38s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2627146 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3215786 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.50208 :
 16%|█▌        | 8/50 [01:31<07:58, 11.40s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2329234 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95698 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4343430 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.45400 :
 18%|█▊        | 9/50 [01:42<07:47, 11.41s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.1739049 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4253262 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.40788 :
 20%|██        | 10/50 [01:54<07:35, 11.39s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2151440 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97516 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4515064 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.39652 :
 22%|██▏       | 11/50 [02:05<07:24, 11.40s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.2120050 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3630748 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.46080 :
 24%|██▍       | 12/50 [02:16<07:13, 11.40s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1934900 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4160838 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.44627 :
 26%|██▌       | 13/50 [02:28<07:02, 11.42s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1709122 :
INFO:model.model_wrapper:******train score at epoch 14: 0.99381 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3580218 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.44009 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6732094 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07535 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6877943 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:16, 11.35s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5749216 :
INFO:model.model_wrapper:******train score at epoch 2: 0.49693 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6157983 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.37615 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.37615
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:07, 11.40s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4892869 :
INFO:model.model_wrapper:******train score at epoch 3: 0.68409 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4650896 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.56920 :
INFO:model.model_wrapper:validation score is improved from 0.37615 to 0.56920
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:57, 11.43s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3972993 :
INFO:model.model_wrapper:******train score at epoch 4: 0.81755 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4346550 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.52040 :
  8%|▊         | 4/50 [00:45<08:45, 11.43s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3309170 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88130 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4542726 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.45154 :
 10%|█         | 5/50 [00:57<08:33, 11.42s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3128996 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92661 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3935678 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.43571 :
 12%|█▏        | 6/50 [01:08<08:22, 11.41s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2556799 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94558 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3602068 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.46882 :
 14%|█▍        | 7/50 [01:20<08:11, 11.42s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2227105 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4433888 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.43553 :
 16%|█▌        | 8/50 [01:31<07:58, 11.40s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2458924 :
INFO:model.model_wrapper:******train score at epoch 9: 0.92069 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2931384 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.51197 :
 18%|█▊        | 9/50 [01:42<07:47, 11.41s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2385270 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3471463 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.49420 :
 20%|██        | 10/50 [01:54<07:36, 11.42s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2033220 :
INFO:model.model_wrapper:******train score at epoch 11: 0.92805 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2962173 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.52281 :
 22%|██▏       | 11/50 [02:05<07:25, 11.43s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.2031970 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.5775049 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.41125 :
 24%|██▍       | 12/50 [02:17<07:16, 11.48s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1791530 :
INFO:model.model_wrapper:******train score at epoch 13: 0.94499 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4427369 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.48758 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6774646 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5942300 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:21, 11.45s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5484227 :
INFO:model.model_wrapper:******train score at epoch 2: 0.39979 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5270763 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:09, 11.45s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4653810 :
INFO:model.model_wrapper:******train score at epoch 3: 0.64305 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4105882 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.56511 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.56511
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:59, 11.48s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4045046 :
INFO:model.model_wrapper:******train score at epoch 4: 0.76055 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3506624 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.63285 :
INFO:model.model_wrapper:validation score is improved from 0.56511 to 0.63285
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:46<08:50, 11.53s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3331591 :
INFO:model.model_wrapper:******train score at epoch 5: 0.83707 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3038181 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.57865 :
 10%|█         | 5/50 [00:57<08:36, 11.48s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2873902 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92726 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2775965 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.57865 :
 12%|█▏        | 6/50 [01:08<08:24, 11.46s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2489007 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93970 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2958734 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.51197 :
 14%|█▍        | 7/50 [01:20<08:11, 11.43s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2078866 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3543183 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.47399 :
 16%|█▌        | 8/50 [01:31<08:00, 11.44s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2216654 :
INFO:model.model_wrapper:******train score at epoch 9: 0.94558 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2711920 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.49318 :
 18%|█▊        | 9/50 [01:43<07:50, 11.48s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.1910757 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3710808 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.48758 :
 20%|██        | 10/50 [01:54<07:38, 11.46s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.1773727 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4019143 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.45715 :
 22%|██▏       | 11/50 [02:06<07:26, 11.44s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1972021 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3971809 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.47490 :
 24%|██▍       | 12/50 [02:17<07:14, 11.43s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1789123 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4402599 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.44164 :
 26%|██▌       | 13/50 [02:28<07:03, 11.45s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1789822 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3590394 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.41381 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6624044 :
INFO:model.model_wrapper:******train score at epoch 1: 0.11215 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6344358 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:19, 11.42s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5757750 :
INFO:model.model_wrapper:******train score at epoch 2: 0.50710 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6113886 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.26458 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.26458
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:09, 11.45s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4845885 :
INFO:model.model_wrapper:******train score at epoch 3: 0.71224 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5395750 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.66578 :
INFO:model.model_wrapper:validation score is improved from 0.26458 to 0.66578
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:58, 11.45s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4470518 :
INFO:model.model_wrapper:******train score at epoch 4: 0.82626 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5127484 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.56441 :
  8%|▊         | 4/50 [00:45<08:46, 11.45s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3819985 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87706 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4980981 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.51197 :
 10%|█         | 5/50 [00:57<08:35, 11.45s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3330718 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91652 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.4359527 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.52281 :
 12%|█▏        | 6/50 [01:08<08:24, 11.48s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2912582 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93314 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4088349 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52915 :
 14%|█▍        | 7/50 [01:20<08:12, 11.46s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2707482 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4038313 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.48841 :
 16%|█▌        | 8/50 [01:31<07:59, 11.43s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2397756 :
INFO:model.model_wrapper:******train score at epoch 9: 0.92227 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3749077 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.51197 :
 18%|█▊        | 9/50 [01:43<07:48, 11.43s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2403321 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.4233046 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.48115 :
 20%|██        | 10/50 [01:54<07:36, 11.42s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2009729 :
INFO:model.model_wrapper:******train score at epoch 11: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3111338 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.53858 :
 22%|██▏       | 11/50 [02:05<07:25, 11.42s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.2365391 :
INFO:model.model_wrapper:******train score at epoch 12: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2974313 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.54688 :
 24%|██▍       | 12/50 [02:17<07:14, 11.43s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1856824 :
INFO:model.model_wrapper:******train score at epoch 13: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3291537 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51532 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6698418 :
INFO:model.model_wrapper:******train score at epoch 1: 0.07906 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6341574 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:23, 11.50s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5498655 :
INFO:model.model_wrapper:******train score at epoch 2: 0.55583 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5444260 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:10, 11.47s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4495337 :
INFO:model.model_wrapper:******train score at epoch 3: 0.79220 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4928626 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.52103 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.52103
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<09:00, 11.49s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3845177 :
INFO:model.model_wrapper:******train score at epoch 4: 0.87160 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4528220 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.53056 :
INFO:model.model_wrapper:validation score is improved from 0.52103 to 0.53056
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:48, 11.50s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3117348 :
INFO:model.model_wrapper:******train score at epoch 5: 0.91481 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4399567 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.48115 :
 10%|█         | 5/50 [00:57<08:36, 11.47s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3089113 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93314 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3765142 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.46291 :
 12%|█▏        | 6/50 [01:08<08:22, 11.43s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2735413 :
INFO:model.model_wrapper:******train score at epoch 7: 0.91559 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3682928 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.47490 :
 14%|█▍        | 7/50 [01:20<08:10, 11.41s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2300490 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3350618 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.46882 :
 16%|█▌        | 8/50 [01:31<08:00, 11.43s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1836002 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3653746 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.46291 :
 18%|█▊        | 9/50 [01:43<07:49, 11.44s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2078824 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2592110 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.53858 :
INFO:model.model_wrapper:validation score is improved from 0.53056 to 0.53858
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:54<07:38, 11.46s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.1884879 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3303204 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.48115 :
 22%|██▏       | 11/50 [02:05<07:26, 11.46s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1673746 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4079289 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.43553 :
 24%|██▍       | 12/50 [02:17<07:14, 11.44s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1984598 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3782752 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.43553 :
 26%|██▌       | 13/50 [02:28<07:03, 11.44s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1551831 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3981914 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.45715 :
 28%|██▊       | 14/50 [02:40<06:51, 11.44s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.1556879 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.3713015 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.46291 :
 30%|███       | 15/50 [02:51<06:39, 11.42s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.1798881 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4293741 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.44607 :
 32%|███▏      | 16/50 [03:02<06:27, 11.40s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.1522620 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4289524 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.45154 :
 34%|███▍      | 17/50 [03:14<06:16, 11.40s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.1731284 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.5438318 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.39365 :
 36%|███▌      | 18/50 [03:25<06:05, 11.42s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.1320352 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.5037905 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.42064 :
 38%|███▊      | 19/50 [03:37<05:53, 11.42s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.1506398 :
INFO:model.model_wrapper:******train score at epoch 20: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3860326 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.49420 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6838795 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05581 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6192475 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:16, 11.36s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5823894 :
INFO:model.model_wrapper:******train score at epoch 2: 0.32338 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5691830 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:06, 11.39s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5062354 :
INFO:model.model_wrapper:******train score at epoch 3: 0.63727 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4595484 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.40967 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.40967
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:57, 11.43s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4228814 :
INFO:model.model_wrapper:******train score at epoch 4: 0.79220 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3929841 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.66649 :
INFO:model.model_wrapper:validation score is improved from 0.40967 to 0.66649
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:47, 11.46s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3835791 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89734 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4223806 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.52040 :
 10%|█         | 5/50 [00:57<08:34, 11.43s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3372542 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90313 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3282110 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.58992 :
 12%|█▏        | 6/50 [01:08<08:22, 11.43s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2710437 :
INFO:model.model_wrapper:******train score at epoch 7: 0.91559 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2662051 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55278 :
 14%|█▍        | 7/50 [01:20<08:12, 11.44s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2756812 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3914032 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.46291 :
 16%|█▌        | 8/50 [01:31<07:59, 11.42s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2291157 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2926066 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53825 :
 18%|█▊        | 9/50 [01:43<07:50, 11.47s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.1930383 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2531704 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.61413 :
 20%|██        | 10/50 [01:54<07:37, 11.44s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2180682 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3254139 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.50384 :
 22%|██▏       | 11/50 [02:05<07:25, 11.43s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1832842 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3246844 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.54171 :
 24%|██▍       | 12/50 [02:17<07:15, 11.45s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1922035 :
INFO:model.model_wrapper:******train score at epoch 13: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4650026 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.53814 :
 26%|██▌       | 13/50 [02:28<07:02, 11.42s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1470749 :
INFO:model.model_wrapper:******train score at epoch 14: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4144170 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.48361 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
****cv 9 / 10 ****
INFO:runner.model.base_runner:****cv 9 / 10 ****
---- training bag 0 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 0 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6731863 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05581 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6225975 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:21, 11.47s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5893203 :
INFO:model.model_wrapper:******train score at epoch 2: 0.28012 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5142165 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.15652 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.15652
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:11, 11.48s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4951664 :
INFO:model.model_wrapper:******train score at epoch 3: 0.54120 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4761378 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.43544 :
INFO:model.model_wrapper:validation score is improved from 0.15652 to 0.43544
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<09:01, 11.51s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4241336 :
INFO:model.model_wrapper:******train score at epoch 4: 0.72229 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4100315 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.60315 :
INFO:model.model_wrapper:validation score is improved from 0.43544 to 0.60315
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:46<08:50, 11.52s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3710331 :
INFO:model.model_wrapper:******train score at epoch 5: 0.79657 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3141237 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.61413 :
INFO:model.model_wrapper:validation score is improved from 0.60315 to 0.61413
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:57<08:39, 11.54s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3322533 :
INFO:model.model_wrapper:******train score at epoch 6: 0.85347 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3080841 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.60383 :
 12%|█▏        | 6/50 [01:09<08:27, 11.53s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2715765 :
INFO:model.model_wrapper:******train score at epoch 7: 0.91079 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2990407 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.58333 :
 14%|█▍        | 7/50 [01:20<08:13, 11.48s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2648915 :
INFO:model.model_wrapper:******train score at epoch 8: 0.91079 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2394105 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.56789 :
 16%|█▌        | 8/50 [01:32<08:03, 11.51s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2119856 :
INFO:model.model_wrapper:******train score at epoch 9: 0.93905 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2449130 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.55759 :
 18%|█▊        | 9/50 [01:43<07:51, 11.49s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2203879 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2043838 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.62718 :
INFO:model.model_wrapper:validation score is improved from 0.61413 to 0.62718
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:55<07:40, 11.51s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2090436 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2651203 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.54772 :
 22%|██▏       | 11/50 [02:06<07:27, 11.47s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1767348 :
INFO:model.model_wrapper:******train score at epoch 12: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2440698 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.56789 :
 24%|██▍       | 12/50 [02:17<07:14, 11.45s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.2361129 :
INFO:model.model_wrapper:******train score at epoch 13: 0.96303 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.2751182 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.53825 :
 26%|██▌       | 13/50 [02:29<07:04, 11.47s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.2039380 :
INFO:model.model_wrapper:******train score at epoch 14: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2842025 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.64093 :
INFO:model.model_wrapper:validation score is improved from 0.62718 to 0.64093
INFO:model.model_wrapper:Checkpoint saved
 28%|██▊       | 14/50 [02:41<06:54, 11.52s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.1356647 :
INFO:model.model_wrapper:******train score at epoch 15: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2317594 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.64912 :
INFO:model.model_wrapper:validation score is improved from 0.64093 to 0.64912
INFO:model.model_wrapper:Checkpoint saved
 30%|███       | 15/50 [02:52<06:42, 11.50s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.1905125 :
INFO:model.model_wrapper:******train score at epoch 16: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.1927064 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.60493 :
 32%|███▏      | 16/50 [03:03<06:28, 11.44s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.1216393 :
INFO:model.model_wrapper:******train score at epoch 17: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.2224490 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.56427 :
 34%|███▍      | 17/50 [03:15<06:17, 11.44s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.3100806 :
INFO:model.model_wrapper:******train score at epoch 18: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.2228235 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.51470 :
 36%|███▌      | 18/50 [03:26<06:06, 11.45s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.1488712 :
INFO:model.model_wrapper:******train score at epoch 19: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.2347754 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.51470 :
 38%|███▊      | 19/50 [03:38<05:54, 11.42s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.1421906 :
INFO:model.model_wrapper:******train score at epoch 20: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.2545498 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.53814 :
 40%|████      | 20/50 [03:49<05:42, 11.43s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.1723554 :
INFO:model.model_wrapper:******train score at epoch 21: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.2246278 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.53814 :
 42%|████▏     | 21/50 [04:01<05:32, 11.47s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.1471476 :
INFO:model.model_wrapper:******train score at epoch 22: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.3950352 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.49318 :
 44%|████▍     | 22/50 [04:12<05:21, 11.47s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.1249640 :
INFO:model.model_wrapper:******train score at epoch 23: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.4149990 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.47638 :
 46%|████▌     | 23/50 [04:23<05:09, 11.45s/it]INFO:model.model_wrapper:training 24  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 24: 0.1597293 :
INFO:model.model_wrapper:******train score at epoch 24: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 24: 0.3380077 :
INFO:model.model_wrapper:******valid score at epoch 24: 0.48462 :
 48%|████▊     | 24/50 [04:35<04:57, 11.45s/it]INFO:model.model_wrapper:training 25  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 25: 0.2036818 :
INFO:model.model_wrapper:******train score at epoch 25: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 25: 0.3768680 :
INFO:model.model_wrapper:******valid score at epoch 25: 0.49318 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 1 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 1 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6590685 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05581 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6059033 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:18, 11.40s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5463642 :
INFO:model.model_wrapper:******train score at epoch 2: 0.44623 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5496213 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.07961 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.07961
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:23<09:10, 11.48s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4539762 :
INFO:model.model_wrapper:******train score at epoch 3: 0.71943 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4845096 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.53822 :
INFO:model.model_wrapper:validation score is improved from 0.07961 to 0.53822
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:59, 11.49s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3833319 :
INFO:model.model_wrapper:******train score at epoch 4: 0.79931 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3949626 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.57865 :
INFO:model.model_wrapper:validation score is improved from 0.53822 to 0.57865
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:46<08:49, 11.50s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3302326 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88130 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3968910 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.50806 :
 10%|█         | 5/50 [00:57<08:35, 11.45s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2896957 :
INFO:model.model_wrapper:******train score at epoch 6: 0.92227 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2778384 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.52915 :
 12%|█▏        | 6/50 [01:08<08:23, 11.44s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2725663 :
INFO:model.model_wrapper:******train score at epoch 7: 0.90125 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3465816 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.52281 :
 14%|█▍        | 7/50 [01:20<08:10, 11.42s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2081373 :
INFO:model.model_wrapper:******train score at epoch 8: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3817215 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.49420 :
 16%|█▌        | 8/50 [01:31<07:59, 11.43s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2386482 :
INFO:model.model_wrapper:******train score at epoch 9: 0.94558 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3200826 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.53858 :
 18%|█▊        | 9/50 [01:43<07:49, 11.45s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.1854737 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3686674 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.50102 :
 20%|██        | 10/50 [01:54<07:37, 11.44s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.1988018 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4178773 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.48115 :
 22%|██▏       | 11/50 [02:06<07:26, 11.46s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1620208 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3199356 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.53056 :
 24%|██▍       | 12/50 [02:17<07:15, 11.47s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1256370 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3405813 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.56441 :
 26%|██▌       | 13/50 [02:28<07:03, 11.43s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.2300589 :
INFO:model.model_wrapper:******train score at epoch 14: 0.93314 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4126111 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.45715 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 2 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 2 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6763830 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6527284 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:17, 11.38s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5702888 :
INFO:model.model_wrapper:******train score at epoch 2: 0.53149 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6504246 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.22213 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.22213
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:08, 11.43s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4836611 :
INFO:model.model_wrapper:******train score at epoch 3: 0.83165 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5886959 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.53113 :
INFO:model.model_wrapper:validation score is improved from 0.22213 to 0.53113
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:58, 11.46s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4338678 :
INFO:model.model_wrapper:******train score at epoch 4: 0.90510 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5532231 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.50384 :
  8%|▊         | 4/50 [00:45<08:46, 11.44s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3786793 :
INFO:model.model_wrapper:******train score at epoch 5: 0.90313 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5572072 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.54772 :
INFO:model.model_wrapper:validation score is improved from 0.53113 to 0.54772
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:57<08:35, 11.45s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3281211 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93314 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.5371818 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.48841 :
 12%|█▏        | 6/50 [01:08<08:22, 11.42s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2940739 :
INFO:model.model_wrapper:******train score at epoch 7: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.5245395 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.46712 :
 14%|█▍        | 7/50 [01:20<08:12, 11.45s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2439858 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4949208 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.46712 :
 16%|█▌        | 8/50 [01:31<08:00, 11.45s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2433936 :
INFO:model.model_wrapper:******train score at epoch 9: 0.94558 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.5295967 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.54772 :
 18%|█▊        | 9/50 [01:43<07:49, 11.45s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2048680 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.5031995 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.50384 :
 20%|██        | 10/50 [01:54<07:37, 11.43s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2199071 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96911 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4369289 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.51197 :
 22%|██▏       | 11/50 [02:05<07:25, 11.42s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1931706 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4829962 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.55548 :
INFO:model.model_wrapper:validation score is improved from 0.54772 to 0.55548
INFO:model.model_wrapper:Checkpoint saved
 24%|██▍       | 12/50 [02:17<07:14, 11.44s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1859452 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4663399 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.56441 :
INFO:model.model_wrapper:validation score is improved from 0.55548 to 0.56441
INFO:model.model_wrapper:Checkpoint saved
 26%|██▌       | 13/50 [02:28<07:04, 11.47s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.2340157 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.4586419 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.54688 :
 28%|██▊       | 14/50 [02:40<06:51, 11.43s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.1427525 :
INFO:model.model_wrapper:******train score at epoch 15: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4550221 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.54688 :
 30%|███       | 15/50 [02:51<06:40, 11.43s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.1607385 :
INFO:model.model_wrapper:******train score at epoch 16: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.4703152 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.48758 :
 32%|███▏      | 16/50 [03:03<06:28, 11.43s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.0819287 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.4497769 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.50102 :
 34%|███▍      | 17/50 [03:14<06:18, 11.46s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.1650796 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3447795 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.54688 :
 36%|███▌      | 18/50 [03:26<06:06, 11.46s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.2007781 :
INFO:model.model_wrapper:******train score at epoch 19: 0.98139 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.4224434 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.53056 :
 38%|███▊      | 19/50 [03:37<05:54, 11.45s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.1663528 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.4554950 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.54772 :
 40%|████      | 20/50 [03:48<05:43, 11.44s/it]INFO:model.model_wrapper:training 21  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 21: 0.1692572 :
INFO:model.model_wrapper:******train score at epoch 21: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 21: 0.4909367 :
INFO:model.model_wrapper:******valid score at epoch 21: 0.52040 :
 42%|████▏     | 21/50 [04:00<05:31, 11.43s/it]INFO:model.model_wrapper:training 22  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 22: 0.1549495 :
INFO:model.model_wrapper:******train score at epoch 22: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 22: 0.4912295 :
INFO:model.model_wrapper:******valid score at epoch 22: 0.53056 :
 44%|████▍     | 22/50 [04:11<05:19, 11.42s/it]INFO:model.model_wrapper:training 23  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 23: 0.1699919 :
INFO:model.model_wrapper:******train score at epoch 23: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 23: 0.4995295 :
INFO:model.model_wrapper:******valid score at epoch 23: 0.50102 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 3 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 3 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6696221 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05581 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5763191 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:17, 11.37s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5515309 :
INFO:model.model_wrapper:******train score at epoch 2: 0.39784 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4790284 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:05, 11.37s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4507807 :
INFO:model.model_wrapper:******train score at epoch 3: 0.72530 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3985367 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.49155 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.49155
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:56, 11.41s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3673528 :
INFO:model.model_wrapper:******train score at epoch 4: 0.86055 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3763474 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.58992 :
INFO:model.model_wrapper:validation score is improved from 0.49155 to 0.58992
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:47, 11.46s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3338387 :
INFO:model.model_wrapper:******train score at epoch 5: 0.84380 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3588014 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.60315 :
INFO:model.model_wrapper:validation score is improved from 0.58992 to 0.60315
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:57<08:36, 11.48s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.2611110 :
INFO:model.model_wrapper:******train score at epoch 6: 0.93314 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3458653 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.64093 :
INFO:model.model_wrapper:validation score is improved from 0.60315 to 0.64093
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:08<08:26, 11.50s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2800223 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94455 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3267770 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.57865 :
 14%|█▍        | 7/50 [01:20<08:12, 11.46s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2050596 :
INFO:model.model_wrapper:******train score at epoch 8: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2160087 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.64912 :
INFO:model.model_wrapper:validation score is improved from 0.64093 to 0.64912
INFO:model.model_wrapper:Checkpoint saved
 16%|█▌        | 8/50 [01:31<08:01, 11.46s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.1984869 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2415200 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.57865 :
 18%|█▊        | 9/50 [01:43<07:51, 11.50s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.1929703 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2145392 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.55278 :
 20%|██        | 10/50 [01:54<07:38, 11.46s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.1838602 :
INFO:model.model_wrapper:******train score at epoch 11: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3335845 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.51532 :
 22%|██▏       | 11/50 [02:06<07:26, 11.46s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1734887 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3483038 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.51532 :
 24%|██▍       | 12/50 [02:17<07:14, 11.44s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.2523564 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97523 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3913083 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.51532 :
 26%|██▌       | 13/50 [02:28<07:02, 11.42s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1774253 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2436680 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.49318 :
 28%|██▊       | 14/50 [02:40<06:50, 11.41s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.1711088 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2961176 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.56441 :
 30%|███       | 15/50 [02:51<06:39, 11.42s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.1447987 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2348023 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.56427 :
 32%|███▏      | 16/50 [03:03<06:28, 11.44s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.1647105 :
INFO:model.model_wrapper:******train score at epoch 17: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.2540730 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.51470 :
 34%|███▍      | 17/50 [03:14<06:16, 11.42s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.1022478 :
INFO:model.model_wrapper:******train score at epoch 18: 0.98765 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3063511 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.46080 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 4 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 4 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6669769 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6198841 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:19, 11.43s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5987139 :
INFO:model.model_wrapper:******train score at epoch 2: 0.19675 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5157734 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:08, 11.43s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4907900 :
INFO:model.model_wrapper:******train score at epoch 3: 0.50189 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4150180 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.35498 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.35498
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:58, 11.45s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4512860 :
INFO:model.model_wrapper:******train score at epoch 4: 0.68580 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3474673 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.63285 :
INFO:model.model_wrapper:validation score is improved from 0.35498 to 0.63285
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:48, 11.48s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3747515 :
INFO:model.model_wrapper:******train score at epoch 5: 0.81228 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3351526 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.56441 :
 10%|█         | 5/50 [00:57<08:35, 11.46s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3147114 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91652 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3781939 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.50806 :
 12%|█▏        | 6/50 [01:08<08:22, 11.42s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2918519 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92805 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3096299 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55548 :
 14%|█▍        | 7/50 [01:20<08:10, 11.41s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2638525 :
INFO:model.model_wrapper:******train score at epoch 8: 0.93970 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3588425 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.53056 :
 16%|█▌        | 8/50 [01:31<08:01, 11.46s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2265232 :
INFO:model.model_wrapper:******train score at epoch 9: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4419625 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.50102 :
 18%|█▊        | 9/50 [01:43<07:49, 11.44s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.1969922 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96303 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3913167 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.51532 :
 20%|██        | 10/50 [01:54<07:37, 11.44s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2102340 :
INFO:model.model_wrapper:******train score at epoch 11: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3507219 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.53858 :
 22%|██▏       | 11/50 [02:05<07:26, 11.44s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1679083 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3040926 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.56441 :
 24%|██▍       | 12/50 [02:17<07:14, 11.43s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1774139 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3260782 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.57368 :
 26%|██▌       | 13/50 [02:28<07:02, 11.43s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1708122 :
INFO:model.model_wrapper:******train score at epoch 14: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3097321 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.57665 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 5 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 5 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6811783 :
INFO:model.model_wrapper:******train score at epoch 1: 0.05581 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5950983 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:23, 11.50s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5638945 :
INFO:model.model_wrapper:******train score at epoch 2: 0.40306 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.5087733 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.23570 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.23570
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:11, 11.50s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.4833031 :
INFO:model.model_wrapper:******train score at epoch 3: 0.69917 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.4695654 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.66578 :
INFO:model.model_wrapper:validation score is improved from 0.23570 to 0.66578
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<09:01, 11.52s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4110047 :
INFO:model.model_wrapper:******train score at epoch 4: 0.80702 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3701617 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.55759 :
  8%|▊         | 4/50 [00:45<08:48, 11.48s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3475666 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88819 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.3021342 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.56789 :
 10%|█         | 5/50 [00:57<08:36, 11.47s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3108609 :
INFO:model.model_wrapper:******train score at epoch 6: 0.88819 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2515152 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.57665 :
 12%|█▏        | 6/50 [01:08<08:24, 11.46s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.3011825 :
INFO:model.model_wrapper:******train score at epoch 7: 0.93386 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2499145 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.60315 :
 14%|█▍        | 7/50 [01:20<08:12, 11.45s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2515175 :
INFO:model.model_wrapper:******train score at epoch 8: 0.94558 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2804824 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.56441 :
 16%|█▌        | 8/50 [01:31<08:00, 11.43s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2272223 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.4046403 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.48758 :
 18%|█▊        | 9/50 [01:43<07:49, 11.44s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2213559 :
INFO:model.model_wrapper:******train score at epoch 10: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.5080137 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.44074 :
 20%|██        | 10/50 [01:54<07:36, 11.42s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2041122 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.4843569 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.44074 :
 22%|██▏       | 11/50 [02:05<07:24, 11.41s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1989754 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.4165466 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.48758 :
 24%|██▍       | 12/50 [02:17<07:13, 11.41s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.2080437 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.4960309 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.46882 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 6 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 6 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6614189 :
INFO:model.model_wrapper:******train score at epoch 1: 0.10648 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.7418049 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:17, 11.39s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5684397 :
INFO:model.model_wrapper:******train score at epoch 2: 0.54646 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6921751 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.15193 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.15193
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:07, 11.40s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5533043 :
INFO:model.model_wrapper:******train score at epoch 3: 0.82002 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6245803 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.52418 :
INFO:model.model_wrapper:validation score is improved from 0.15193 to 0.52418
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:57, 11.43s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4716648 :
INFO:model.model_wrapper:******train score at epoch 4: 0.88405 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4963914 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.54772 :
INFO:model.model_wrapper:validation score is improved from 0.52418 to 0.54772
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:47, 11.47s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.4042212 :
INFO:model.model_wrapper:******train score at epoch 5: 0.87911 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4051178 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.55759 :
INFO:model.model_wrapper:validation score is improved from 0.54772 to 0.55759
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:57<08:36, 11.49s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3416969 :
INFO:model.model_wrapper:******train score at epoch 6: 0.91481 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2983091 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.61413 :
INFO:model.model_wrapper:validation score is improved from 0.55759 to 0.61413
INFO:model.model_wrapper:Checkpoint saved
 12%|█▏        | 6/50 [01:08<08:25, 11.48s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2964345 :
INFO:model.model_wrapper:******train score at epoch 7: 0.92726 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3747949 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.55759 :
 14%|█▍        | 7/50 [01:20<08:13, 11.48s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2496637 :
INFO:model.model_wrapper:******train score at epoch 8: 0.94558 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3294749 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.55759 :
 16%|█▌        | 8/50 [01:31<08:01, 11.46s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2060520 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2937359 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.55759 :
 18%|█▊        | 9/50 [01:43<07:50, 11.47s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2118569 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97523 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2866713 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.56789 :
 20%|██        | 10/50 [01:54<07:37, 11.43s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2551782 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2643436 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.57865 :
 22%|██▏       | 11/50 [02:06<07:25, 11.42s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.2007344 :
INFO:model.model_wrapper:******train score at epoch 12: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2666904 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.60383 :
 24%|██▍       | 12/50 [02:17<07:13, 11.41s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.2101218 :
INFO:model.model_wrapper:******train score at epoch 13: 0.97523 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.1963932 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.60173 :
 26%|██▌       | 13/50 [02:28<07:03, 11.44s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1785403 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.1869104 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.58992 :
 28%|██▊       | 14/50 [02:40<06:51, 11.42s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.1407623 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.2024627 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.58992 :
 30%|███       | 15/50 [02:51<06:39, 11.40s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.1933172 :
INFO:model.model_wrapper:******train score at epoch 16: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.2198872 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.60383 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 7 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 7 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6830898 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******train score at epoch 1: 0.00000 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.5812375 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:26, 11.57s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.6038744 :
INFO:model.model_wrapper:******train score at epoch 2: 0.15962 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.4849704 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 2: 0.00000 :
  4%|▍         | 2/50 [00:22<09:12, 11.51s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5219582 :
INFO:model.model_wrapper:******train score at epoch 3: 0.26692 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.3824868 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 3: 0.00000 :
  6%|▌         | 3/50 [00:34<08:59, 11.48s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4653589 :
INFO:model.model_wrapper:******train score at epoch 4: 0.46668 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.3036488 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.24758 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.24758
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:47, 11.47s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.4453839 :
INFO:model.model_wrapper:******train score at epoch 5: 0.65773 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.2501118 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.72663 :
INFO:model.model_wrapper:validation score is improved from 0.24758 to 0.72663
INFO:model.model_wrapper:Checkpoint saved
 10%|█         | 5/50 [00:57<08:35, 11.45s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3650609 :
INFO:model.model_wrapper:******train score at epoch 6: 0.79431 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.2204703 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.70507 :
 12%|█▏        | 6/50 [01:08<08:23, 11.43s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.3244564 :
INFO:model.model_wrapper:******train score at epoch 7: 0.85200 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.2855691 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.65546 :
 14%|█▍        | 7/50 [01:19<08:10, 11.41s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.3255729 :
INFO:model.model_wrapper:******train score at epoch 8: 0.90510 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.2196664 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.67085 :
 16%|█▌        | 8/50 [01:31<08:00, 11.45s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2666457 :
INFO:model.model_wrapper:******train score at epoch 9: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.2603383 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.57865 :
 18%|█▊        | 9/50 [01:42<07:48, 11.43s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2172414 :
INFO:model.model_wrapper:******train score at epoch 10: 0.95149 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.2737367 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.55759 :
 20%|██        | 10/50 [01:54<07:36, 11.42s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2110994 :
INFO:model.model_wrapper:******train score at epoch 11: 0.95097 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2216831 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.62718 :
 22%|██▏       | 11/50 [02:05<07:24, 11.40s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.2250216 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.1948562 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.67085 :
 24%|██▍       | 12/50 [02:16<07:12, 11.39s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.2015851 :
INFO:model.model_wrapper:******train score at epoch 13: 0.93970 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.1985530 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.61756 :
 26%|██▌       | 13/50 [02:28<07:01, 11.40s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1741940 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2181545 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.60383 :
 28%|██▊       | 14/50 [02:39<06:50, 11.40s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.1369453 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.1973896 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.62618 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 8 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 8 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6698220 :
INFO:model.model_wrapper:******train score at epoch 1: 0.09698 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6409743 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:22, 11.48s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5753893 :
INFO:model.model_wrapper:******train score at epoch 2: 0.53634 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6132294 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.11949 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.11949
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:09, 11.44s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5033364 :
INFO:model.model_wrapper:******train score at epoch 3: 0.76151 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.5726501 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.56250 :
INFO:model.model_wrapper:validation score is improved from 0.11949 to 0.56250
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:58, 11.46s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.4072113 :
INFO:model.model_wrapper:******train score at epoch 4: 0.86880 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.4931462 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.58954 :
INFO:model.model_wrapper:validation score is improved from 0.56250 to 0.58954
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:46, 11.46s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.4283147 :
INFO:model.model_wrapper:******train score at epoch 5: 0.88130 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.5063066 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53113 :
 10%|█         | 5/50 [00:57<08:33, 11.42s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3397936 :
INFO:model.model_wrapper:******train score at epoch 6: 0.90510 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.5095692 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.58640 :
 12%|█▏        | 6/50 [01:08<08:22, 11.42s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.2633537 :
INFO:model.model_wrapper:******train score at epoch 7: 0.96340 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.4449863 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.58954 :
 14%|█▍        | 7/50 [01:19<08:10, 11.41s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2793297 :
INFO:model.model_wrapper:******train score at epoch 8: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.4915832 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.50102 :
 16%|█▌        | 8/50 [01:31<08:00, 11.43s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.2440597 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3626775 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.58333 :
 18%|█▊        | 9/50 [01:42<07:48, 11.42s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2263890 :
INFO:model.model_wrapper:******train score at epoch 10: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3207687 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.60173 :
INFO:model.model_wrapper:validation score is improved from 0.58954 to 0.60173
INFO:model.model_wrapper:Checkpoint saved
 20%|██        | 10/50 [01:54<07:38, 11.47s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.1925859 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.3444732 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.56441 :
 22%|██▏       | 11/50 [02:05<07:25, 11.42s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.2585579 :
INFO:model.model_wrapper:******train score at epoch 12: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.3888754 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.50102 :
 24%|██▍       | 12/50 [02:17<07:13, 11.40s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.1707001 :
INFO:model.model_wrapper:******train score at epoch 13: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3451708 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.52915 :
 26%|██▌       | 13/50 [02:28<07:01, 11.40s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1469287 :
INFO:model.model_wrapper:******train score at epoch 14: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.3875605 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.55759 :
 28%|██▊       | 14/50 [02:39<06:49, 11.39s/it]INFO:model.model_wrapper:training 15  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 15: 0.2004762 :
INFO:model.model_wrapper:******train score at epoch 15: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 15: 0.4233686 :
INFO:model.model_wrapper:******valid score at epoch 15: 0.49420 :
 30%|███       | 15/50 [02:51<06:38, 11.38s/it]INFO:model.model_wrapper:training 16  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 16: 0.1484795 :
INFO:model.model_wrapper:******train score at epoch 16: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 16: 0.3128630 :
INFO:model.model_wrapper:******valid score at epoch 16: 0.57865 :
 32%|███▏      | 16/50 [03:02<06:27, 11.38s/it]INFO:model.model_wrapper:training 17  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 17: 0.2291672 :
INFO:model.model_wrapper:******train score at epoch 17: 0.96911 :
INFO:model.model_wrapper:******valid loss at epoch 17: 0.3008171 :
INFO:model.model_wrapper:******valid score at epoch 17: 0.54171 :
 34%|███▍      | 17/50 [03:13<06:15, 11.38s/it]INFO:model.model_wrapper:training 18  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 18: 0.1805403 :
INFO:model.model_wrapper:******train score at epoch 18: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 18: 0.3804751 :
INFO:model.model_wrapper:******valid score at epoch 18: 0.50384 :
 36%|███▌      | 18/50 [03:25<06:04, 11.40s/it]INFO:model.model_wrapper:training 19  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 19: 0.1761444 :
INFO:model.model_wrapper:******train score at epoch 19: 0.97546 :
INFO:model.model_wrapper:******valid loss at epoch 19: 0.3424865 :
INFO:model.model_wrapper:******valid score at epoch 19: 0.55548 :
 38%|███▊      | 19/50 [03:36<05:53, 11.42s/it]INFO:model.model_wrapper:training 20  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 20: 0.1545153 :
INFO:model.model_wrapper:******train score at epoch 20: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 20: 0.3477805 :
INFO:model.model_wrapper:******valid score at epoch 20: 0.55548 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
---- training bag 9 / 10 ---- 
INFO:runner.model.base_runner:---- training bag 9 / 10 ---- 
/home/yohyohyonyon/kaggle/vbs-power-line-fault-detection/feature/plot_images.py:113: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.plot_meta_df["target"] = self.plot_meta_df["target"].astype("float32")
INFO:model.model_wrapper:train with data size: 322
INFO:model.model_wrapper:valid with data size: 289
  0%|          | 0/50 [00:00<?, ?it/s]INFO:model.model_wrapper:training 1  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 1: 0.6644439 :
INFO:model.model_wrapper:******train score at epoch 1: 0.15962 :
INFO:model.model_wrapper:******valid loss at epoch 1: 0.6830375 :
/opt/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:543: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
INFO:model.model_wrapper:******valid score at epoch 1: 0.00000 :
  2%|▏         | 1/50 [00:11<09:18, 11.40s/it]INFO:model.model_wrapper:training 2  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 2: 0.5483977 :
INFO:model.model_wrapper:******train score at epoch 2: 0.58537 :
INFO:model.model_wrapper:******valid loss at epoch 2: 0.6759990 :
INFO:model.model_wrapper:******valid score at epoch 2: 0.33454 :
INFO:model.model_wrapper:validation score is improved from 0.00000 to 0.33454
INFO:model.model_wrapper:Checkpoint saved
  4%|▍         | 2/50 [00:22<09:07, 11.41s/it]INFO:model.model_wrapper:training 3  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 3: 0.5722196 :
INFO:model.model_wrapper:******train score at epoch 3: 0.72158 :
INFO:model.model_wrapper:******valid loss at epoch 3: 0.6354253 :
INFO:model.model_wrapper:******valid score at epoch 3: 0.53822 :
INFO:model.model_wrapper:validation score is improved from 0.33454 to 0.53822
INFO:model.model_wrapper:Checkpoint saved
  6%|▌         | 3/50 [00:34<08:56, 11.42s/it]INFO:model.model_wrapper:training 4  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 4: 0.3853203 :
INFO:model.model_wrapper:******train score at epoch 4: 0.82346 :
INFO:model.model_wrapper:******valid loss at epoch 4: 0.5235257 :
INFO:model.model_wrapper:******valid score at epoch 4: 0.58954 :
INFO:model.model_wrapper:validation score is improved from 0.53822 to 0.58954
INFO:model.model_wrapper:Checkpoint saved
  8%|▊         | 4/50 [00:45<08:46, 11.44s/it]INFO:model.model_wrapper:training 5  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 5: 0.3496607 :
INFO:model.model_wrapper:******train score at epoch 5: 0.89734 :
INFO:model.model_wrapper:******valid loss at epoch 5: 0.4755920 :
INFO:model.model_wrapper:******valid score at epoch 5: 0.53825 :
 10%|█         | 5/50 [00:57<08:33, 11.41s/it]INFO:model.model_wrapper:training 6  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 6: 0.3487630 :
INFO:model.model_wrapper:******train score at epoch 6: 0.95743 :
INFO:model.model_wrapper:******valid loss at epoch 6: 0.3994514 :
INFO:model.model_wrapper:******valid score at epoch 6: 0.57865 :
 12%|█▏        | 6/50 [01:08<08:21, 11.39s/it]INFO:model.model_wrapper:training 7  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 7: 0.3488570 :
INFO:model.model_wrapper:******train score at epoch 7: 0.94499 :
INFO:model.model_wrapper:******valid loss at epoch 7: 0.3836866 :
INFO:model.model_wrapper:******valid score at epoch 7: 0.50384 :
 14%|█▍        | 7/50 [01:19<08:09, 11.39s/it]INFO:model.model_wrapper:training 8  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 8: 0.2195663 :
INFO:model.model_wrapper:******train score at epoch 8: 0.96303 :
INFO:model.model_wrapper:******valid loss at epoch 8: 0.3049235 :
INFO:model.model_wrapper:******valid score at epoch 8: 0.54171 :
 16%|█▌        | 8/50 [01:31<07:59, 11.42s/it]INFO:model.model_wrapper:training 9  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 9: 0.3267100 :
INFO:model.model_wrapper:******train score at epoch 9: 0.96911 :
INFO:model.model_wrapper:******valid loss at epoch 9: 0.3549264 :
INFO:model.model_wrapper:******valid score at epoch 9: 0.50384 :
 18%|█▊        | 9/50 [01:42<07:47, 11.40s/it]INFO:model.model_wrapper:training 10  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 10: 0.2764166 :
INFO:model.model_wrapper:******train score at epoch 10: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 10: 0.3611289 :
INFO:model.model_wrapper:******valid score at epoch 10: 0.52281 :
 20%|██        | 10/50 [01:54<07:36, 11.42s/it]INFO:model.model_wrapper:training 11  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 11: 0.2246709 :
INFO:model.model_wrapper:******train score at epoch 11: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 11: 0.2615218 :
INFO:model.model_wrapper:******valid score at epoch 11: 0.57665 :
 22%|██▏       | 11/50 [02:05<07:25, 11.41s/it]INFO:model.model_wrapper:training 12  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 12: 0.1995942 :
INFO:model.model_wrapper:******train score at epoch 12: 0.96941 :
INFO:model.model_wrapper:******valid loss at epoch 12: 0.2434655 :
INFO:model.model_wrapper:******valid score at epoch 12: 0.57665 :
 24%|██▍       | 12/50 [02:16<07:13, 11.41s/it]INFO:model.model_wrapper:training 13  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 13: 0.2391592 :
INFO:model.model_wrapper:******train score at epoch 13: 0.98758 :
INFO:model.model_wrapper:******valid loss at epoch 13: 0.3050535 :
INFO:model.model_wrapper:******valid score at epoch 13: 0.53814 :
 26%|██▌       | 13/50 [02:28<07:02, 11.43s/it]INFO:model.model_wrapper:training 14  / 50 epochs
INFO:model.model_wrapper:******train loss at epoch 14: 0.1919534 :
INFO:model.model_wrapper:******train score at epoch 14: 0.98154 :
INFO:model.model_wrapper:******valid loss at epoch 14: 0.2213966 :
INFO:model.model_wrapper:******valid score at epoch 14: 0.54408 :
INFO:model.model_wrapper:======early stopped=====

INFO:model.model_wrapper:train done!
